/**
 * Created by Steven on 14/2/19.
 */
/*
 * GoJS v2.0.2 JavaScript Library for HTML Diagrams
 * Northwoods Software, https://www.nwoods.com/
 * GoJS and Northwoods Software are registered trademarks of Northwoods Software Corporation.
 * Copyright (C) 1998-2019 by Northwoods Software Corporation.  All Rights Reserved.
 * THIS SOFTWARE IS LICENSED.  THE LICENSE AGREEMENT IS AT: https://gojs.net/2.0.2/license.html.
 */
(function() { var t;function ba(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function da(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):{next:ba(a)}}function ea(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}var fa="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},ha;
if("function"==typeof Object.setPrototypeOf)ha=Object.setPrototypeOf;else{var ia;a:{var ja={a:!0},ka={};try{ka.__proto__=ja;ia=ka.a;break a}catch(a){}ia=!1}ha=ia?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var la=ha;
function ma(a,b){a.prototype=fa(b.prototype);a.prototype.constructor=a;if(la)la(a,b);else for(var c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.sA=b.prototype}var na="undefined"!=typeof window&&window===self?self:"undefined"!=typeof global&&null!=global?global:self,oa="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
function pa(a){if(a){for(var b=na,c=["Array","prototype","fill"],d=0;d<c.length-1;d++){var e=c[d];e in b||(b[e]={});b=b[e]}c=c[c.length-1];d=b[c];a=a(d);a!=d&&null!=a&&oa(b,c,{configurable:!0,writable:!0,value:a})}}pa(function(a){return a?a:function(a,c,d){var b=this.length||0;0>c&&(c=Math.max(0,b+c));if(null==d||d>b)d=b;d=Number(d);0>d&&(d=Math.max(0,b+d));for(c=Number(c||0);c<d;c++)this[c]=a;return this}});var qa="object"===typeof self&&self.self===self&&self||"object"===typeof global&&global.global===global&&global||"object"===typeof window&&window.window===window&&window||{};void 0===qa.requestAnimationFrame&&(qa.requestAnimationFrame=qa.setImmediate);function ra(){}function sa(a,b){var c=-1;return function(){var d=this,e=arguments;-1!==c&&qa.clearTimeout(c);c=wa(function(){c=-1;a.apply(d,e)},b)}}function wa(a,b){return qa.setTimeout(a,b)}function xa(a){return qa.document.createElement(a)}
function v(a){throw Error(a);}function ya(a,b){a="The object is frozen, so its properties cannot be set: "+a.toString();void 0!==b&&(a+="  to value: "+b);v(a)}function w(a,b,c,d){a instanceof b||(c=Aa(c),void 0!==d&&(c+="."+d),Ba(a,b,c))}function z(a,b,c,d){typeof a!==b&&(c=Aa(c),void 0!==d&&(c+="."+d),Ba(a,b,c))}function B(a,b,c){"number"===typeof a&&isFinite(a)||(b=Aa(b),void 0!==c&&(b+="."+c),v(b+" must be a real number type, and not NaN or Infinity: "+a))}
function Ba(a,b,c,d){b=Aa(b);c=Aa(c);void 0!==d&&(c+="."+d);"string"===typeof a?v(c+" value is not an instance of "+b+': "'+a+'"'):v(c+" value is not an instance of "+b+": "+a)}function Ca(a,b,c,d){c=Aa(c);void 0!==d&&(c+="."+d);v(c+" is not in the range "+b+": "+a)}function Da(a){v(("string"===typeof a.className?a.className:"")+" constructor cannot take any arguments.")}
function Ea(a){v("Collection was modified during iteration: "+a.toString()+"\n  Perhaps you should iterate over a copy of the collection,\n  or you could collect items to be removed from the collection after the iteration.")}function Fa(a,b){v("No property to set for this enum value: "+b+" on "+a.toString())}function Ga(a){qa.console&&qa.console.log(a)}
function Ha(){qa.console&&qa.console.log("Warning: List/Map/Set constructors no longer take an argument that enforces type.Instead they take an optional collection of Values to add to the collection. See 2.0 changelog for details.")}function Ia(a){return"object"===typeof a&&null!==a}function Ja(a){return Array.isArray(a)||qa.NodeList&&a instanceof qa.NodeList||qa.HTMLCollection&&a instanceof qa.HTMLCollection}function La(a,b,c){Ja(a)||Ba(a,"Array or NodeList or HTMLCollection",b,c)}
function Ma(a){return Array.prototype.slice.call(a)}function Na(a,b,c){Array.isArray(a)?b>=a.length?a.push(c):a.splice(b,0,c):v("Cannot insert an object into an HTMLCollection or NodeList: "+c+" at "+b)}function Oa(a,b){Array.isArray(a)?b>=a.length?a.pop():a.splice(b,1):v("Cannot remove an object from an HTMLCollection or NodeList at "+b)}function Qa(){var a=Ra.pop();return void 0===a?[]:a}function Ta(a){a.length=0;Ra.push(a)}
function Aa(a){return null===a?"*":"string"===typeof a?a:"function"===typeof a&&"string"===typeof a.className?a.className:""}function Va(a){if("function"===typeof a){if(a.className)return a.className;if(a.name)return a.name;var b=a.toString();b=b.substring(9,b.indexOf("(")).trim();if(""!==b)return a._className=b}else if(Ia(a)&&a.constructor)return Va(a.constructor);return typeof a}
function Wa(a){var b=a;Ia(a)&&(a.text?b=a.text:a.name?b=a.name:void 0!==a.key?b=a.key:void 0!==a.id?b=a.id:a.constructor===Object&&(a.Text?b=a.Text:a.Name?b=a.Name:void 0!==a.Key?b=a.Key:void 0!==a.Id?b=a.Id:void 0!==a.ID&&(b=a.ID)));return void 0===b?"undefined":null===b?"null":b.toString()}function Ya(a,b){if(a.hasOwnProperty(b))return!0;for(a=Object.getPrototypeOf(a);a&&a!==Function;){if(a.hasOwnProperty(b))return!0;var c=a.fA;if(c&&c[b])return!0;a=Object.getPrototypeOf(a)}return!1}
function Za(a,b,c){Object.defineProperty($a.prototype,a,{get:b,set:c})}function ab(){var a=bb;if(0===a.length)for(var b=qa.document.getElementsByTagName("canvas"),c=b.length,d=0;d<c;d++){var e=b[d];e.parentElement&&e.parentElement.G&&a.push(e.parentElement.G)}return a}
function eb(a){for(var b=[],c=0;256>c;c++)b["0123456789abcdef".charAt(c>>4)+"0123456789abcdef".charAt(c&15)]=String.fromCharCode(c);a.length%2&&(a="0"+a);c=[];for(var d=0,e=0;e<a.length;e+=2)c[d++]=b[a.substr(e,2)];a=c.join("");a=""===a?"0":a;b=[];for(c=0;256>c;c++)b[c]=c;for(c=d=0;256>c;c++)d=(d+b[c]+119)%256,e=b[c],b[c]=b[d],b[d]=e;d=c=0;for(var f="",g=0;g<a.length;g++)c=(c+1)%256,d=(d+b[c])%256,e=b[c],b[c]=b[d],b[d]=e,f+=String.fromCharCode(a.charCodeAt(g)^b[(b[c]+b[d])%256]);return f}
var fb=void 0!==qa.navigator&&0<qa.navigator.userAgent.indexOf("MSIE 9.0"),gb=void 0!==qa.navigator&&0<qa.navigator.userAgent.indexOf("MSIE 10.0"),ib=void 0!==qa.navigator&&0<qa.navigator.userAgent.indexOf("Trident/7"),jb=void 0!==qa.navigator&&0<qa.navigator.userAgent.indexOf("Edge/"),kb=void 0!==qa.navigator&&void 0!==qa.navigator.platform&&0<=qa.navigator.platform.toUpperCase().indexOf("MAC"),pb=void 0!==qa.navigator&&void 0!==qa.navigator.platform&&null!==qa.navigator.platform.match(/(iPhone|iPod|iPad)/i),
Ra=[];Object.freeze([]);var bb=[];ra.className="Util";ra.Dx="32ab5ff3b26f42dc0ed90f224c2913b5";ra.adym="gojs.net";ra.vfo="28e646fdb1";ra.className="Util";function D(a,b,c){rb(this);this.l=a;this.Va=b;this.w=c}D.prototype.toString=function(){return"EnumValue."+this.Va};function sb(a,b){return void 0===b||null===b||""===b?null:a[b]}function tb(a,b,c,d){a.classType!==b&&(c=Aa(c),void 0!==d&&(c+="."+d),Ba(a,"function"==="a constant of class "+typeof b.className?b.className:"",c))}
na.Object.defineProperties(D.prototype,{classType:{configurable:!0,get:function(){return this.l}},name:{configurable:!0,get:function(){return this.Va}},value:{configurable:!0,get:function(){return this.w}}});D.className="EnumValue";function ub(){this.ow=[]}ub.prototype.toString=function(){return this.ow.join("")};ub.prototype.add=function(a){""!==a&&this.ow.push(a)};ub.className="StringBuilder";function xb(){}xb.className="PropertyCollection";
var E={Ai:!1,Vu:!1,Ly:!1,iA:!1,nA:!1,sx:!1,hA:null,trace:function(a){qa.console&&qa.console.log(a)},qy:function(a){var b={},c;for(c in a){b.x=c;if("licenseKey"!==b.x){var d=a[b.x];if(void 0!==d.prototype){b.om=Object.getOwnPropertyNames(d.prototype);for(var e={ak:0};e.ak<b.om.length;e={ak:e.ak},e.ak++){var f=Object.getOwnPropertyDescriptor(d.prototype,b.om[e.ak]);void 0!==f.get&&void 0===f.set&&Object.defineProperty(d.prototype,b.om[e.ak],{set:function(a,b){return function(){throw Error("Property "+
a.om[b.ak]+" of "+a.x+" is read-only.");}}(b,e)})}}}b={om:b.om,x:b.x}}}};function Bb(){}Bb.prototype.reset=function(){};Bb.prototype.next=function(){return!1};Bb.prototype.hd=function(){return!1};Bb.prototype.first=function(){return null};Bb.prototype.any=function(){return!1};Bb.prototype.all=function(){return!0};Bb.prototype.each=function(){return this};Bb.prototype.map=function(){return this};Bb.prototype.filter=function(){return this};Bb.prototype.Bd=function(){};Bb.prototype.toString=function(){return"EmptyIterator"};
na.Object.defineProperties(Bb.prototype,{iterator:{configurable:!0,get:function(){return this}},count:{configurable:!0,get:function(){return 0}}});Bb.prototype.first=Bb.prototype.first;Bb.prototype.hasNext=Bb.prototype.hd;Bb.prototype.next=Bb.prototype.next;Bb.prototype.reset=Bb.prototype.reset;var Cb=null;Bb.className="EmptyIterator";Cb=new Bb;function Db(a){this.key=-1;this.value=a}Db.prototype.reset=function(){this.key=-1};
Db.prototype.next=function(){return-1===this.key?(this.key=0,!0):!1};Db.prototype.hd=function(){return this.next()};Db.prototype.first=function(){this.key=0;return this.value};Db.prototype.any=function(a){this.key=-1;return a(this.value)};Db.prototype.all=function(a){this.key=-1;return a(this.value)};Db.prototype.each=function(a){this.key=-1;a(this.value);return this};Db.prototype.map=function(a){return new Db(a(this.value))};
Db.prototype.filter=function(a){return a(this.value)?new Db(this.value):Cb};Db.prototype.Bd=function(){this.value=null};Db.prototype.toString=function(){return"SingletonIterator("+this.value+")"};na.Object.defineProperties(Db.prototype,{iterator:{configurable:!0,get:function(){return this}},count:{configurable:!0,get:function(){return 1}}});Db.prototype.first=Db.prototype.first;Db.prototype.hasNext=Db.prototype.hd;Db.prototype.next=Db.prototype.next;
Db.prototype.reset=Db.prototype.reset;Db.className="SingletonIterator";function Gb(a){this.rb=a;this.Ze=null;a.Ka=null;this.na=a.s;this.Ta=-1}Gb.prototype.reset=function(){var a=this.rb;a.Ka=null;this.na=a.s;this.Ta=-1};Gb.prototype.next=function(){var a=this.rb;if(a.s!==this.na){if(0>this.key)return!1;Ea(a)}a=a.j;var b=a.length,c=++this.Ta,d=this.Ze;if(null!==d)for(;c<b;){var e=a[c];if(d(e))return this.key=this.Ta=c,this.value=e,!0;c++}else{if(c<b)return this.key=c,this.value=a[c],!0;this.Bd()}return!1};
Gb.prototype.hd=function(){return this.next()};Gb.prototype.first=function(){var a=this.rb;this.na=a.s;this.Ta=0;a=a.j;var b=a.length,c=this.Ze;if(null!==c){for(var d=0;d<b;){var e=a[d];if(c(e))return this.key=this.Ta=d,this.value=e;d++}return null}return 0<b?(a=a[0],this.key=0,this.value=a):null};Gb.prototype.any=function(a){var b=this.rb;b.Ka=null;var c=b.s;this.Ta=-1;for(var d=b.j,e=d.length,f=this.Ze,g=0;g<e;g++){var h=d[g];if(null===f||f(h)){if(a(h))return!0;b.s!==c&&Ea(b)}}return!1};
Gb.prototype.all=function(a){var b=this.rb;b.Ka=null;var c=b.s;this.Ta=-1;for(var d=b.j,e=d.length,f=this.Ze,g=0;g<e;g++){var h=d[g];if(null===f||f(h)){if(!a(h))return!1;b.s!==c&&Ea(b)}}return!0};Gb.prototype.each=function(a){var b=this.rb;b.Ka=null;var c=b.s;this.Ta=-1;for(var d=b.j,e=d.length,f=this.Ze,g=0;g<e;g++){var h=d[g];if(null===f||f(h))a(h),b.s!==c&&Ea(b)}return this};
Gb.prototype.map=function(a){var b=this.rb;b.Ka=null;var c=b.s;this.Ta=-1;for(var d=[],e=b.j,f=e.length,g=this.Ze,h=0;h<f;h++){var k=e[h];if(null===g||g(k))d.push(a(k)),b.s!==c&&Ea(b)}a=new G;a.j=d;a.lb();return a.iterator};Gb.prototype.filter=function(a){var b=this.rb;b.Ka=null;var c=b.s;this.Ta=-1;for(var d=[],e=b.j,f=e.length,g=this.Ze,h=0;h<f;h++){var k=e[h];if(null===g||g(k))a(k)&&d.push(k),b.s!==c&&Ea(b)}a=new G;a.j=d;a.lb();return a.iterator};
Gb.prototype.Bd=function(){this.key=-1;this.value=null;this.na=-1;this.Ze=null;this.rb.Ka=this};Gb.prototype.toString=function(){return"ListIterator@"+this.Ta+"/"+this.rb.count};
na.Object.defineProperties(Gb.prototype,{iterator:{configurable:!0,get:function(){return this}},predicate:{configurable:!0,get:function(){return this.Ze},set:function(a){this.Ze=a}},count:{configurable:!0,get:function(){var a=this.Ze;if(null!==a){for(var b=0,c=this.rb.j,d=c.length,e=0;e<d;e++)a(c[e])&&b++;return b}return this.rb.j.length}}});Gb.prototype.first=Gb.prototype.first;Gb.prototype.hasNext=Gb.prototype.hd;Gb.prototype.next=Gb.prototype.next;
Gb.prototype.reset=Gb.prototype.reset;Gb.className="ListIterator";function Ib(a){this.rb=a;a.Rg=null;this.na=a.s;this.Ta=a.j.length}Ib.prototype.reset=function(){var a=this.rb;a.Rg=null;this.na=a.s;this.Ta=a.j.length};Ib.prototype.next=function(){var a=this.rb;if(a.s!==this.na){if(0>this.key)return!1;Ea(a)}var b=--this.Ta;if(0<=b)return this.key=b,this.value=a.j[b],!0;this.Bd();return!1};Ib.prototype.hd=function(){return this.next()};
Ib.prototype.first=function(){var a=this.rb;this.na=a.s;var b=a.j;this.Ta=a=b.length-1;return 0<=a?(b=b[a],this.key=a,this.value=b):null};Ib.prototype.any=function(a){var b=this.rb;b.Rg=null;var c=b.s,d=b.j,e=d.length;this.Ta=e;for(--e;0<=e;e--){if(a(d[e]))return!0;b.s!==c&&Ea(b)}return!1};Ib.prototype.all=function(a){var b=this.rb;b.Rg=null;var c=b.s,d=b.j,e=d.length;this.Ta=e;for(--e;0<=e;e--){if(!a(d[e]))return!1;b.s!==c&&Ea(b)}return!0};
Ib.prototype.each=function(a){var b=this.rb;b.Rg=null;var c=b.s,d=b.j,e=d.length;this.Ta=e;for(--e;0<=e;e--)a(d[e]),b.s!==c&&Ea(b);return this};Ib.prototype.map=function(a){var b=this.rb;b.Rg=null;var c=b.s,d=[],e=b.j,f=e.length;this.Ta=f;for(--f;0<=f;f--)d.push(a(e[f])),b.s!==c&&Ea(b);a=new G;a.j=d;a.lb();return a.iterator};
Ib.prototype.filter=function(a){var b=this.rb;b.Rg=null;var c=b.s,d=[],e=b.j,f=e.length;this.Ta=f;for(--f;0<=f;f--){var g=e[f];a(g)&&d.push(g);b.s!==c&&Ea(b)}a=new G;a.j=d;a.lb();return a.iterator};Ib.prototype.Bd=function(){this.key=-1;this.value=null;this.na=-1;this.rb.Rg=this};Ib.prototype.toString=function(){return"ListIteratorBackwards("+this.Ta+"/"+this.rb.count+")"};
na.Object.defineProperties(Ib.prototype,{iterator:{configurable:!0,get:function(){return this}},count:{configurable:!0,get:function(){return this.rb.j.length}}});Ib.prototype.first=Ib.prototype.first;Ib.prototype.hasNext=Ib.prototype.hd;Ib.prototype.next=Ib.prototype.next;Ib.prototype.reset=Ib.prototype.reset;Ib.className="ListIteratorBackwards";
function G(a){rb(this);this.u=!1;this.j=[];this.s=0;this.Rg=this.Ka=null;void 0!==a&&("function"===typeof a||"string"===typeof a?Ha():this.addAll(a))}t=G.prototype;t.lb=function(){var a=this.s;a++;999999999<a&&(a=0);this.s=a};t.freeze=function(){this.u=!0;return this};t.ja=function(){this.u=!1;return this};t.toString=function(){return"List()#"+Jb(this)};t.add=function(a){if(null===a)return this;this.u&&ya(this,a);this.j.push(a);this.lb();return this};t.push=function(a){this.add(a)};
t.addAll=function(a){if(null===a)return this;this.u&&ya(this);var b=this.j;if(Ja(a))for(var c=a.length,d=0;d<c;d++)b.push(a[d]);else for(a=a.iterator;a.next();)b.push(a.value);this.lb();return this};t.clear=function(){this.u&&ya(this);this.j.length=0;this.lb()};t.contains=function(a){return null===a?!1:-1!==this.j.indexOf(a)};t.has=function(a){return this.contains(a)};t.indexOf=function(a){return null===a?-1:this.j.indexOf(a)};
t.O=function(a){E&&B(a,G,"elt:i");var b=this.j;(0>a||a>=b.length)&&Ca(a,"0 <= i < length",G,"elt:i");return b[a]};t.get=function(a){return this.O(a)};t.ld=function(a,b){E&&B(a,G,"setElt:i");var c=this.j;(0>a||a>=c.length)&&Ca(a,"0 <= i < length",G,"setElt:i");this.u&&ya(this,a);c[a]=b};t.set=function(a,b){this.ld(a,b)};t.first=function(){var a=this.j;return 0===a.length?null:a[0]};t.Ub=function(){var a=this.j,b=a.length;return 0<b?a[b-1]:null};
t.pop=function(){this.u&&ya(this);var a=this.j;return 0<a.length?a.pop():null};G.prototype.any=function(a){for(var b=this.j,c=this.s,d=b.length,e=0;e<d;e++){if(a(b[e]))return!0;this.s!==c&&Ea(this)}return!1};G.prototype.all=function(a){for(var b=this.j,c=this.s,d=b.length,e=0;e<d;e++){if(!a(b[e]))return!1;this.s!==c&&Ea(this)}return!0};G.prototype.each=function(a){for(var b=this.j,c=this.s,d=b.length,e=0;e<d;e++)a(b[e]),this.s!==c&&Ea(this);return this};
G.prototype.map=function(a){for(var b=new G,c=[],d=this.j,e=this.s,f=d.length,g=0;g<f;g++)c.push(a(d[g])),this.s!==e&&Ea(this);b.j=c;b.lb();return b};G.prototype.filter=function(a){for(var b=new G,c=[],d=this.j,e=this.s,f=d.length,g=0;g<f;g++){var h=d[g];a(h)&&c.push(h);this.s!==e&&Ea(this)}b.j=c;b.lb();return b};t=G.prototype;t.Mb=function(a,b){E&&B(a,G,"insertAt:i");0>a&&Ca(a,">= 0",G,"insertAt:i");this.u&&ya(this,a);var c=this.j;a>=c.length?c.push(b):c.splice(a,0,b);this.lb()};
t.remove=function(a){if(null===a)return!1;this.u&&ya(this,a);var b=this.j;a=b.indexOf(a);if(-1===a)return!1;a===b.length-1?b.pop():b.splice(a,1);this.lb();return!0};t.delete=function(a){return this.remove(a)};t.nb=function(a){E&&B(a,G,"removeAt:i");var b=this.j;(0>a||a>=b.length)&&Ca(a,"0 <= i < length",G,"removeAt:i");this.u&&ya(this,a);a===b.length-1?b.pop():b.splice(a,1);this.lb()};
t.removeRange=function(a,b){E&&(B(a,G,"removeRange:from"),B(b,G,"removeRange:to"));var c=this.j,d=c.length;if(0>a)a=0;else if(a>=d)return this;if(0>b)return this;b>=d&&(b=d-1);if(a>b)return this;this.u&&ya(this);for(var e=a,f=b+1;f<d;)c[e++]=c[f++];c.length=d-(b-a+1);this.lb();return this};G.prototype.copy=function(){var a=new G,b=this.j;0<b.length&&(a.j=Array.prototype.slice.call(b));return a};t=G.prototype;t.Na=function(){for(var a=this.j,b=this.count,c=Array(b),d=0;d<b;d++)c[d]=a[d];return c};
t.Rv=function(){for(var a=new H,b=this.j,c=this.count,d=0;d<c;d++)a.add(b[d]);return a};t.sort=function(a){E&&z(a,"function",G,"sort:sortfunc");this.u&&ya(this);this.j.sort(a);this.lb();return this};
t.Ui=function(a,b,c){var d=this.j,e=d.length;void 0===b&&(b=0);void 0===c&&(c=e);E&&(z(a,"function",G,"sortRange:sortfunc"),B(b,G,"sortRange:from"),B(c,G,"sortRange:to"));this.u&&ya(this);var f=c-b;if(1>=f)return this;(0>b||b>=e-1)&&Ca(b,"0 <= from < length",G,"sortRange:from");if(2===f)return c=d[b],e=d[b+1],0<a(c,e)&&(d[b]=e,d[b+1]=c,this.lb()),this;if(0===b)if(c>=e)d.sort(a);else for(b=d.slice(0,c),b.sort(a),a=0;a<c;a++)d[a]=b[a];else if(c>=e)for(c=d.slice(b),c.sort(a),a=b;a<e;a++)d[a]=c[a-b];
else for(e=d.slice(b,c),e.sort(a),a=b;a<c;a++)d[a]=e[a-b];this.lb();return this};t.reverse=function(){this.u&&ya(this);this.j.reverse();this.lb();return this};
na.Object.defineProperties(G.prototype,{_dataArray:{configurable:!0,get:function(){return this.j}},count:{configurable:!0,get:function(){return this.j.length}},size:{configurable:!0,get:function(){return this.j.length}},length:{configurable:!0,get:function(){return this.j.length}},iterator:{configurable:!0,get:function(){if(0>=this.j.length)return Cb;var a=this.Ka;return null!==a?(a.reset(),a):new Gb(this)}},iteratorBackwards:{configurable:!0,
enumerable:!0,get:function(){if(0>=this.j.length)return Cb;var a=this.Rg;return null!==a?(a.reset(),a):new Ib(this)}}});G.prototype.reverse=G.prototype.reverse;G.prototype.sortRange=G.prototype.Ui;G.prototype.sort=G.prototype.sort;G.prototype.toSet=G.prototype.Rv;G.prototype.toArray=G.prototype.Na;G.prototype.removeRange=G.prototype.removeRange;G.prototype.removeAt=G.prototype.nb;G.prototype["delete"]=G.prototype.delete;G.prototype.remove=G.prototype.remove;G.prototype.insertAt=G.prototype.Mb;
G.prototype.pop=G.prototype.pop;G.prototype.last=G.prototype.Ub;G.prototype.first=G.prototype.first;G.prototype.set=G.prototype.set;G.prototype.setElt=G.prototype.ld;G.prototype.get=G.prototype.get;G.prototype.elt=G.prototype.O;G.prototype.indexOf=G.prototype.indexOf;G.prototype.has=G.prototype.has;G.prototype.contains=G.prototype.contains;G.prototype.clear=G.prototype.clear;G.prototype.addAll=G.prototype.addAll;G.prototype.push=G.prototype.push;G.prototype.add=G.prototype.add;G.prototype.thaw=G.prototype.ja;
G.prototype.freeze=G.prototype.freeze;G.className="List";function Kb(a){this.fg=a;a.Ka=null;this.na=a.s;this.pa=null}Kb.prototype.reset=function(){var a=this.fg;a.Ka=null;this.na=a.s;this.pa=null};Kb.prototype.next=function(){var a=this.fg;if(a.s!==this.na){if(null===this.key)return!1;Ea(a)}var b=this.pa;b=null===b?a.ga:b.qa;if(null!==b)return this.pa=b,this.value=b.value,this.key=b.key,!0;this.Bd();return!1};Kb.prototype.hd=function(){return this.next()};
Kb.prototype.first=function(){var a=this.fg;this.na=a.s;a=a.ga;if(null!==a){this.pa=a;var b=a.value;this.key=a.key;return this.value=b}return null};Kb.prototype.any=function(a){var b=this.fg;b.Ka=null;var c=b.s;this.pa=null;for(var d=b.ga;null!==d;){if(a(d.value))return!0;b.s!==c&&Ea(b);d=d.qa}return!1};Kb.prototype.all=function(a){var b=this.fg;b.Ka=null;var c=b.s;this.pa=null;for(var d=b.ga;null!==d;){if(!a(d.value))return!1;b.s!==c&&Ea(b);d=d.qa}return!0};
Kb.prototype.each=function(a){var b=this.fg;b.Ka=null;var c=b.s;this.pa=null;for(var d=b.ga;null!==d;)a(d.value),b.s!==c&&Ea(b),d=d.qa;return this};Kb.prototype.map=function(a){var b=this.fg;b.Ka=null;for(var c=new G,d=b.s,e=b.ga;null!==e;)c.add(a(e.value)),b.s!==d&&Ea(b),e=e.qa;return c.iterator};Kb.prototype.filter=function(a){var b=this.fg;b.Ka=null;for(var c=new G,d=b.s,e=b.ga;null!==e;){var f=e.value;a(f)&&c.add(f);b.s!==d&&Ea(b);e=e.qa}return c.iterator};
Kb.prototype.Bd=function(){this.value=this.key=null;this.na=-1;this.fg.Ka=this};Kb.prototype.toString=function(){return null!==this.pa?"SetIterator@"+this.pa.value:"SetIterator"};na.Object.defineProperties(Kb.prototype,{iterator:{configurable:!0,get:function(){return this}},count:{configurable:!0,get:function(){return this.fg.Gb}}});Kb.prototype.first=Kb.prototype.first;Kb.prototype.hasNext=Kb.prototype.hd;Kb.prototype.next=Kb.prototype.next;Kb.prototype.reset=Kb.prototype.reset;
Kb.className="SetIterator";function H(a){rb(this);this.u=!1;this.Hb={};this.Gb=0;this.Ka=null;this.s=0;this.Ue=this.ga=null;void 0!==a&&("function"===typeof a||"string"===typeof a?Ha():this.addAll(a))}t=H.prototype;t.lb=function(){var a=this.s;a++;999999999<a&&(a=0);this.s=a};t.freeze=function(){this.u=!0;return this};t.ja=function(){this.u=!1;return this};t.toString=function(){return"Set()#"+Jb(this)};
t.add=function(a){if(null===a)return this;this.u&&ya(this,a);var b=a;Ia(a)&&(b=Nb(a));void 0===this.Hb[b]&&(this.Gb++,a=new Ob(a,a),this.Hb[b]=a,b=this.Ue,null===b?this.ga=a:(a.tl=b,b.qa=a),this.Ue=a,this.lb());return this};t.addAll=function(a){if(null===a)return this;this.u&&ya(this);if(Ja(a))for(var b=a.length,c=0;c<b;c++)this.add(a[c]);else for(a=a.iterator;a.next();)this.add(a.value);return this};
t.contains=function(a){if(null===a)return!1;var b=a;return Ia(a)&&(b=Jb(a),void 0===b)?!1:void 0!==this.Hb[b]};t.has=function(a){return this.contains(a)};t.xy=function(a){if(null===a)return!0;for(a=a.iterator;a.next();)if(!this.contains(a.value))return!1;return!0};t.yy=function(a){if(null===a)return!0;for(a=a.iterator;a.next();)if(this.contains(a.value))return!0;return!1};t.first=function(){var a=this.ga;return null===a?null:a.value};
H.prototype.any=function(a){for(var b=this.s,c=this.ga;null!==c;){if(a(c.value))return!0;this.s!==b&&Ea(this);c=c.qa}return!1};H.prototype.all=function(a){for(var b=this.s,c=this.ga;null!==c;){if(!a(c.value))return!1;this.s!==b&&Ea(this);c=c.qa}return!0};H.prototype.each=function(a){for(var b=this.s,c=this.ga;null!==c;)a(c.value),this.s!==b&&Ea(this),c=c.qa;return this};H.prototype.map=function(a){for(var b=new H,c=this.s,d=this.ga;null!==d;)b.add(a(d.value)),this.s!==c&&Ea(this),d=d.qa;return b};
H.prototype.filter=function(a){for(var b=new H,c=this.s,d=this.ga;null!==d;){var e=d.value;a(e)&&b.add(e);this.s!==c&&Ea(this);d=d.qa}return b};t=H.prototype;t.remove=function(a){if(null===a)return!1;this.u&&ya(this,a);var b=a;if(Ia(a)&&(b=Jb(a),void 0===b))return!1;a=this.Hb[b];if(void 0===a)return!1;var c=a.qa,d=a.tl;null!==c&&(c.tl=d);null!==d&&(d.qa=c);this.ga===a&&(this.ga=c);this.Ue===a&&(this.Ue=d);delete this.Hb[b];this.Gb--;this.lb();return!0};t.delete=function(a){return this.remove(a)};
t.rq=function(a){if(null===a)return this;this.u&&ya(this);if(Ja(a))for(var b=a.length,c=0;c<b;c++)this.remove(a[c]);else for(a=a.iterator;a.next();)this.remove(a.value);return this};t.Tz=function(a){if(null===a||0===this.count)return this;this.u&&ya(this);var b=new H;b.addAll(a);a=[];for(var c=this.iterator;c.next();){var d=c.value;b.contains(d)||a.push(d)}this.rq(a);return this};t.clear=function(){this.u&&ya(this);this.Hb={};this.Gb=0;null!==this.Ka&&this.Ka.reset();this.Ue=this.ga=null;this.lb()};
H.prototype.copy=function(){var a=new H,b=this.Hb,c;for(c in b)a.add(b[c].value);return a};H.prototype.Na=function(){var a=Array(this.Gb),b=this.Hb,c=0,d;for(d in b)a[c]=b[d].value,c++;return a};H.prototype.Qv=function(){var a=new G,b=this.Hb,c;for(c in b)a.add(b[c].value);return a};function rb(a){a.__gohashid=Pb++}function Nb(a){var b=a.__gohashid;void 0===b&&(b=Pb++,a.__gohashid=b);return b}function Jb(a){return a.__gohashid}
na.Object.defineProperties(H.prototype,{count:{configurable:!0,get:function(){return this.Gb}},size:{configurable:!0,get:function(){return this.Gb}},iterator:{configurable:!0,get:function(){if(0>=this.Gb)return Cb;var a=this.Ka;return null!==a?(a.reset(),a):new Kb(this)}}});H.prototype.toList=H.prototype.Qv;H.prototype.toArray=H.prototype.Na;H.prototype.clear=H.prototype.clear;H.prototype.retainAll=H.prototype.Tz;H.prototype.removeAll=H.prototype.rq;
H.prototype["delete"]=H.prototype.delete;H.prototype.remove=H.prototype.remove;H.prototype.first=H.prototype.first;H.prototype.containsAny=H.prototype.yy;H.prototype.containsAll=H.prototype.xy;H.prototype.has=H.prototype.has;H.prototype.contains=H.prototype.contains;H.prototype.addAll=H.prototype.addAll;H.prototype.add=H.prototype.add;H.prototype.thaw=H.prototype.ja;H.prototype.freeze=H.prototype.freeze;var Pb=1;H.className="Set";H.uniqueHash=rb;H.hashIdUnique=Nb;H.hashId=Jb;
function Qb(a){this.la=a;this.na=a.s;this.pa=null}Qb.prototype.reset=function(){this.na=this.la.s;this.pa=null};Qb.prototype.next=function(){var a=this.la;if(a.s!==this.na){if(null===this.key)return!1;Ea(a)}var b=this.pa;b=null===b?a.ga:b.qa;if(null!==b)return this.pa=b,this.value=this.key=a=b.key,!0;this.Bd();return!1};Qb.prototype.hd=function(){return this.next()};Qb.prototype.first=function(){var a=this.la;this.na=a.s;a=a.ga;return null!==a?(this.pa=a,this.value=this.key=a=a.key):null};
Qb.prototype.any=function(a){var b=this.la,c=b.s;this.pa=null;for(var d=b.ga;null!==d;){if(a(d.key))return!0;b.s!==c&&Ea(b);d=d.qa}return!1};Qb.prototype.all=function(a){var b=this.la,c=b.s;this.pa=null;for(var d=b.ga;null!==d;){if(!a(d.key))return!1;b.s!==c&&Ea(b);d=d.qa}return!0};Qb.prototype.each=function(a){var b=this.la,c=b.s;this.pa=null;for(var d=b.ga;null!==d;)a(d.key),b.s!==c&&Ea(b),d=d.qa;return this};
Qb.prototype.map=function(a){var b=this.la,c=b.s;this.pa=null;for(var d=new G,e=b.ga;null!==e;)d.add(a(e.key)),b.s!==c&&Ea(b),e=e.qa;return d.iterator};Qb.prototype.filter=function(a){var b=this.la,c=b.s;this.pa=null;for(var d=new G,e=b.ga;null!==e;){var f=e.key;a(f)&&d.add(f);b.s!==c&&Ea(b);e=e.qa}return d.iterator};Qb.prototype.Bd=function(){this.value=this.key=null;this.na=-1};Qb.prototype.toString=function(){return null!==this.pa?"MapKeySetIterator@"+this.pa.value:"MapKeySetIterator"};
na.Object.defineProperties(Qb.prototype,{iterator:{configurable:!0,get:function(){return this}},count:{configurable:!0,get:function(){return this.la.Gb}}});Qb.prototype.first=Qb.prototype.first;Qb.prototype.hasNext=Qb.prototype.hd;Qb.prototype.next=Qb.prototype.next;Qb.prototype.reset=Qb.prototype.reset;Qb.className="MapKeySetIterator";function Rb(a){H.call(this);rb(this);this.u=!0;this.la=a}ma(Rb,H);t=Rb.prototype;t.freeze=function(){return this};t.ja=function(){return this};
t.toString=function(){return"MapKeySet("+this.la.toString()+")"};t.add=function(){v("This Set is read-only: "+this.toString());return this};t.contains=function(a){return this.la.contains(a)};t.has=function(a){return this.contains(a)};t.remove=function(){v("This Set is read-only: "+this.toString());return!1};t.delete=function(a){return this.remove(a)};t.clear=function(){v("This Set is read-only: "+this.toString())};t.first=function(){var a=this.la.ga;return null!==a?a.key:null};
Rb.prototype.any=function(a){for(var b=this.la.ga;null!==b;){if(a(b.key))return!0;b=b.qa}return!1};Rb.prototype.all=function(a){for(var b=this.la.ga;null!==b;){if(!a(b.key))return!1;b=b.qa}return!0};Rb.prototype.each=function(a){for(var b=this.la.ga;null!==b;)a(b.key),b=b.qa;return this};Rb.prototype.map=function(a){for(var b=new H,c=this.la.ga;null!==c;)b.add(a(c.key)),c=c.qa;return b};Rb.prototype.filter=function(a){for(var b=new H,c=this.la.ga;null!==c;){var d=c.key;a(d)&&b.add(d);c=c.qa}return b};
Rb.prototype.copy=function(){return new Rb(this.la)};Rb.prototype.Rv=function(){var a=new H,b=this.la.Hb,c;for(c in b)a.add(b[c].key);return a};Rb.prototype.Na=function(){var a=this.la.Hb,b=Array(this.la.Gb),c=0,d;for(d in a)b[c]=a[d].key,c++;return b};Rb.prototype.Qv=function(){var a=new G,b=this.la.Hb,c;for(c in b)a.add(b[c].key);return a};
na.Object.defineProperties(Rb.prototype,{count:{configurable:!0,get:function(){return this.la.Gb}},size:{configurable:!0,get:function(){return this.la.Gb}},iterator:{configurable:!0,get:function(){return 0>=this.la.Gb?Cb:new Qb(this.la)}}});Rb.prototype.toList=Rb.prototype.Qv;Rb.prototype.toArray=Rb.prototype.Na;Rb.prototype.toSet=Rb.prototype.Rv;Rb.prototype.first=Rb.prototype.first;Rb.prototype.clear=Rb.prototype.clear;Rb.prototype["delete"]=Rb.prototype.delete;
Rb.prototype.remove=Rb.prototype.remove;Rb.prototype.has=Rb.prototype.has;Rb.prototype.contains=Rb.prototype.contains;Rb.prototype.add=Rb.prototype.add;Rb.prototype.thaw=Rb.prototype.ja;Rb.prototype.freeze=Rb.prototype.freeze;Rb.className="MapKeySet";function Sb(a){this.la=a;a.Te=null;this.na=a.s;this.pa=null}Sb.prototype.reset=function(){var a=this.la;a.Te=null;this.na=a.s;this.pa=null};
Sb.prototype.next=function(){var a=this.la;if(a.s!==this.na){if(null===this.key)return!1;Ea(a)}var b=this.pa;b=null===b?a.ga:b.qa;if(null!==b)return this.pa=b,this.value=b.value,this.key=b.key,!0;this.Bd();return!1};Sb.prototype.hd=function(){return this.next()};Sb.prototype.first=function(){var a=this.la;this.na=a.s;a=a.ga;if(null!==a){this.pa=a;var b=a.value;this.key=a.key;return this.value=b}return null};
Sb.prototype.any=function(a){var b=this.la;b.Te=null;var c=b.s;this.pa=null;for(var d=b.ga;null!==d;){if(a(d.value))return!0;b.s!==c&&Ea(b);d=d.qa}return!1};Sb.prototype.all=function(a){var b=this.la;b.Te=null;var c=b.s;this.pa=null;for(var d=b.ga;null!==d;){if(!a(d.value))return!1;b.s!==c&&Ea(b);d=d.qa}return!0};Sb.prototype.each=function(a){var b=this.la;b.Te=null;var c=b.s;this.pa=null;for(var d=b.ga;null!==d;)a(d.value),b.s!==c&&Ea(b),d=d.qa;return this};
Sb.prototype.map=function(a){var b=this.la;b.Te=null;var c=b.s;this.pa=null;for(var d=new G,e=b.ga;null!==e;)d.add(a(e.value)),b.s!==c&&Ea(b),e=e.qa;return d.iterator};Sb.prototype.filter=function(a){var b=this.la;b.Te=null;var c=b.s;this.pa=null;for(var d=new G,e=b.ga;null!==e;){var f=e.value;a(f)&&d.add(f);b.s!==c&&Ea(b);e=e.qa}return d.iterator};Sb.prototype.Bd=function(){this.value=this.key=null;this.na=-1;this.la.Te=this};
Sb.prototype.toString=function(){return null!==this.pa?"MapValueSetIterator@"+this.pa.value:"MapValueSetIterator"};na.Object.defineProperties(Sb.prototype,{iterator:{configurable:!0,get:function(){return this}},count:{configurable:!0,get:function(){return this.la.Gb}}});Sb.prototype.first=Sb.prototype.first;Sb.prototype.hasNext=Sb.prototype.hd;Sb.prototype.next=Sb.prototype.next;Sb.prototype.reset=Sb.prototype.reset;Sb.className="MapValueSetIterator";
function Ob(a,b){this.key=a;this.value=b;this.tl=this.qa=null}Ob.prototype.toString=function(){return"{"+this.key+":"+this.value+"}"};Ob.className="KeyValuePair";function Tb(a){this.la=a;a.Ka=null;this.na=a.s;this.pa=null}Tb.prototype.reset=function(){var a=this.la;a.Ka=null;this.na=a.s;this.pa=null};
Tb.prototype.next=function(){var a=this.la;if(a.s!==this.na){if(null===this.key)return!1;Ea(a)}var b=this.pa;b=null===b?a.ga:b.qa;if(null!==b)return this.pa=b,this.key=b.key,this.value=b.value,!0;this.Bd();return!1};Tb.prototype.hd=function(){return this.next()};Tb.prototype.first=function(){var a=this.la;this.na=a.s;a=a.ga;return null!==a?(this.pa=a,this.key=a.key,this.value=a.value,a):null};
Tb.prototype.any=function(a){var b=this.la;b.Ka=null;var c=b.s;this.pa=null;for(var d=b.ga;null!==d;){if(a(d))return!0;b.s!==c&&Ea(b);d=d.qa}return!1};Tb.prototype.all=function(a){var b=this.la;b.Ka=null;var c=b.s;this.pa=null;for(var d=b.ga;null!==d;){if(!a(d))return!1;b.s!==c&&Ea(b);d=d.qa}return!0};Tb.prototype.each=function(a){var b=this.la;b.Ka=null;var c=b.s;this.pa=null;for(var d=b.ga;null!==d;)a(d),b.s!==c&&Ea(b),d=d.qa;return this};
Tb.prototype.map=function(a){var b=this.la;b.Ka=null;var c=b.s;this.pa=null;for(var d=new G,e=b.ga;null!==e;)d.add(a(e)),b.s!==c&&Ea(b),e=e.qa;return d.iterator};Tb.prototype.filter=function(a){var b=this.la;b.Ka=null;var c=b.s;this.pa=null;for(var d=new G,e=b.ga;null!==e;)a(e)&&d.add(e),b.s!==c&&Ea(b),e=e.qa;return d.iterator};Tb.prototype.Bd=function(){this.value=this.key=null;this.na=-1;this.la.Ka=this};Tb.prototype.toString=function(){return null!==this.pa?"MapIterator@"+this.pa:"MapIterator"};
na.Object.defineProperties(Tb.prototype,{iterator:{configurable:!0,get:function(){return this}},count:{configurable:!0,get:function(){return this.la.Gb}}});Tb.prototype.first=Tb.prototype.first;Tb.prototype.hasNext=Tb.prototype.hd;Tb.prototype.next=Tb.prototype.next;Tb.prototype.reset=Tb.prototype.reset;Tb.className="MapIterator";
function Ub(a){rb(this);this.u=!1;this.Hb={};this.Gb=0;this.Te=this.Ka=null;this.s=0;this.Ue=this.ga=null;void 0!==a&&("function"===typeof a||"string"===typeof a?Ha():this.addAll(a))}t=Ub.prototype;t.lb=function(){var a=this.s;a++;999999999<a&&(a=0);this.s=a};t.freeze=function(){this.u=!0;return this};t.ja=function(){this.u=!1;return this};t.toString=function(){return"Map()#"+Jb(this)};
t.add=function(a,b){this.u&&ya(this,a);var c=a;Ia(a)&&(c=Nb(a));var d=this.Hb[c];void 0===d?(this.Gb++,a=new Ob(a,b),this.Hb[c]=a,c=this.Ue,null===c?this.ga=a:(a.tl=c,c.qa=a),this.Ue=a,this.lb()):d.value=b;return this};t.set=function(a,b){return this.add(a,b)};t.addAll=function(a){if(null===a)return this;if(Ja(a))for(var b=a.length,c=0;c<b;c++){var d=a[c];this.add(d.key,d.value)}else for(a=a.iterator;a.next();)b=a.value,this.add(b.key,b.value);return this};t.first=function(){return this.ga};
Ub.prototype.any=function(a){for(var b=this.s,c=this.ga;null!==c;){if(a(c))return!0;this.s!==b&&Ea(this);c=c.qa}return!1};Ub.prototype.all=function(a){for(var b=this.s,c=this.ga;null!==c;){if(!a(c))return!1;this.s!==b&&Ea(this);c=c.qa}return!0};Ub.prototype.each=function(a){for(var b=this.s,c=this.ga;null!==c;)a(c),this.s!==b&&Ea(this),c=c.qa;return this};Ub.prototype.map=function(a){for(var b=new Ub,c=this.s,d=this.ga;null!==d;)b.add(d.key,a(d)),this.s!==c&&Ea(this),d=d.qa;return b};
Ub.prototype.filter=function(a){for(var b=new Ub,c=this.s,d=this.ga;null!==d;)a(d)&&b.add(d.key,d.value),this.s!==c&&Ea(this),d=d.qa;return b};t=Ub.prototype;t.contains=function(a){var b=a;return Ia(a)&&(b=Jb(a),void 0===b)?!1:void 0!==this.Hb[b]};t.has=function(a){return this.contains(a)};t.K=function(a){var b=a;if(Ia(a)&&(b=Jb(a),void 0===b))return null;a=this.Hb[b];return void 0===a?null:a.value};t.get=function(a){return this.K(a)};
t.remove=function(a){if(null===a)return!1;this.u&&ya(this,a);var b=a;if(Ia(a)&&(b=Jb(a),void 0===b))return!1;a=this.Hb[b];if(void 0===a)return!1;var c=a.qa,d=a.tl;null!==c&&(c.tl=d);null!==d&&(d.qa=c);this.ga===a&&(this.ga=c);this.Ue===a&&(this.Ue=d);delete this.Hb[b];this.Gb--;this.lb();return!0};t.delete=function(a){return this.remove(a)};t.clear=function(){this.u&&ya(this);this.Hb={};this.Gb=0;null!==this.Ka&&this.Ka.reset();null!==this.Te&&this.Te.reset();this.Ue=this.ga=null;this.lb()};
Ub.prototype.copy=function(){var a=new Ub,b=this.Hb,c;for(c in b){var d=b[c];a.add(d.key,d.value)}return a};Ub.prototype.Na=function(){var a=this.Hb,b=Array(this.Gb),c=0,d;for(d in a){var e=a[d];b[c]=new Ob(e.key,e.value);c++}return b};Ub.prototype.ae=function(){return new Rb(this)};
na.Object.defineProperties(Ub.prototype,{count:{configurable:!0,get:function(){return this.Gb}},size:{configurable:!0,get:function(){return this.Gb}},iterator:{configurable:!0,get:function(){if(0>=this.count)return Cb;var a=this.Ka;return null!==a?(a.reset(),a):new Tb(this)}},iteratorKeys:{configurable:!0,get:function(){return 0>=this.count?Cb:new Qb(this)}},iteratorValues:{configurable:!0,get:function(){if(0>=this.count)return Cb;
var a=this.Te;return null!==a?(a.reset(),a):new Sb(this)}}});Ub.prototype.toKeySet=Ub.prototype.ae;Ub.prototype.toArray=Ub.prototype.Na;Ub.prototype.clear=Ub.prototype.clear;Ub.prototype["delete"]=Ub.prototype.delete;Ub.prototype.remove=Ub.prototype.remove;Ub.prototype.get=Ub.prototype.get;Ub.prototype.getValue=Ub.prototype.K;Ub.prototype.has=Ub.prototype.has;Ub.prototype.contains=Ub.prototype.contains;Ub.prototype.first=Ub.prototype.first;Ub.prototype.addAll=Ub.prototype.addAll;
Ub.prototype.set=Ub.prototype.set;Ub.prototype.add=Ub.prototype.add;Ub.prototype.thaw=Ub.prototype.ja;Ub.prototype.freeze=Ub.prototype.freeze;Ub.className="Map";function J(a,b){void 0===a?this.F=this.D=0:"number"===typeof a&&"number"===typeof b?(this.D=a,this.F=b):v("Invalid arguments to Point constructor: "+a+", "+b);this.u=!1}J.prototype.assign=function(a){this.D=a.D;this.F=a.F;return this};J.prototype.h=function(a,b){this.D=a;this.F=b;return this};
J.prototype.ug=function(a,b){E&&(z(a,"number",J,"setTo:x"),z(b,"number",J,"setTo:y"),this.ha());this.D=a;this.F=b;return this};J.prototype.set=function(a){E&&(w(a,J,J,"set:p"),this.ha());this.D=a.D;this.F=a.F;return this};J.prototype.copy=function(){var a=new J;a.D=this.D;a.F=this.F;return a};t=J.prototype;t.ia=function(){this.u=!0;Object.freeze(this);return this};t.J=function(){return Object.isFrozen(this)?this:this.copy().freeze()};t.freeze=function(){this.u=!0;return this};
t.ja=function(){Object.isFrozen(this)&&v("cannot thaw constant: "+this);this.u=!1;return this};t.ha=function(a){if(this.u){var b="The Point is frozen, so its properties cannot be set: "+this.toString();void 0!==a&&(b+="  to value: "+a);v(b)}};function Wb(a){if("string"===typeof a){a=a.split(" ");for(var b=0,c=0;""===a[b];)b++;var d=a[b++];d&&(c=parseFloat(d));for(var e=0;""===a[b];)b++;(d=a[b++])&&(e=parseFloat(d));return new J(c,e)}return new J}
function Xb(a){E&&w(a,J);return a.x.toString()+" "+a.y.toString()}t.toString=function(){return"Point("+this.x+","+this.y+")"};t.A=function(a){return a instanceof J?this.D===a.x&&this.F===a.y:!1};t.Ci=function(a,b){return this.D===a&&this.F===b};t.Ra=function(a){return K.B(this.D,a.x)&&K.B(this.F,a.y)};t.add=function(a){E&&(w(a,J,J,"add:p"),this.ha());this.D+=a.x;this.F+=a.y;return this};t.$d=function(a){E&&(w(a,J,J,"subtract:p"),this.ha());this.D-=a.x;this.F-=a.y;return this};
t.offset=function(a,b){E&&(B(a,J,"offset:dx"),B(b,J,"offset:dy"),this.ha());this.D+=a;this.F+=b;return this};J.prototype.rotate=function(a){E&&(B(a,J,"rotate:angle"),this.ha());if(0===a)return this;var b=this.D,c=this.F;if(0===b&&0===c)return this;360<=a?a-=360:0>a&&(a+=360);if(90===a){a=0;var d=1}else 180===a?(a=-1,d=0):270===a?(a=0,d=-1):(d=a*Math.PI/180,a=Math.cos(d),d=Math.sin(d));this.D=a*b-d*c;this.F=d*b+a*c;return this};t=J.prototype;
t.scale=function(a,b){E&&(B(a,J,"scale:sx"),B(b,J,"scale:sy"),this.ha());this.D*=a;this.F*=b;return this};t.Ee=function(a){E&&w(a,J,J,"distanceSquaredPoint:p");var b=a.x-this.D;a=a.y-this.F;return b*b+a*a};t.gd=function(a,b){E&&(B(a,J,"distanceSquared:px"),B(b,J,"distanceSquared:py"));a-=this.D;b-=this.F;return a*a+b*b};t.normalize=function(){E&&this.ha();var a=this.D,b=this.F,c=Math.sqrt(a*a+b*b);0<c&&(this.D=a/c,this.F=b/c);return this};
t.Wa=function(a){E&&w(a,J,J,"directionPoint:p");return Yb(a.x-this.D,a.y-this.F)};t.direction=function(a,b){E&&(B(a,J,"direction:px"),B(b,J,"direction:py"));return Yb(a-this.D,b-this.F)};function Yb(a,b){if(0===a)return 0<b?90:0>b?270:0;if(0===b)return 0<a?0:180;if(isNaN(a)||isNaN(b))return 0;var c=180*Math.atan(Math.abs(b/a))/Math.PI;0>a?c=0>b?c+180:180-c:0>b&&(c=360-c);return c}
t.Nz=function(a,b,c,d){E&&(B(a,J,"projectOntoLineSegment:px"),B(b,J,"projectOntoLineSegment:py"),B(c,J,"projectOntoLineSegment:qx"),B(d,J,"projectOntoLineSegment:qy"));K.Pi(a,b,c,d,this.D,this.F,this);return this};t.Oz=function(a,b){E&&(w(a,J,J,"projectOntoLineSegmentPoint:p"),w(b,J,J,"projectOntoLineSegmentPoint:q"));K.Pi(a.x,a.y,b.x,b.y,this.D,this.F,this);return this};
t.Yz=function(a,b,c,d){E&&(B(a,J,"snapToGrid:originx"),B(b,J,"snapToGrid:originy"),B(c,J,"snapToGrid:cellwidth"),B(d,J,"snapToGrid:cellheight"));K.Yp(this.D,this.F,a,b,c,d,this);return this};t.Zz=function(a,b){E&&(w(a,J,J,"snapToGridPoint:p"),w(b,Zb,J,"snapToGridPoint:q"));K.Yp(this.D,this.F,a.x,a.y,b.width,b.height,this);return this};t.Si=function(a,b){E&&(w(a,L,J,"setRectSpot:r"),w(b,M,J,"setRectSpot:spot"),this.ha());this.D=a.x+b.x*a.width+b.offsetX;this.F=a.y+b.y*a.height+b.offsetY;return this};
t.nk=function(a,b,c,d,e){E&&(B(a,J,"setSpot:x"),B(b,J,"setSpot:y"),B(c,J,"setSpot:w"),B(d,J,"setSpot:h"),(0>c||0>d)&&v("Point.setSpot:Width and height cannot be negative"),w(e,M,J,"setSpot:spot"),this.ha());this.D=a+e.x*c+e.offsetX;this.F=b+e.y*d+e.offsetY;return this};t.transform=function(a){E&&w(a,$b,J,"transform:t");a.va(this);return this};function ac(a,b){E&&w(b,$b,J,"transformInverted:t");b.Xd(a);return a}
function cc(a,b,c,d,e,f){E&&(B(a,J,"distanceLineSegmentSquared:px"),B(b,J,"distanceLineSegmentSquared:py"),B(c,J,"distanceLineSegmentSquared:ax"),B(d,J,"distanceLineSegmentSquared:ay"),B(e,J,"distanceLineSegmentSquared:bx"),B(f,J,"distanceLineSegmentSquared:by"));var g=e-c,h=f-d,k=g*g+h*h;c-=a;d-=b;var l=-c*g-d*h;if(0>=l||l>=k)return g=e-a,h=f-b,Math.min(c*c+d*d,g*g+h*h);a=g*d-h*c;return a*a/k}
function dc(a,b,c,d){E&&(B(a,J,"distanceSquared:px"),B(b,J,"distanceSquared:py"),B(c,J,"distanceSquared:qx"),B(d,J,"distanceSquared:qy"));a=c-a;b=d-b;return a*a+b*b}function ec(a,b,c,d){E&&(B(a,J,"direction:px"),B(b,J,"direction:py"),B(c,J,"direction:qx"),B(d,J,"direction:qy"));a=c-a;b=d-b;if(0===a)return 0<b?90:0>b?270:0;if(0===b)return 0<a?0:180;if(isNaN(a)||isNaN(b))return 0;d=180*Math.atan(Math.abs(b/a))/Math.PI;0>a?d=0>b?d+180:180-d:0>b&&(d=360-d);return d}
t.o=function(){return isFinite(this.x)&&isFinite(this.y)};J.alloc=function(){var a=fc.pop();return void 0===a?new J:a};J.allocAt=function(a,b){var c=fc.pop();if(void 0===c)return new J(a,b);c.x=a;c.y=b;return c};J.free=function(a){fc.push(a)};
na.Object.defineProperties(J.prototype,{x:{configurable:!0,get:function(){return this.D},set:function(a){E&&(z(a,"number",J,"x"),this.ha(a));this.D=a}},y:{configurable:!0,get:function(){return this.F},set:function(a){E&&(z(a,"number",J,"y"),this.ha(a));this.F=a}}});J.prototype.isReal=J.prototype.o;J.prototype.setSpot=J.prototype.nk;J.prototype.setRectSpot=J.prototype.Si;J.prototype.snapToGridPoint=J.prototype.Zz;J.prototype.snapToGrid=J.prototype.Yz;
J.prototype.projectOntoLineSegmentPoint=J.prototype.Oz;J.prototype.projectOntoLineSegment=J.prototype.Nz;J.prototype.direction=J.prototype.direction;J.prototype.directionPoint=J.prototype.Wa;J.prototype.normalize=J.prototype.normalize;J.prototype.distanceSquared=J.prototype.gd;J.prototype.distanceSquaredPoint=J.prototype.Ee;J.prototype.scale=J.prototype.scale;J.prototype.rotate=J.prototype.rotate;J.prototype.offset=J.prototype.offset;J.prototype.subtract=J.prototype.$d;J.prototype.add=J.prototype.add;
J.prototype.equalsApprox=J.prototype.Ra;J.prototype.equalTo=J.prototype.Ci;J.prototype.equals=J.prototype.A;J.prototype.set=J.prototype.set;J.prototype.setTo=J.prototype.ug;var gc=null,hc=null,ic=null,pc=null,qc=null,fc=[];J.className="Point";J.parse=Wb;J.stringify=Xb;J.distanceLineSegmentSquared=cc;J.distanceSquared=dc;J.direction=ec;J.Origin=gc=(new J(0,0)).ia();J.InfiniteTopLeft=hc=(new J(-Infinity,-Infinity)).ia();J.InfiniteBottomRight=ic=(new J(Infinity,Infinity)).ia();
J.SixPoint=pc=(new J(6,6)).ia();J.NoPoint=qc=(new J(NaN,NaN)).ia();J.parse=Wb;J.stringify=Xb;J.distanceLineSegmentSquared=cc;J.distanceSquared=dc;J.direction=ec;function Zb(a,b){void 0===a?this.Z=this.aa=0:"number"===typeof a&&(0<=a||isNaN(a))&&"number"===typeof b&&(0<=b||isNaN(b))?(this.aa=a,this.Z=b):v("Invalid arguments to Size constructor: "+a+", "+b);this.u=!1}var rc,sc,tc,uc,vc,wc,xc;Zb.prototype.assign=function(a){this.aa=a.aa;this.Z=a.Z;return this};
Zb.prototype.h=function(a,b){this.aa=a;this.Z=b;return this};Zb.prototype.ug=function(a,b){E&&(z(a,"number",Zb,"setTo:w"),z(b,"number",Zb,"setTo:h"),0>a&&Ca(a,">= 0",Zb,"setTo:w"),0>b&&Ca(b,">= 0",Zb,"setTo:h"),this.ha());this.aa=a;this.Z=b;return this};Zb.prototype.set=function(a){E&&(w(a,Zb,Zb,"set:s"),this.ha());this.aa=a.aa;this.Z=a.Z;return this};Zb.prototype.copy=function(){var a=new Zb;a.aa=this.aa;a.Z=this.Z;return a};t=Zb.prototype;t.ia=function(){this.u=!0;Object.freeze(this);return this};
t.J=function(){return Object.isFrozen(this)?this:this.copy().freeze()};t.freeze=function(){this.u=!0;return this};t.ja=function(){Object.isFrozen(this)&&v("cannot thaw constant: "+this);this.u=!1;return this};t.ha=function(a){if(this.u){var b="The Size is frozen, so its properties cannot be set: "+this.toString();void 0!==a&&(b+="  to value: "+a);v(b)}};
function zc(a){if("string"===typeof a){a=a.split(" ");for(var b=0,c=0;""===a[b];)b++;var d=a[b++];d&&(c=parseFloat(d));for(var e=0;""===a[b];)b++;(d=a[b++])&&(e=parseFloat(d));return new Zb(c,e)}return new Zb}function Ac(a){E&&w(a,Zb);return a.width.toString()+" "+a.height.toString()}t.toString=function(){return"Size("+this.width+","+this.height+")"};t.A=function(a){return a instanceof Zb?this.aa===a.width&&this.Z===a.height:!1};t.Ci=function(a,b){return this.aa===a&&this.Z===b};
t.Ra=function(a){return K.B(this.aa,a.width)&&K.B(this.Z,a.height)};t.o=function(){return isFinite(this.width)&&isFinite(this.height)};Zb.alloc=function(){var a=Bc.pop();return void 0===a?new Zb:a};Zb.free=function(a){Bc.push(a)};
na.Object.defineProperties(Zb.prototype,{width:{configurable:!0,get:function(){return this.aa},set:function(a){E&&(z(a,"number",Zb,"width"),this.ha(a));0>a&&Ca(a,">= 0",Zb,"width");this.aa=a}},height:{configurable:!0,get:function(){return this.Z},set:function(a){E&&(z(a,"number",Zb,"height"),this.ha(a));0>a&&Ca(a,">= 0",Zb,"height");this.Z=a}}});Zb.prototype.isReal=Zb.prototype.o;Zb.prototype.equalsApprox=Zb.prototype.Ra;Zb.prototype.equalTo=Zb.prototype.Ci;
Zb.prototype.equals=Zb.prototype.A;Zb.prototype.set=Zb.prototype.set;Zb.prototype.setTo=Zb.prototype.ug;var Bc=[];Zb.className="Size";Zb.parse=zc;Zb.stringify=Ac;Zb.ZeroSize=rc=(new Zb(0,0)).ia();Zb.OneSize=sc=(new Zb(1,1)).ia();Zb.SixSize=tc=(new Zb(6,6)).ia();Zb.EightSize=uc=(new Zb(8,8)).ia();Zb.TenSize=vc=(new Zb(10,10)).ia();Zb.InfiniteSize=wc=(new Zb(Infinity,Infinity)).ia();Zb.NoSize=xc=(new Zb(NaN,NaN)).ia();Zb.parse=zc;Zb.stringify=Ac;
function L(a,b,c,d){void 0===a?this.Z=this.aa=this.F=this.D=0:a instanceof J?b instanceof J?(this.D=Math.min(a.D,b.D),this.F=Math.min(a.F,b.F),this.aa=Math.abs(a.D-b.D),this.Z=Math.abs(a.F-b.F)):b instanceof Zb?(this.D=a.D,this.F=a.F,this.aa=b.aa,this.Z=b.Z):v("Incorrect arguments supplied to Rect constructor"):"number"===typeof a&&"number"===typeof b&&"number"===typeof c&&(0<=c||isNaN(c))&&"number"===typeof d&&(0<=d||isNaN(d))?(this.D=a,this.F=b,this.aa=c,this.Z=d):v("Invalid arguments to Rect constructor: "+
a+", "+b+", "+c+", "+d);this.u=!1}t=L.prototype;t.assign=function(a){this.D=a.D;this.F=a.F;this.aa=a.aa;this.Z=a.Z;return this};t.h=function(a,b,c,d){this.D=a;this.F=b;this.aa=c;this.Z=d;return this};function Cc(a,b,c){a.aa=b;a.Z=c}t.ug=function(a,b,c,d){E&&(z(a,"number",L,"setTo:x"),z(b,"number",L,"setTo:y"),z(c,"number",L,"setTo:w"),z(d,"number",L,"setTo:h"),0>c&&Ca(c,">= 0",L,"setTo:w"),0>d&&Ca(d,">= 0",L,"setTo:h"),this.ha());this.D=a;this.F=b;this.aa=c;this.Z=d;return this};
t.set=function(a){E&&(w(a,L,L,"set:r"),this.ha());this.D=a.D;this.F=a.F;this.aa=a.aa;this.Z=a.Z;return this};t.nd=function(a){E&&(w(a,J,L,"setPoint:p"),this.ha());this.D=a.D;this.F=a.F;return this};t.Wz=function(a){E&&(w(a,Zb,L,"setSize:s"),this.ha());this.aa=a.aa;this.Z=a.Z;return this};L.prototype.copy=function(){var a=new L;a.D=this.D;a.F=this.F;a.aa=this.aa;a.Z=this.Z;return a};t=L.prototype;t.ia=function(){this.u=!0;Object.freeze(this);return this};
t.J=function(){return Object.isFrozen(this)?this:this.copy().freeze()};t.freeze=function(){this.u=!0;return this};t.ja=function(){Object.isFrozen(this)&&v("cannot thaw constant: "+this);this.u=!1;return this};t.ha=function(a){if(this.u){var b="The Rect is frozen, so its properties cannot be set: "+this.toString();void 0!==a&&(b+="  to value: "+a);v(b)}};
function Dc(a){if("string"===typeof a){a=a.split(" ");for(var b=0,c=0;""===a[b];)b++;var d=a[b++];d&&(c=parseFloat(d));for(var e=0;""===a[b];)b++;(d=a[b++])&&(e=parseFloat(d));for(var f=0;""===a[b];)b++;(d=a[b++])&&(f=parseFloat(d));for(var g=0;""===a[b];)b++;(d=a[b++])&&(g=parseFloat(d));return new L(c,e,f,g)}return new L}function Ec(a){E&&w(a,L);return a.x.toString()+" "+a.y.toString()+" "+a.width.toString()+" "+a.height.toString()}
t.toString=function(){return"Rect("+this.x+","+this.y+","+this.width+","+this.height+")"};t.A=function(a){return a instanceof L?this.D===a.x&&this.F===a.y&&this.aa===a.width&&this.Z===a.height:!1};t.Ci=function(a,b,c,d){return this.D===a&&this.F===b&&this.aa===c&&this.Z===d};t.Ra=function(a){return K.B(this.D,a.x)&&K.B(this.F,a.y)&&K.B(this.aa,a.width)&&K.B(this.Z,a.height)};function Fc(a,b){return K.ca(a.D,b.x)&&K.ca(a.F,b.y)&&K.ca(a.aa,b.width)&&K.ca(a.Z,b.height)}
t.fa=function(a){E&&w(a,J,L,"containsPoint:p");return this.D<=a.x&&this.D+this.aa>=a.x&&this.F<=a.y&&this.F+this.Z>=a.y};t.pf=function(a){E&&w(a,L,L,"containsRect:r");return this.D<=a.x&&a.x+a.width<=this.D+this.aa&&this.F<=a.y&&a.y+a.height<=this.F+this.Z};
t.contains=function(a,b,c,d){E?(B(a,L,"contains:x"),B(b,L,"contains:y"),void 0===c?c=0:B(c,L,"contains:w"),void 0===d?d=0:B(d,L,"contains:h"),(0>c||0>d)&&v("Rect.contains:Width and height cannot be negative")):(void 0===c&&(c=0),void 0===d&&(d=0));return this.D<=a&&a+c<=this.D+this.aa&&this.F<=b&&b+d<=this.F+this.Z};t.reset=function(){E&&this.ha();this.Z=this.aa=this.F=this.D=0};t.offset=function(a,b){E&&(B(a,L,"offset:dx"),B(b,L,"offset:dy"),this.ha());this.D+=a;this.F+=b;return this};
t.Yc=function(a,b){E&&(B(a,L,"inflate:w"),B(b,L,"inflate:h"));return Ic(this,b,a,b,a)};t.Op=function(a){E&&w(a,Jc,L,"addMargin:m");return Ic(this,a.top,a.right,a.bottom,a.left)};t.Pv=function(a){E&&w(a,Jc,L,"subtractMargin:m");return Ic(this,-a.top,-a.right,-a.bottom,-a.left)};t.qz=function(a,b,c,d){E&&(B(a,L,"grow:t"),B(b,L,"grow:r"),B(c,L,"grow:b"),B(d,L,"grow:l"));return Ic(this,a,b,c,d)};
function Ic(a,b,c,d,e){E&&a.ha();var f=a.aa;c+e<=-f?(a.D+=f/2,a.aa=0):(a.D-=e,a.aa+=c+e);c=a.Z;b+d<=-c?(a.F+=c/2,a.Z=0):(a.F-=b,a.Z+=b+d);return a}t.vz=function(a){E&&w(a,L,L,"intersectRect:r");return Kc(this,a.x,a.y,a.width,a.height)};t.iv=function(a,b,c,d){E&&(B(a,L,"intersect:x"),B(b,L,"intersect:y"),B(c,L,"intersect:w"),B(d,L,"intersect:h"),(0>c||0>d)&&v("Rect.intersect:Width and height cannot be negative"));return Kc(this,a,b,c,d)};
function Kc(a,b,c,d,e){E&&a.ha();var f=Math.max(a.D,b),g=Math.max(a.F,c);b=Math.min(a.D+a.aa,b+d);c=Math.min(a.F+a.Z,c+e);a.D=f;a.F=g;a.aa=Math.max(0,b-f);a.Z=Math.max(0,c-g);return a}t.Mc=function(a){E&&w(a,L,L,"intersectsRect:r");return this.jv(a.x,a.y,a.width,a.height)};
t.jv=function(a,b,c,d){E&&(B(a,L,"intersects:x"),B(b,L,"intersects:y"),B(a,L,"intersects:w"),B(b,L,"intersects:h"),(0>c||0>d)&&v("Rect.intersects:Width and height cannot be negative"));var e=this.aa,f=this.D;if(Infinity!==e&&Infinity!==c&&(e+=f,c+=a,isNaN(c)||isNaN(e)||f>c||a>e))return!1;a=this.Z;c=this.F;return Infinity!==a&&Infinity!==d&&(a+=c,d+=b,isNaN(d)||isNaN(a)||c>d||b>a)?!1:!0};
function Oc(a,b,c){var d=a.aa,e=a.D,f=b.x-c;if(e>b.width+c+c+f||f>d+e)return!1;d=a.Z;a=a.F;e=b.y-c;return a>b.height+c+c+e||e>d+a?!1:!0}t.Le=function(a){E&&w(a,J,L,"unionPoint:p");return Pc(this,a.x,a.y,0,0)};t.Zc=function(a){E&&w(a,L,L,"unionRect:r");return Pc(this,a.D,a.F,a.aa,a.Z)};
t.Wv=function(a,b,c,d){E?(B(a,L,"union:x"),B(b,L,"union:y"),void 0===c?c=0:B(c,L,"union:w"),void 0===d?d=0:B(d,L,"union:h"),(0>c||0>d)&&v("Rect.union:Width and height cannot be negative"),this.ha()):(void 0===c&&(c=0),void 0===d&&(d=0));return Pc(this,a,b,c,d)};function Pc(a,b,c,d,e){var f=Math.min(a.D,b),g=Math.min(a.F,c);b=Math.max(a.D+a.aa,b+d);c=Math.max(a.F+a.Z,c+e);a.D=f;a.F=g;a.aa=b-f;a.Z=c-g;return a}
t.nk=function(a,b,c){E&&(B(a,L,"setSpot:x"),B(b,L,"setSpot:y"),w(c,M,L,"setSpot:spot"),this.ha());this.D=a-c.offsetX-c.x*this.aa;this.F=b-c.offsetY-c.y*this.Z;return this};
function Qc(a,b,c,d,e,f,g,h){E?(B(a,L,"contains:rx"),B(b,L,"contains:ry"),B(c,L,"contains:rw"),B(d,L,"contains:rh"),B(e,L,"contains:x"),B(f,L,"contains:y"),void 0===g?g=0:B(g,L,"contains:w"),void 0===h?h=0:B(h,L,"contains:h"),(0>c||0>d||0>g||0>h)&&v("Rect.contains:Width and height cannot be negative")):(void 0===g&&(g=0),void 0===h&&(h=0));return a<=e&&e+g<=a+c&&b<=f&&f+h<=b+d}
function Rc(a,b,c,d,e,f,g,h){E&&(B(a,L,"intersects:rx"),B(b,L,"intersects:ry"),B(c,L,"intersects:rw"),B(d,L,"intersects:rh"),B(e,L,"intersects:x"),B(f,L,"intersects:y"),B(g,L,"intersects:w"),B(h,L,"intersects:h"),(0>c||0>d||0>g||0>h)&&v("Rect.intersects:Width and height cannot be negative"));return a>g+e||e>c+a?!1:b>h+f||f>d+b?!1:!0}t.o=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)};t.xz=function(){return 0===this.width&&0===this.height};
L.alloc=function(){var a=Sc.pop();return void 0===a?new L:a};L.allocAt=function(a,b,c,d){var e=Sc.pop();return void 0===e?new L(a,b,c,d):e.h(a,b,c,d)};L.free=function(a){Sc.push(a)};
na.Object.defineProperties(L.prototype,{x:{configurable:!0,get:function(){return this.D},set:function(a){E&&(z(a,"number",L,"x"),this.ha(a));this.D=a}},y:{configurable:!0,get:function(){return this.F},set:function(a){E&&(z(a,"number",L,"y"),this.ha(a));this.F=a}},width:{configurable:!0,get:function(){return this.aa},set:function(a){E&&(z(a,"number",L,"width"),this.ha(a));0>a&&Ca(a,">= 0",L,"width");this.aa=a}},height:{configurable:!0,get:function(){return this.Z},
set:function(a){E&&(z(a,"number",L,"height"),this.ha(a));0>a&&Ca(a,">= 0",L,"height");this.Z=a}},left:{configurable:!0,get:function(){return this.D},set:function(a){E&&(z(a,"number",L,"left"),this.ha(a));this.D=a}},top:{configurable:!0,get:function(){return this.F},set:function(a){E&&(z(a,"number",L,"top"),this.ha(a));this.F=a}},right:{configurable:!0,get:function(){return this.D+this.aa},set:function(a){E&&(B(a,L,"right"),this.ha(a));this.D+=a-(this.D+this.aa)}},
bottom:{configurable:!0,get:function(){return this.F+this.Z},set:function(a){E&&(B(a,L,"top"),this.ha(a));this.F+=a-(this.F+this.Z)}},position:{configurable:!0,get:function(){return new J(this.D,this.F)},set:function(a){E&&(w(a,J,L,"position"),this.ha(a));this.D=a.x;this.F=a.y}},size:{configurable:!0,get:function(){return new Zb(this.aa,this.Z)},set:function(a){E&&(w(a,Zb,L,"size"),this.ha(a));this.aa=a.width;this.Z=a.height}},center:{configurable:!0,
get:function(){return new J(this.D+this.aa/2,this.F+this.Z/2)},set:function(a){E&&(w(a,J,L,"center"),this.ha(a));this.D=a.x-this.aa/2;this.F=a.y-this.Z/2}},centerX:{configurable:!0,get:function(){return this.D+this.aa/2},set:function(a){E&&(B(a,L,"centerX"),this.ha(a));this.D=a-this.aa/2}},centerY:{configurable:!0,get:function(){return this.F+this.Z/2},set:function(a){E&&(B(a,L,"centerY"),this.ha(a));this.F=a-this.Z/2}}});L.prototype.isEmpty=L.prototype.xz;
L.prototype.isReal=L.prototype.o;L.prototype.setSpot=L.prototype.nk;L.prototype.union=L.prototype.Wv;L.prototype.unionRect=L.prototype.Zc;L.prototype.unionPoint=L.prototype.Le;L.prototype.intersects=L.prototype.jv;L.prototype.intersectsRect=L.prototype.Mc;L.prototype.intersect=L.prototype.iv;L.prototype.intersectRect=L.prototype.vz;L.prototype.grow=L.prototype.qz;L.prototype.subtractMargin=L.prototype.Pv;L.prototype.addMargin=L.prototype.Op;L.prototype.inflate=L.prototype.Yc;L.prototype.offset=L.prototype.offset;
L.prototype.contains=L.prototype.contains;L.prototype.containsRect=L.prototype.pf;L.prototype.containsPoint=L.prototype.fa;L.prototype.equalsApprox=L.prototype.Ra;L.prototype.equalTo=L.prototype.Ci;L.prototype.equals=L.prototype.A;L.prototype.setSize=L.prototype.Wz;L.prototype.setPoint=L.prototype.nd;L.prototype.set=L.prototype.set;L.prototype.setTo=L.prototype.ug;var Tc=null,Uc=null,Sc=[];L.className="Rect";L.parse=Dc;L.stringify=Ec;L.contains=Qc;L.intersects=Rc;L.ZeroRect=Tc=(new L(0,0,0,0)).ia();
L.NoRect=Uc=(new L(NaN,NaN,NaN,NaN)).ia();L.parse=Dc;L.stringify=Ec;L.contains=Qc;L.intersects=Rc;function Jc(a,b,c,d){void 0===a?this.oe=this.de=this.we=this.ze=0:void 0===b?this.left=this.bottom=this.right=this.top=a:void 0===c?(this.top=a,this.right=b,this.bottom=a,this.left=b):void 0!==d?(this.top=a,this.right=b,this.bottom=c,this.left=d):v("Invalid arguments to Margin constructor: "+a+", "+b+", "+c+", "+d);this.u=!1}
Jc.prototype.assign=function(a){this.ze=a.ze;this.we=a.we;this.de=a.de;this.oe=a.oe;return this};Jc.prototype.ug=function(a,b,c,d){E&&(z(a,"number",Jc,"setTo:t"),z(b,"number",Jc,"setTo:r"),z(c,"number",Jc,"setTo:b"),z(d,"number",Jc,"setTo:l"),this.ha());this.ze=a;this.we=b;this.de=c;this.oe=d;return this};Jc.prototype.set=function(a){E&&(w(a,Jc,Jc,"assign:m"),this.ha());this.ze=a.ze;this.we=a.we;this.de=a.de;this.oe=a.oe;return this};
Jc.prototype.copy=function(){var a=new Jc;a.ze=this.ze;a.we=this.we;a.de=this.de;a.oe=this.oe;return a};t=Jc.prototype;t.ia=function(){this.u=!0;Object.freeze(this);return this};t.J=function(){return Object.isFrozen(this)?this:this.copy().freeze()};t.freeze=function(){this.u=!0;return this};t.ja=function(){Object.isFrozen(this)&&v("cannot thaw constant: "+this);this.u=!1;return this};
t.ha=function(a){if(this.u){var b="The Margin is frozen, so its properties cannot be set: "+this.toString();void 0!==a&&(b+="  to value: "+a);v(b)}};
function Vc(a){if("string"===typeof a){a=a.split(" ");for(var b=0,c=NaN;""===a[b];)b++;var d=a[b++];d&&(c=parseFloat(d));if(isNaN(c))return new Jc;for(var e=NaN;""===a[b];)b++;(d=a[b++])&&(e=parseFloat(d));if(isNaN(e))return new Jc(c);for(var f=NaN;""===a[b];)b++;(d=a[b++])&&(f=parseFloat(d));if(isNaN(f))return new Jc(c,e);for(var g=NaN;""===a[b];)b++;(d=a[b++])&&(g=parseFloat(d));return isNaN(g)?new Jc(c,e):new Jc(c,e,f,g)}return new Jc}
function Xc(a){E&&w(a,Jc);return a.top.toString()+" "+a.right.toString()+" "+a.bottom.toString()+" "+a.left.toString()}t.toString=function(){return"Margin("+this.top+","+this.right+","+this.bottom+","+this.left+")"};t.A=function(a){return a instanceof Jc?this.ze===a.top&&this.we===a.right&&this.de===a.bottom&&this.oe===a.left:!1};t.Ci=function(a,b,c,d){return this.ze===a&&this.we===b&&this.de===c&&this.oe===d};
t.Ra=function(a){return K.B(this.ze,a.top)&&K.B(this.we,a.right)&&K.B(this.de,a.bottom)&&K.B(this.oe,a.left)};t.o=function(){return isFinite(this.top)&&isFinite(this.right)&&isFinite(this.bottom)&&isFinite(this.left)};Jc.alloc=function(){var a=Yc.pop();return void 0===a?new Jc:a};Jc.free=function(a){Yc.push(a)};
na.Object.defineProperties(Jc.prototype,{top:{configurable:!0,get:function(){return this.ze},set:function(a){E&&(B(a,Jc,"top"),this.ha(a));this.ze=a}},right:{configurable:!0,get:function(){return this.we},set:function(a){E&&(B(a,Jc,"right"),this.ha(a));this.we=a}},bottom:{configurable:!0,get:function(){return this.de},set:function(a){E&&(B(a,Jc,"bottom"),this.ha(a));this.de=a}},left:{configurable:!0,get:function(){return this.oe},set:function(a){E&&
(B(a,Jc,"left"),this.ha(a));this.oe=a}}});Jc.prototype.isReal=Jc.prototype.o;Jc.prototype.equalsApprox=Jc.prototype.Ra;Jc.prototype.equalTo=Jc.prototype.Ci;Jc.prototype.equals=Jc.prototype.A;Jc.prototype.set=Jc.prototype.set;Jc.prototype.setTo=Jc.prototype.ug;var Zc=null,cd=null,Yc=[];Jc.className="Margin";Jc.parse=Vc;Jc.stringify=Xc;Jc.ZeroMargin=Zc=(new Jc(0,0,0,0)).ia();Jc.TwoMargin=cd=(new Jc(2,2,2,2)).ia();Jc.parse=Vc;Jc.stringify=Xc;
function $b(){this.m11=1;this.m21=this.m12=0;this.m22=1;this.dy=this.dx=0}$b.prototype.set=function(a){this.m11=a.m11;this.m12=a.m12;this.m21=a.m21;this.m22=a.m22;this.dx=a.dx;this.dy=a.dy;return this};$b.prototype.copy=function(){var a=new $b;a.m11=this.m11;a.m12=this.m12;a.m21=this.m21;a.m22=this.m22;a.dx=this.dx;a.dy=this.dy;return a};t=$b.prototype;t.toString=function(){return"Transform("+this.m11+","+this.m12+","+this.m21+","+this.m22+","+this.dx+","+this.dy+")"};
t.A=function(a){return a instanceof $b?this.m11===a.m11&&this.m12===a.m12&&this.m21===a.m21&&this.m22===a.m22&&this.dx===a.dx&&this.dy===a.dy:!1};t.gt=function(){return 0===this.dx&&0===this.dy&&1===this.m11&&0===this.m12&&0===this.m21&&1===this.m22};t.reset=function(){this.m11=1;this.m21=this.m12=0;this.m22=1;this.dy=this.dx=0;return this};
t.multiply=function(a){var b=this.m12*a.m11+this.m22*a.m12,c=this.m11*a.m21+this.m21*a.m22,d=this.m12*a.m21+this.m22*a.m22,e=this.m11*a.dx+this.m21*a.dy+this.dx,f=this.m12*a.dx+this.m22*a.dy+this.dy;this.m11=this.m11*a.m11+this.m21*a.m12;this.m12=b;this.m21=c;this.m22=d;this.dx=e;this.dy=f;return this};
t.ov=function(a){var b=1/(a.m11*a.m22-a.m12*a.m21),c=a.m22*b,d=-a.m12*b,e=-a.m21*b,f=a.m11*b,g=b*(a.m21*a.dy-a.m22*a.dx);a=b*(a.m12*a.dx-a.m11*a.dy);b=this.m11*c+this.m21*d;c=this.m12*c+this.m22*d;d=this.m11*e+this.m21*f;e=this.m12*e+this.m22*f;this.dx=this.m11*g+this.m21*a+this.dx;this.dy=this.m12*g+this.m22*a+this.dy;this.m11=b;this.m12=c;this.m21=d;this.m22=e;return this};
t.et=function(){var a=1/(this.m11*this.m22-this.m12*this.m21),b=-this.m12*a,c=-this.m21*a,d=this.m11*a,e=a*(this.m21*this.dy-this.m22*this.dx),f=a*(this.m12*this.dx-this.m11*this.dy);this.m11=this.m22*a;this.m12=b;this.m21=c;this.m22=d;this.dx=e;this.dy=f;return this};
$b.prototype.rotate=function(a,b,c){E&&(B(a,$b,"rotate:angle"),B(b,$b,"rotate:rx"),B(c,$b,"rotate:ry"));360<=a?a-=360:0>a&&(a+=360);if(0===a)return this;this.translate(b,c);if(90===a){a=0;var d=1}else 180===a?(a=-1,d=0):270===a?(a=0,d=-1):(d=a*Math.PI/180,a=Math.cos(d),d=Math.sin(d));var e=this.m12*a+this.m22*d,f=this.m11*-d+this.m21*a,g=this.m12*-d+this.m22*a;this.m11=this.m11*a+this.m21*d;this.m12=e;this.m21=f;this.m22=g;this.translate(-b,-c);return this};t=$b.prototype;
t.translate=function(a,b){E&&(B(a,$b,"translate:x"),B(b,$b,"translate:y"));this.dx+=this.m11*a+this.m21*b;this.dy+=this.m12*a+this.m22*b;return this};t.scale=function(a,b){void 0===b&&(b=a);E&&(B(a,$b,"translate:sx"),B(b,$b,"translate:sy"));this.m11*=a;this.m12*=a;this.m21*=b;this.m22*=b;return this};t.va=function(a){var b=a.D,c=a.F;a.D=b*this.m11+c*this.m21+this.dx;a.F=b*this.m12+c*this.m22+this.dy;return a};
t.Xd=function(a){var b=1/(this.m11*this.m22-this.m12*this.m21),c=-this.m12*b,d=this.m11*b,e=b*(this.m12*this.dx-this.m11*this.dy),f=a.D,g=a.F;a.D=f*this.m22*b+g*-this.m21*b+b*(this.m21*this.dy-this.m22*this.dx);a.F=f*c+g*d+e;return a};
t.Vv=function(a){var b=a.D,c=a.F,d=b+a.aa,e=c+a.Z,f=this.m11,g=this.m12,h=this.m21,k=this.m22,l=this.dx,m=this.dy,n=b*f+c*h+l,p=b*g+c*k+m,q=d*f+c*h+l,r=d*g+c*k+m;c=b*f+e*h+l;b=b*g+e*k+m;f=d*f+e*h+l;d=d*g+e*k+m;e=Math.min(n,q);n=Math.max(n,q);q=Math.min(p,r);p=Math.max(p,r);e=Math.min(e,c);n=Math.max(n,c);q=Math.min(q,b);p=Math.max(p,b);e=Math.min(e,f);n=Math.max(n,f);q=Math.min(q,d);p=Math.max(p,d);a.D=e;a.F=q;a.aa=n-e;a.Z=p-q;return a};
$b.alloc=function(){var a=dd.pop();return void 0===a?new $b:a};$b.free=function(a){dd.push(a)};$b.prototype.transformRect=$b.prototype.Vv;$b.prototype.invertedTransformPoint=$b.prototype.Xd;$b.prototype.transformPoint=$b.prototype.va;$b.prototype.scale=$b.prototype.scale;$b.prototype.translate=$b.prototype.translate;$b.prototype.rotate=$b.prototype.rotate;$b.prototype.invert=$b.prototype.et;$b.prototype.multiplyInverted=$b.prototype.ov;$b.prototype.multiply=$b.prototype.multiply;
$b.prototype.reset=$b.prototype.reset;$b.prototype.isIdentity=$b.prototype.gt;$b.prototype.equals=$b.prototype.A;$b.prototype.set=$b.prototype.set;var dd=[];$b.className="Transform";$b.xF="54a702f3e53909c447824c6706603faf4c";function M(a,b,c,d){void 0===a?this.Qd=this.Pd=this.F=this.D=0:(void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=0),this.x=a,this.y=b,this.offsetX=c,this.offsetY=d);this.u=!1}
var ed,fd,gd,hd,pd,qd,rd,sd,td,ud,vd,wd,Ad,Bd,Cd,Dd,Ed,Fd,Gd,Hd,Id,Md,Nd,Od,Pd,Qd,Rd,Sd,Td,Ud,Vd,Wd,Xd,de,ee,fe;M.prototype.assign=function(a){this.D=a.D;this.F=a.F;this.Pd=a.Pd;this.Qd=a.Qd;return this};M.prototype.ug=function(a,b,c,d){E&&(ge(a,"setTo:x"),ge(b,"setTo:y"),he(c,"setTo:offx"),he(d,"setTo:offy"),this.ha());this.D=a;this.F=b;this.Pd=c;this.Qd=d;return this};M.prototype.set=function(a){E&&(w(a,M,M,"set:s"),this.ha());this.D=a.D;this.F=a.F;this.Pd=a.Pd;this.Qd=a.Qd;return this};
M.prototype.copy=function(){var a=new M;a.D=this.D;a.F=this.F;a.Pd=this.Pd;a.Qd=this.Qd;return a};t=M.prototype;t.ia=function(){this.u=!0;Object.freeze(this);return this};t.J=function(){return Object.isFrozen(this)?this:this.copy().freeze()};t.freeze=function(){this.u=!0;return this};t.ja=function(){Object.isFrozen(this)&&v("cannot thaw constant: "+this);this.u=!1;return this};
t.ha=function(a){if(this.u){var b="The Spot is frozen, so its properties cannot be set: "+this.toString();void 0!==a&&(b+="  to value: "+a);v(b)}};function ie(a,b){a.D=NaN;a.F=NaN;a.Pd=b;return a}function ge(a,b){(isNaN(a)||1<a||0>a)&&Ca(a,"0 <= "+b+" <= 1",M,b)}function he(a,b){(isNaN(a)||Infinity===a||-Infinity===a)&&Ca(a,"real number, not NaN or Infinity",M,b)}
function je(a){if("string"===typeof a){a=a.trim();if("None"===a)return ed;if("TopLeft"===a)return fd;if("Top"===a||"TopCenter"===a||"MiddleTop"===a)return gd;if("TopRight"===a)return hd;if("Left"===a||"LeftCenter"===a||"MiddleLeft"===a)return pd;if("Center"===a)return qd;if("Right"===a||"RightCenter"===a||"MiddleRight"===a)return rd;if("BottomLeft"===a)return sd;if("Bottom"===a||"BottomCenter"===a||"MiddleBottom"===a)return td;if("BottomRight"===a)return ud;if("TopSide"===a)return vd;if("LeftSide"===
a)return wd;if("RightSide"===a)return Ad;if("BottomSide"===a)return Bd;if("TopBottomSides"===a)return Cd;if("LeftRightSides"===a)return Dd;if("TopLeftSides"===a)return Ed;if("TopRightSides"===a)return Fd;if("BottomLeftSides"===a)return Gd;if("BottomRightSides"===a)return Hd;if("NotTopSide"===a)return Id;if("NotLeftSide"===a)return Md;if("NotRightSide"===a)return Nd;if("NotBottomSide"===a)return Od;if("AllSides"===a)return Pd;if("Default"===a)return Qd;a=a.split(" ");for(var b=0,c=0;""===a[b];)b++;
var d=a[b++];void 0!==d&&0<d.length&&(c=parseFloat(d));for(var e=0;""===a[b];)b++;d=a[b++];void 0!==d&&0<d.length&&(e=parseFloat(d));for(var f=0;""===a[b];)b++;d=a[b++];void 0!==d&&0<d.length&&(f=parseFloat(d));for(var g=0;""===a[b];)b++;d=a[b++];void 0!==d&&0<d.length&&(g=parseFloat(d));return new M(c,e,f,g)}return new M}function ke(a){E&&w(a,M);return a.Za()?a.x.toString()+" "+a.y.toString()+" "+a.offsetX.toString()+" "+a.offsetY.toString():a.toString()}
t.toString=function(){return this.Za()?0===this.Pd&&0===this.Qd?"Spot("+this.x+","+this.y+")":"Spot("+this.x+","+this.y+","+this.offsetX+","+this.offsetY+")":this.A(ed)?"None":this.A(fd)?"TopLeft":this.A(gd)?"Top":this.A(hd)?"TopRight":this.A(pd)?"Left":this.A(qd)?"Center":this.A(rd)?"Right":this.A(sd)?"BottomLeft":this.A(td)?"Bottom":this.A(ud)?"BottomRight":this.A(vd)?"TopSide":this.A(wd)?"LeftSide":this.A(Ad)?"RightSide":this.A(Bd)?"BottomSide":this.A(Cd)?"TopBottomSides":this.A(Dd)?"LeftRightSides":
this.A(Ed)?"TopLeftSides":this.A(Fd)?"TopRightSides":this.A(Gd)?"BottomLeftSides":this.A(Hd)?"BottomRightSides":this.A(Id)?"NotTopSide":this.A(Md)?"NotLeftSide":this.A(Nd)?"NotRightSide":this.A(Od)?"NotBottomSide":this.A(Pd)?"AllSides":this.A(Qd)?"Default":"None"};t.A=function(a){return a instanceof M?(this.D===a.x||isNaN(this.D)&&isNaN(a.x))&&(this.F===a.y||isNaN(this.F)&&isNaN(a.y))&&this.Pd===a.offsetX&&this.Qd===a.offsetY:!1};
t.sv=function(){return new M(.5-(this.D-.5),.5-(this.F-.5),-this.Pd,-this.Qd)};t.rf=function(a){if(!this.sf())return!1;if(!a.sf())if(a.A(Rd))a=wd;else if(a.A(Sd))a=Ad;else if(a.A(Td))a=vd;else if(a.A(Ud))a=Bd;else return!1;a=a.offsetY;return(this.Qd&a)===a};t.Za=function(){return!isNaN(this.x)&&!isNaN(this.y)};t.Ob=function(){return isNaN(this.x)||isNaN(this.y)};t.sf=function(){return isNaN(this.x)&&isNaN(this.y)&&1===this.offsetX&&0!==this.offsetY};
t.gq=function(){return isNaN(this.x)&&isNaN(this.y)&&0===this.offsetX&&0===this.offsetY};t.Db=function(){return isNaN(this.x)&&isNaN(this.y)&&-1===this.offsetX&&0===this.offsetY};M.alloc=function(){var a=le.pop();return void 0===a?new M:a};M.free=function(a){le.push(a)};
na.Object.defineProperties(M.prototype,{x:{configurable:!0,get:function(){return this.D},set:function(a){E&&(ge(a,"x"),this.ha(a));this.D=a}},y:{configurable:!0,get:function(){return this.F},set:function(a){E&&(ge(a,"y"),this.ha(a));this.F=a}},offsetX:{configurable:!0,get:function(){return this.Pd},set:function(a){E&&(he(a,"offsetX"),this.ha(a));this.Pd=a}},offsetY:{configurable:!0,get:function(){return this.Qd},set:function(a){E&&(he(a,"offsetY"),
this.ha(a));this.Qd=a}}});M.prototype.isDefault=M.prototype.Db;M.prototype.isNone=M.prototype.gq;M.prototype.isSide=M.prototype.sf;M.prototype.isNoSpot=M.prototype.Ob;M.prototype.isSpot=M.prototype.Za;M.prototype.includesSide=M.prototype.rf;M.prototype.opposite=M.prototype.sv;M.prototype.equals=M.prototype.A;M.prototype.set=M.prototype.set;M.prototype.setTo=M.prototype.ug;var le=[];M.className="Spot";M.parse=je;M.stringify=ke;M.None=ed=ie(new M(0,0,0,0),0).ia();M.Default=Qd=ie(new M(0,0,-1,0),-1).ia();
M.TopLeft=fd=(new M(0,0,0,0)).ia();M.TopCenter=gd=(new M(.5,0,0,0)).ia();M.TopRight=hd=(new M(1,0,0,0)).ia();M.LeftCenter=pd=(new M(0,.5,0,0)).ia();M.Center=qd=(new M(.5,.5,0,0)).ia();M.RightCenter=rd=(new M(1,.5,0,0)).ia();M.BottomLeft=sd=(new M(0,1,0,0)).ia();M.BottomCenter=td=(new M(.5,1,0,0)).ia();M.BottomRight=ud=(new M(1,1,0,0)).ia();M.MiddleTop=Vd=gd;M.MiddleLeft=Wd=pd;M.MiddleRight=Xd=rd;M.MiddleBottom=de=td;M.Top=Td=gd;M.Left=Rd=pd;M.Right=Sd=rd;M.Bottom=Ud=td;
M.TopSide=vd=ie(new M(0,0,1,1),1).ia();M.LeftSide=wd=ie(new M(0,0,1,2),1).ia();M.RightSide=Ad=ie(new M(0,0,1,4),1).ia();M.BottomSide=Bd=ie(new M(0,0,1,8),1).ia();M.TopBottomSides=Cd=ie(new M(0,0,1,9),1).ia();M.LeftRightSides=Dd=ie(new M(0,0,1,6),1).ia();M.TopLeftSides=Ed=ie(new M(0,0,1,3),1).ia();M.TopRightSides=Fd=ie(new M(0,0,1,5),1).ia();M.BottomLeftSides=Gd=ie(new M(0,0,1,10),1).ia();M.BottomRightSides=Hd=ie(new M(0,0,1,12),1).ia();M.NotTopSide=Id=ie(new M(0,0,1,14),1).ia();
M.NotLeftSide=Md=ie(new M(0,0,1,13),1).ia();M.NotRightSide=Nd=ie(new M(0,0,1,11),1).ia();M.NotBottomSide=Od=ie(new M(0,0,1,7),1).ia();M.AllSides=Pd=ie(new M(0,0,1,15),1).ia();ee=(new M(.156,.156)).ia();fe=(new M(.844,.844)).ia();M.parse=je;M.stringify=ke;
var K={dA:"7da71ca0ad381e90",yg:(Math.sqrt(2)-1)/3*4,gw:null,sqrt:function(a){if(0>=a)return 0;var b=K.gw;if(null===b){b=[];for(var c=0;2E3>=c;c++)b[c]=Math.sqrt(c);K.gw=b}return 1>a?(c=1/a,2E3>=c?1/b[c|0]:Math.sqrt(a)):2E3>=a?b[a|0]:Math.sqrt(a)},B:function(a,b){a-=b;return.5>a&&-.5<a},ca:function(a,b){a-=b;return 5E-8>a&&-5E-8<a},Vb:function(a,b,c,d,e,f,g){0>=e&&(e=1E-6);if(a<c){var h=a;var k=c}else h=c,k=a;if(b<d){var l=b;var m=d}else l=d,m=b;if(a===c)return l<=g&&g<=m&&a-e<=f&&f<=a+e;if(b===d)return h<=
f&&f<=k&&b-e<=g&&g<=b+e;k+=e;h-=e;if(h<=f&&f<=k&&(m+=e,l-=e,l<=g&&g<=m))if(k-h>m-l)if(a-c>e||c-a>e){if(f=(d-b)/(c-a)*(f-a)+b,f-e<=g&&g<=f+e)return!0}else return!0;else if(b-d>e||d-b>e){if(g=(c-a)/(d-b)*(g-b)+a,g-e<=f&&f<=g+e)return!0}else return!0;return!1},Ls:function(a,b,c,d,e,f,g,h,k,l,m,n){if(K.Vb(a,b,g,h,n,c,d)&&K.Vb(a,b,g,h,n,e,f))return K.Vb(a,b,g,h,n,l,m);var p=(a+c)/2,q=(b+d)/2,r=(c+e)/2,u=(d+f)/2;e=(e+g)/2;f=(f+h)/2;d=(p+r)/2;c=(q+u)/2;r=(r+e)/2;u=(u+f)/2;var y=(d+r)/2,x=(c+u)/2;return K.Ls(a,
b,p,q,d,c,y,x,k,l,m,n)||K.Ls(y,x,r,u,e,f,g,h,k,l,m,n)},ty:function(a,b,c,d,e,f,g,h,k){var l=(c+e)/2,m=(d+f)/2;k.h((((a+c)/2+l)/2+(l+(e+g)/2)/2)/2,(((b+d)/2+m)/2+(m+(f+h)/2)/2)/2);return k},sy:function(a,b,c,d,e,f,g,h){var k=(c+e)/2,l=(d+f)/2;return ec(((a+c)/2+k)/2,((b+d)/2+l)/2,(k+(e+g)/2)/2,(l+(f+h)/2)/2)},Ul:function(a,b,c,d,e,f,g,h,k,l){if(K.Vb(a,b,g,h,k,c,d)&&K.Vb(a,b,g,h,k,e,f))Pc(l,a,b,0,0),Pc(l,g,h,0,0);else{var m=(a+c)/2,n=(b+d)/2,p=(c+e)/2,q=(d+f)/2;e=(e+g)/2;f=(f+h)/2;d=(m+p)/2;c=(n+q)/
2;p=(p+e)/2;q=(q+f)/2;var r=(d+p)/2,u=(c+q)/2;K.Ul(a,b,m,n,d,c,r,u,k,l);K.Ul(r,u,p,q,e,f,g,h,k,l)}return l},Ce:function(a,b,c,d,e,f,g,h,k,l){if(K.Vb(a,b,g,h,k,c,d)&&K.Vb(a,b,g,h,k,e,f))0===l.length&&(l.push(a),l.push(b)),l.push(g),l.push(h);else{var m=(a+c)/2,n=(b+d)/2,p=(c+e)/2,q=(d+f)/2;e=(e+g)/2;f=(f+h)/2;d=(m+p)/2;c=(n+q)/2;p=(p+e)/2;q=(q+f)/2;var r=(d+p)/2,u=(c+q)/2;K.Ce(a,b,m,n,d,c,r,u,k,l);K.Ce(r,u,p,q,e,f,g,h,k,l)}return l},gA:function(a,b,c,d,e,f,g,h,k,l,m,n,p,q){var r=1-k;a=a*r+c*k;b=b*
r+d*k;c=c*r+e*k;d=d*r+f*k;e=e*r+g*k;f=f*r+h*k;h=a*r+c*k;g=b*r+d*k;c=c*r+e*k;d=d*r+f*k;var u=h*r+c*k;k=g*r+d*k;l.h(a,b);m.h(h,g);n.h(u,k);p.h(c,d);q.h(e,f)},vv:function(a,b,c,d,e,f,g,h,k,l){if(K.Vb(a,b,e,f,l,c,d))return K.Vb(a,b,e,f,l,h,k);var m=(a+c)/2,n=(b+d)/2;c=(c+e)/2;d=(d+f)/2;var p=(m+c)/2,q=(n+d)/2;return K.vv(a,b,m,n,p,q,g,h,k,l)||K.vv(p,q,c,d,e,f,g,h,k,l)},qA:function(a,b,c,d,e,f,g){g.h(((a+c)/2+(c+e)/2)/2,((b+d)/2+(d+f)/2)/2);return g},uv:function(a,b,c,d,e,f,g,h){if(K.Vb(a,b,e,f,g,c,d))Pc(h,
a,b,0,0),Pc(h,e,f,0,0);else{var k=(a+c)/2,l=(b+d)/2;c=(c+e)/2;d=(d+f)/2;var m=(k+c)/2,n=(l+d)/2;K.uv(a,b,k,l,m,n,g,h);K.uv(m,n,c,d,e,f,g,h)}return h},pq:function(a,b,c,d,e,f,g,h){if(K.Vb(a,b,e,f,g,c,d))0===h.length&&(h.push(a),h.push(b)),h.push(e),h.push(f);else{var k=(a+c)/2,l=(b+d)/2;c=(c+e)/2;d=(d+f)/2;var m=(k+c)/2,n=(l+d)/2;K.pq(a,b,k,l,m,n,g,h);K.pq(m,n,c,d,e,f,g,h)}return h},Pp:function(a,b,c,d,e,f,g,h,k,l,m,n,p,q){if(K.Vb(a,b,g,h,p,c,d)&&K.Vb(a,b,g,h,p,e,f)){var r=(a-g)*(l-n)-(b-h)*(k-m);
if(0===r)return!1;p=((a*h-b*g)*(k-m)-(a-g)*(k*n-l*m))/r;r=((a*h-b*g)*(l-n)-(b-h)*(k*n-l*m))/r;if((k>m?k-m:m-k)<(l>n?l-n:n-l)){if(b<h?g=b:(g=h,h=b),r<g||r>h)return!1}else if(a<g?h=a:(h=g,g=a),p<h||p>g)return!1;q.h(p,r);return!0}r=(a+c)/2;var u=(b+d)/2;c=(c+e)/2;d=(d+f)/2;e=(e+g)/2;f=(f+h)/2;var y=(r+c)/2,x=(u+d)/2;c=(c+e)/2;d=(d+f)/2;var A=(y+c)/2,C=(x+d)/2,F=(m-k)*(m-k)+(n-l)*(n-l),I=!1;K.Pp(a,b,r,u,y,x,A,C,k,l,m,n,p,q)&&(a=(q.x-k)*(q.x-k)+(q.y-l)*(q.y-l),a<F&&(F=a,I=!0));a=q.x;b=q.y;K.Pp(A,C,c,d,
e,f,g,h,k,l,m,n,p,q)&&((q.x-k)*(q.x-k)+(q.y-l)*(q.y-l)<F?I=!0:q.h(a,b));return I},Qp:function(a,b,c,d,e,f,g,h,k,l,m,n,p){var q=0;if(K.Vb(a,b,g,h,p,c,d)&&K.Vb(a,b,g,h,p,e,f)){p=(a-g)*(l-n)-(b-h)*(k-m);if(0===p)return q;var r=((a*h-b*g)*(k-m)-(a-g)*(k*n-l*m))/p,u=((a*h-b*g)*(l-n)-(b-h)*(k*n-l*m))/p;if(r>=m)return q;if((k>m?k-m:m-k)<(l>n?l-n:n-l)){if(b<h?(a=b,b=h):a=h,u<a||u>b)return q}else if(a<g?(b=a,a=g):b=g,r<b||r>a)return q;0<p?q++:0>p&&q--}else{r=(a+c)/2;u=(b+d)/2;var y=(c+e)/2,x=(d+f)/2;e=(e+
g)/2;f=(f+h)/2;d=(r+y)/2;c=(u+x)/2;y=(y+e)/2;x=(x+f)/2;var A=(d+y)/2,C=(c+x)/2;q+=K.Qp(a,b,r,u,d,c,A,C,k,l,m,n,p);q+=K.Qp(A,C,y,x,e,f,g,h,k,l,m,n,p)}return q},Pi:function(a,b,c,d,e,f,g){if(K.ca(a,c)){b<d?(c=b,b=d):c=d;if(f<c)return g.h(a,c),!1;if(f>b)return g.h(a,b),!1;g.h(a,f);return!0}if(K.ca(b,d)){a<c?(d=a,a=c):d=c;if(e<d)return g.h(d,b),!1;if(e>a)return g.h(a,b),!1;g.h(e,b);return!0}e=((a-e)*(a-c)+(b-f)*(b-d))/((c-a)*(c-a)+(d-b)*(d-b));if(-5E-6>e)return g.h(a,b),!1;if(1.000005<e)return g.h(c,
d),!1;g.h(a+e*(c-a),b+e*(d-b));return!0},Ie:function(a,b,c,d,e,f,g,h,k){if(K.B(a,c)&&K.B(b,d))return k.h(a,b),!1;if(K.ca(e,g))return K.ca(a,c)?(K.Pi(a,b,c,d,e,f,k),!1):K.Pi(a,b,c,d,e,(d-b)/(c-a)*(e-a)+b,k);h=(h-f)/(g-e);if(K.ca(a,c)){c=h*(a-e)+f;b<d?(e=b,b=d):e=d;if(c<e)return k.h(a,e),!1;if(c>b)return k.h(a,b),!1;k.h(a,c);return!0}g=(d-b)/(c-a);if(K.ca(h,g))return K.Pi(a,b,c,d,e,f,k),!1;e=(g*a-h*e+f-b)/(g-h);if(K.ca(g,0)){a<c?(d=a,a=c):d=c;if(e<d)return k.h(d,b),!1;if(e>a)return k.h(a,b),!1;k.h(e,
b);return!0}return K.Pi(a,b,c,d,e,g*(e-a)+b,k)},mA:function(a,b,c,d,e){return K.Ie(c.x,c.y,d.x,d.y,a.x,a.y,b.x,b.y,e)},lA:function(a,b,c,d,e,f,g,h,k,l){function m(c,d){var e=(c-a)*(c-a)+(d-b)*(d-b);e<n&&(n=e,k.h(c,d))}var n=Infinity;m(k.x,k.y);var p=0,q=0,r=0,u=0;e<g?(p=e,q=g):(p=g,q=e);f<h?(r=e,u=g):(r=g,u=e);p=(q-p)/2+l;l=(u-r)/2+l;e=(e+g)/2;f=(f+h)/2;if(0===p||0===l)return k;if(.5>(c>a?c-a:a-c)){p=1-(c-e)*(c-e)/(p*p);if(0>p)return k;p=Math.sqrt(p);d=-l*p+f;m(c,l*p+f);m(c,d)}else{c=(d-b)/(c-a);
d=1/(p*p)+c*c/(l*l);h=2*c*(b-c*a)/(l*l)-2*c*f/(l*l)-2*e/(p*p);p=h*h-4*d*(2*c*a*f/(l*l)-2*b*f/(l*l)+f*f/(l*l)+e*e/(p*p)-1+(b-c*a)*(b-c*a)/(l*l));if(0>p)return k;p=Math.sqrt(p);l=(-h+p)/(2*d);m(l,c*l-c*a+b);p=(-h-p)/(2*d);m(p,c*p-c*a+b)}return k},Xc:function(a,b,c,d,e,f,g,h,k){var l=1E21,m=a,n=b;if(K.Ie(a,b,a,d,e,f,g,h,k)){var p=(k.x-e)*(k.x-e)+(k.y-f)*(k.y-f);p<l&&(l=p,m=k.x,n=k.y)}K.Ie(c,b,c,d,e,f,g,h,k)&&(p=(k.x-e)*(k.x-e)+(k.y-f)*(k.y-f),p<l&&(l=p,m=k.x,n=k.y));K.Ie(a,b,c,b,e,f,g,h,k)&&(b=(k.x-
e)*(k.x-e)+(k.y-f)*(k.y-f),b<l&&(l=b,m=k.x,n=k.y));K.Ie(a,d,c,d,e,f,g,h,k)&&(a=(k.x-e)*(k.x-e)+(k.y-f)*(k.y-f),a<l&&(l=a,m=k.x,n=k.y));k.h(m,n);return 1E21>l},kA:function(a,b,c,d,e,f,g,h,k){c=a-c;g=e-g;0===c||0===g?0===c?(b=(f-h)/g,h=a,e=b*h+(f-b*e)):(f=(b-d)/c,h=e,e=f*h+(b-f*a)):(d=(b-d)/c,h=(f-h)/g,a=b-d*a,h=(f-h*e-a)/(d-h),e=d*h+a);k.h(h,e);return k},ct:function(a,b,c){var d=b.x,e=b.y,f=c.x,g=c.y,h=a.left,k=a.right,l=a.top,m=a.bottom;return d===f?(e<g?(f=e,e=g):f=g,h<=d&&d<=k&&f<=m&&e>=l):e===
g?(d<f?(g=d,d=f):g=f,l<=e&&e<=m&&g<=k&&d>=h):a.fa(b)||a.fa(c)||K.bt(h,l,k,l,d,e,f,g)||K.bt(k,l,k,m,d,e,f,g)||K.bt(k,m,h,m,d,e,f,g)||K.bt(h,m,h,l,d,e,f,g)?!0:!1},bt:function(a,b,c,d,e,f,g,h){return 0>=K.Os(a,b,c,d,e,f)*K.Os(a,b,c,d,g,h)&&0>=K.Os(e,f,g,h,a,b)*K.Os(e,f,g,h,c,d)},Os:function(a,b,c,d,e,f){c-=a;d-=b;a=e-a;b=f-b;f=a*d-b*c;0===f&&(f=a*c+b*d,0<f&&(f=(a-c)*c+(b-d)*d,0>f&&(f=0)));return 0>f?-1:0<f?1:0},mq:function(a){0>a&&(a+=360);360<=a&&(a-=360);return a},gx:function(a,b,c,d,e,f){var g=Math.PI;
f||(d*=g/180,e*=g/180);var h=d>e?-1:1;f=[];var k=g/2,l=d;d=Math.min(2*g,Math.abs(e-d));if(1E-5>d)return k=l+h*Math.min(d,k),h=a+c*Math.cos(l),l=b+c*Math.sin(l),a+=c*Math.cos(k),b+=c*Math.sin(k),c=(h+a)/2,k=(l+b)/2,f.push([h,l,c,k,c,k,a,b]),f;for(;1E-5<d;)e=l+h*Math.min(d,k),f.push(K.Ay(c,l,e,a,b)),d-=Math.abs(e-l),l=e;return f},Ay:function(a,b,c,d,e){var f=(c-b)/2,g=a*Math.cos(f),h=a*Math.sin(f),k=-h,l=g*g+k*k,m=l+g*g+k*h;l=4/3*(Math.sqrt(2*l*m)-m)/(g*h-k*g);h=g-l*k;g=k+l*g;k=-g;l=f+b;f=Math.cos(l);
l=Math.sin(l);return[d+a*Math.cos(b),e+a*Math.sin(b),d+h*f-g*l,e+h*l+g*f,d+h*f-k*l,e+h*l+k*f,d+a*Math.cos(c),e+a*Math.sin(c)]},Yp:function(a,b,c,d,e,f,g){c=Math.floor((a-c)/e)*e+c;d=Math.floor((b-d)/f)*f+d;var h=c;c+e-a<e/2&&(h=c+e);a=d;d+f-b<f/2&&(a=d+f);g.h(h,a);return g},ox:function(a,b){var c=Math.max(a,b);a=Math.min(a,b);var d;do b=c%a,c=d=a,a=b;while(0<b);return d},Fy:function(a,b,c,d){var e=0>c,f=0>d;if(a<b){var g=1;var h=0}else g=0,h=1;var k=0===g?a:b;var l=0===g?c:d;if(0===g?e:f)l=-l;g=h;
c=0===g?c:d;if(0===g?e:f)c=-c;return K.Gy(k,0===g?a:b,l,c,0,0)},Gy:function(a,b,c,d,e,f){if(0<d)if(0<c){e=a*a;f=b*b;a*=c;var g=b*d,h=-f+g,k=-f+Math.sqrt(a*a+g*g);b=h;for(var l=0;9999999999>l;++l){b=.5*(h+k);if(b===h||b===k)break;var m=a/(b+e),n=g/(b+f);m=m*m+n*n-1;if(0<m)h=b;else if(0>m)k=b;else break}c=e*c/(b+e)-c;d=f*d/(b+f)-d;c=Math.sqrt(c*c+d*d)}else c=Math.abs(d-b);else d=a*a-b*b,f=a*c,f<d?(d=f/d,f=b*Math.sqrt(Math.abs(1-d*d)),c=a*d-c,c=Math.sqrt(c*c+f*f)):c=Math.abs(c-a);return c},ce:new xb,
Dm:new xb};K.za=K.dA;function me(a){E&&1<arguments.length&&v("Geometry constructor can take at most one optional argument, the Geometry type.");rb(this);this.u=!1;void 0===a?a=ne:E&&tb(a,me,me,"constructor:type");this.wa=a;this.Fc=this.qc=this.fd=this.ed=0;this.fj=new G;this.nr=this.fj.s;this.Xq=(new L).freeze();this.ta=!0;this.Qm=this.wk=null;this.Rm=NaN;this.ef=fd;this.ff=ud;this.$k=this.bl=NaN;this.Ef=oe}
me.prototype.copy=function(){var a=new me;a.wa=this.wa;a.ed=this.ed;a.fd=this.fd;a.qc=this.qc;a.Fc=this.Fc;for(var b=this.fj.j,c=b.length,d=a.fj,e=0;e<c;e++){var f=b[e].copy();d.add(f)}a.nr=this.nr;a.Xq.assign(this.Xq);a.ta=this.ta;a.wk=this.wk;a.Qm=this.Qm;a.Rm=this.Rm;a.ef=this.ef.J();a.ff=this.ff.J();a.bl=this.bl;a.$k=this.$k;a.Ef=this.Ef;return a};t=me.prototype;t.ia=function(){this.freeze();Object.freeze(this);return this};
t.freeze=function(){this.u=!0;var a=this.figures;a.freeze();a=a.j;for(var b=a.length,c=0;c<b;c++)a[c].freeze();return this};t.ja=function(){Object.isFrozen(this)&&v("cannot thaw constant: "+this);this.u=!1;var a=this.figures;a.ja();a=a.j;for(var b=a.length,c=0;c<b;c++)a[c].ja();return this};
t.Ra=function(a){if(!(a instanceof me))return!1;if(this.type!==a.type)return this.type===te&&a.type===ne?ue(this,a):a.type===te&&this.type===ne?ue(a,this):!1;if(this.type===ne){var b=this.figures.j;a=a.figures.j;var c=b.length;if(c!==a.length)return!1;for(var d=0;d<c;d++)if(!b[d].Ra(a[d]))return!1;return!0}return K.B(this.startX,a.startX)&&K.B(this.startY,a.startY)&&K.B(this.endX,a.endX)&&K.B(this.endY,a.endY)};
function ue(a,b){return a.type!==te||b.type!==ne?!1:1===b.figures.count&&(b=b.figures.O(0),1===b.segments.count&&K.B(a.startX,b.startX)&&K.B(a.startY,b.startY)&&(b=b.segments.O(0),b.type===ve&&K.B(a.endX,b.endX)&&K.B(a.endY,b.endY)))?!0:!1}function we(a){return a.toString()}t.ib=function(a){a.classType===me?this.type=a:Fa(this,a)};
t.toString=function(a){void 0===a&&(a=-1);switch(this.type){case te:return 0>a?"M"+this.startX.toString()+" "+this.startY.toString()+"L"+this.endX.toString()+" "+this.endY.toString():"M"+this.startX.toFixed(a)+" "+this.startY.toFixed(a)+"L"+this.endX.toFixed(a)+" "+this.endY.toFixed(a);case xe:var b=new L(this.startX,this.startY,0,0);b.Wv(this.endX,this.endY,0,0);return 0>a?"M"+b.x.toString()+" "+b.y.toString()+"H"+b.right.toString()+"V"+b.bottom.toString()+"H"+b.left.toString()+"z":"M"+b.x.toFixed(a)+
" "+b.y.toFixed(a)+"H"+b.right.toFixed(a)+"V"+b.bottom.toFixed(a)+"H"+b.left.toFixed(a)+"z";case ye:b=new L(this.startX,this.startY,0,0);b.Wv(this.endX,this.endY,0,0);if(0>a)return a=b.left.toString()+" "+(b.y+b.height/2).toString(),"M"+a+"A"+(b.width/2).toString()+" "+(b.height/2).toString()+" 0 0 1 "+(b.right.toString()+" "+(b.y+b.height/2).toString())+"A"+(b.width/2).toString()+" "+(b.height/2).toString()+" 0 0 1 "+a;var c=b.left.toFixed(a)+" "+(b.y+b.height/2).toFixed(a);return"M"+c+"A"+(b.width/
2).toFixed(a)+" "+(b.height/2).toFixed(a)+" 0 0 1 "+(b.right.toFixed(a)+" "+(b.y+b.height/2).toFixed(a))+"A"+(b.width/2).toFixed(a)+" "+(b.height/2).toFixed(a)+" 0 0 1 "+c;case ne:b="";c=this.figures.j;for(var d=c.length,e=0;e<d;e++){var f=c[e];0<e&&(b+=" x ");f.isFilled&&(b+="F ");b+=f.toString(a)}return b;default:return this.type.toString()}};
function ze(a,b){function c(){return u>=F-1?!0:null!==k[u+1].match(/[UuBbMmZzLlHhVvCcSsQqTtAaFfXx]/)}function d(){u++;return k[u]}function e(){var a=new J(parseFloat(d()),parseFloat(d()));y===y.toLowerCase()&&(a.x=C.x+a.x,a.y=C.y+a.y);return a}function f(){return C=e()}function g(){return A=e()}function h(){var a=x.toLowerCase();return"c"!==a&&"s"!==a&&"q"!==a&&"t"!==a?C:new J(2*C.x-A.x,2*C.y-A.y)}void 0===b&&(b=!1);"string"!==typeof a&&Ba(a,"string",me,"parse:str");a=a.replace(/,/gm," ");a=a.replace(/([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])/gm,
"$1 $2");a=a.replace(/([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])/gm,"$1 $2");a=a.replace(/([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])([^\s])/gm,"$1 $2");a=a.replace(/([^\s])([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])/gm,"$1 $2");a=a.replace(/([0-9])([+\-])/gm,"$1 $2");a=a.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 ");a=a.replace(/[\s\r\t\n]+/gm," ");a=a.replace(/^\s+|\s+$/g,"");var k=a.split(" ");for(a=0;a<k.length;a++){var l=k[a];if(null!==l.match(/(\.[0-9]*)(\.)/gm)){for(var m=
Qa(),n="",p=!1,q=0;q<l.length;q++){var r=l[q];"."!==r||p?"."===r?(m.push(n),n="."):n+=r:(p=!0,n+=r)}m.push(n);k.splice(a,1);for(l=0;l<m.length;l++)k.splice(a+l,0,m[l]);a+=m.length-1;Ta(m)}}var u=-1,y="",x="";m=new J(0,0);var A=new J(0,0),C=new J(0,0),F=k.length;a=Ae(null);n=l=!1;p=!0;for(q=null;!(u>=F-1);)if(x=y,y=d(),""!==y)switch(y.toUpperCase()){case "X":p=!0;n=l=!1;break;case "M":q=f();null===a.ic||!0===p?(Be(a,q.x,q.y,l,!n),p=!1):a.moveTo(q.x,q.y);for(m=C;!c();)q=f(),a.lineTo(q.x,q.y);break;
case "L":for(;!c();)q=f(),a.lineTo(q.x,q.y);break;case "H":for(;!c();)C=new J((y===y.toLowerCase()?C.x:0)+parseFloat(d()),C.y),a.lineTo(C.x,C.y);break;case "V":for(;!c();)C=new J(C.x,(y===y.toLowerCase()?C.y:0)+parseFloat(d())),a.lineTo(C.x,C.y);break;case "C":for(;!c();){q=e();r=g();var I=f();Ce(a,q.x,q.y,r.x,r.y,I.x,I.y)}break;case "S":for(;!c();)q=h(),r=g(),I=f(),Ce(a,q.x,q.y,r.x,r.y,I.x,I.y);break;case "Q":for(;!c();)q=g(),r=f(),He(a,q.x,q.y,r.x,r.y);break;case "T":for(;!c();)A=q=h(),r=f(),He(a,
q.x,q.y,r.x,r.y);break;case "B":for(;!c();){q=parseFloat(d());r=parseFloat(d());I=parseFloat(d());var O=parseFloat(d()),S=parseFloat(d()),T=S,ca=!1;c()||(T=parseFloat(d()),c()||(ca=0!==parseFloat(d())));y===y.toLowerCase()&&(I+=C.x,O+=C.y);a.arcTo(q,r,I,O,S,T,ca)}break;case "A":for(;!c();)q=Math.abs(parseFloat(d())),r=Math.abs(parseFloat(d())),I=parseFloat(d()),O=!!parseFloat(d()),S=!!parseFloat(d()),T=f(),Ie(a,q,r,I,O,S,T.x,T.y);break;case "Z":Je(a);C=m;break;case "F":q="";for(r=1;k[u+r];)if(null!==
k[u+r].match(/[Uu]/))r++;else if(null===k[u+r].match(/[UuBbMmZzLlHhVvCcSsQqTtAaFfXx]/))r++;else{q=k[u+r];break}q.match(/[Mm]/)?l=!0:0<a.ic.segments.length&&(a.ic.isFilled=!0);break;case "U":q="";for(r=1;k[u+r];)if(null!==k[u+r].match(/[Ff]/))r++;else if(null===k[u+r].match(/[UuBbMmZzLlHhVvCcSsQqTtAaFfXx]/))r++;else{q=k[u+r];break}q.match(/[Mm]/)?n=!0:a.wq(!1)}m=a.Xs;Ke=a;if(b)for(b=m.figures.iterator;b.next();)b.value.isFilled=!0;return m}
function Le(a,b){for(var c=a.length,d=J.alloc(),e=0;e<c;e++){var f=a[e];d.x=f[0];d.y=f[1];b.va(d);f[0]=d.x;f[1]=d.y;d.x=f[2];d.y=f[3];b.va(d);f[2]=d.x;f[3]=d.y;d.x=f[4];d.y=f[5];b.va(d);f[4]=d.x;f[5]=d.y;d.x=f[6];d.y=f[7];b.va(d);f[6]=d.x;f[7]=d.y}J.free(d)}t.mv=function(){if(this.ta||this.nr!==this.figures.s)return!0;for(var a=this.figures.j,b=a.length,c=0;c<b;c++)if(a[c].mv())return!0;return!1};
me.prototype.computeBounds=function(){this.ta=!1;this.Qm=this.wk=null;this.Rm=NaN;this.nr=this.figures.s;for(var a=this.figures.j,b=a.length,c=0;c<b;c++){var d=a[c];d.ta=!1;var e=d.segments;d.us=e.s;d=e.j;e=d.length;for(var f=0;f<e;f++){var g=d[f];g.ta=!1;g.Me=null}}a=this.Xq;a.ja();isNaN(this.bl)||isNaN(this.$k)?a.h(0,0,0,0):a.h(0,0,this.bl,this.$k);Me(this,a,!1);Pc(a,0,0,0,0);a.freeze()};me.prototype.bx=function(){var a=new L;Me(this,a,!0);return a};
function Me(a,b,c){switch(a.type){case te:case xe:case ye:c?b.h(a.ed,a.fd,0,0):Pc(b,a.ed,a.fd,0,0);Pc(b,a.qc,a.Fc,0,0);break;case ne:var d=a.figures;a=d.j;d=d.length;for(var e=0;e<d;e++){var f=a[e];c&&0===e?b.h(f.startX,f.startY,0,0):Pc(b,f.startX,f.startY,0,0);for(var g=f.segments.j,h=g.length,k=f.startX,l=f.startY,m=0;m<h;m++){var n=g[m];switch(n.type){case ve:case Ne:k=n.endX;l=n.endY;Pc(b,k,l,0,0);break;case Oe:K.Ul(k,l,n.point1X,n.point1Y,n.point2X,n.point2Y,n.endX,n.endY,.5,b);k=n.endX;l=n.endY;
break;case Pe:K.uv(k,l,n.point1X,n.point1Y,n.endX,n.endY,.5,b);k=n.endX;l=n.endY;break;case Qe:case Re:var p=n.type===Qe?Se(n,f):Te(n,f,k,l),q=p.length;if(0===q){k=n.centerX;l=n.centerY;Pc(b,k,l,0,0);break}n=null;for(var r=0;r<q;r++)n=p[r],K.Ul(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],.5,b);null!==n&&(k=n[6],l=n[7]);break;default:v("Unknown Segment type: "+n.type)}}}break;default:v("Unknown Geometry type: "+a.type)}}
me.prototype.normalize=function(){this.u&&ya(this);var a=this.bx();this.offset(-a.x,-a.y);return new J(-a.x,-a.y)};me.prototype.offset=function(a,b){this.u&&ya(this);E&&(B(a,me,"offset"),B(b,me,"offset"));this.transform(1,0,0,1,a,b);return this};me.prototype.scale=function(a,b){this.u&&ya(this);E&&(B(a,me,"scale:x"),B(b,me,"scale:y"),0===a&&Ca(a,"scale must be non-zero",me,"scale:x"),0===b&&Ca(b,"scale must be non-zero",me,"scale:y"));this.transform(a,0,0,b,0,0);return this};
me.prototype.rotate=function(a,b,c){this.u&&ya(this);void 0===b&&(b=0);void 0===c&&(c=0);E&&(B(a,me,"rotate:angle"),B(b,me,"rotate:x"),B(c,me,"rotate:y"));var d=$b.alloc();d.reset();d.rotate(a,b,c);this.transform(d.m11,d.m12,d.m21,d.m22,d.dx,d.dy);$b.free(d);return this};t=me.prototype;
t.transform=function(a,b,c,d,e,f){switch(this.type){case te:case xe:case ye:var g=this.ed;var h=this.fd;this.ed=g*a+h*c+e;this.fd=g*b+h*d+f;g=this.qc;h=this.Fc;this.qc=g*a+h*c+e;this.Fc=g*b+h*d+f;break;case ne:for(var k=this.figures.j,l=k.length,m=0;m<l;m++){var n=k[m];g=n.startX;h=n.startY;n.startX=g*a+h*c+e;n.startY=g*b+h*d+f;n=n.segments.j;for(var p=n.length,q=0;q<p;q++){var r=n[q];switch(r.type){case ve:case Ne:g=r.endX;h=r.endY;r.endX=g*a+h*c+e;r.endY=g*b+h*d+f;break;case Oe:g=r.point1X;h=r.point1Y;
r.point1X=g*a+h*c+e;r.point1Y=g*b+h*d+f;g=r.point2X;h=r.point2Y;r.point2X=g*a+h*c+e;r.point2Y=g*b+h*d+f;g=r.endX;h=r.endY;r.endX=g*a+h*c+e;r.endY=g*b+h*d+f;break;case Pe:g=r.point1X;h=r.point1Y;r.point1X=g*a+h*c+e;r.point1Y=g*b+h*d+f;g=r.endX;h=r.endY;r.endX=g*a+h*c+e;r.endY=g*b+h*d+f;break;case Qe:g=r.centerX;h=r.centerY;r.centerX=g*a+h*c+e;r.centerY=g*b+h*d+f;0!==b&&(g=180*Math.atan2(b,a)/Math.PI,0>g&&(g+=360),r.startAngle+=g);0>a&&(r.startAngle=180-r.startAngle,r.sweepAngle=-r.sweepAngle);0>d&&
(r.startAngle=-r.startAngle,r.sweepAngle=-r.sweepAngle);r.radiusX*=Math.sqrt(a*a+c*c);void 0!==r.radiusY&&(r.radiusY*=Math.sqrt(b*b+d*d));break;case Re:g=r.endX;h=r.endY;r.endX=g*a+h*c+e;r.endY=g*b+h*d+f;0!==b&&(g=180*Math.atan2(b,a)/Math.PI,0>g&&(g+=360),r.xAxisRotation+=g);0>a&&(r.xAxisRotation=180-r.xAxisRotation,r.isClockwiseArc=!r.isClockwiseArc);0>d&&(r.xAxisRotation=-r.xAxisRotation,r.isClockwiseArc=!r.isClockwiseArc);r.radiusX*=Math.sqrt(a*a+c*c);r.radiusY*=Math.sqrt(b*b+d*d);break;default:v("Unknown Segment type: "+
r.type)}}}}this.ta=!0;return this};
t.fa=function(a,b,c,d){var e=a.x;a=a.y;for(var f=this.bounds.x-20,g=0,h,k,l,m,n,p=this.figures.j,q=p.length,r=0;r<q;r++){var u=p[r];if(u.isFilled){if(c&&u.fa(e,a,b))return!0;var y=u.segments;h=u.startX;k=u.startY;for(var x=h,A=k,C=y.j,F=0;F<=y.length;F++){var I=void 0;if(F!==y.length){I=C[F];var O=I.type;m=I.endX;n=I.endY}else O=ve,m=x,n=A;switch(O){case Ne:x=Ue(e,a,f,a,h,k,x,A);if(isNaN(x))return!0;g+=x;x=m;A=n;break;case ve:h=Ue(e,a,f,a,h,k,m,n);if(isNaN(h))return!0;g+=h;break;case Oe:l=K.Qp(h,
k,I.point1X,I.point1Y,I.point2X,I.point2Y,m,n,f,a,e,a,.5);g+=l;break;case Pe:l=K.Qp(h,k,(h+2*I.point1X)/3,(k+2*I.point1Y)/3,(2*I.point1X+m)/3,(2*I.point1Y+n)/3,m,n,f,a,e,a,.5);g+=l;break;case Qe:case Re:O=I.type===Qe?Se(I,u):Te(I,u,h,k);var S=O.length;if(0===S){h=Ue(e,a,f,a,h,k,I.centerX,I.centerY);if(isNaN(h))return!0;g+=h;break}I=null;for(var T=0;T<S;T++){I=O[T];if(0===T){l=Ue(e,a,f,a,h,k,I[0],I[1]);if(isNaN(l))return!0;g+=l}l=K.Qp(I[0],I[1],I[2],I[3],I[4],I[5],I[6],I[7],f,a,e,a,.5);g+=l}null!==
I&&(m=I[6],n=I[7]);break;default:v("Unknown Segment type: "+I.type)}h=m;k=n}if(0!==g)return!0;g=0}else if(u.fa(e,a,d?b:b+2))return!0}return 0!==g};function Ue(a,b,c,d,e,f,g,h){if(K.Vb(e,f,g,h,.05,a,b))return NaN;var k=(a-c)*(f-h);if(0===k)return 0;var l=((a*d-b*c)*(e-g)-(a-c)*(e*h-f*g))/k;b=(a*d-b*c)*(f-h)/k;if(l>=a)return 0;if((e>g?e-g:g-e)<(f>h?f-h:h-f))if(f<h){if(b<f||b>h)return 0}else{if(b<h||b>f)return 0}else if(e<g){if(l<e||l>g)return 0}else if(l<g||l>e)return 0;return 0<k?1:-1}
function Ve(a,b,c,d){a=a.figures.j;for(var e=a.length,f=0;f<e;f++)if(a[f].fa(b,c,d))return!0;return!1}
t.ev=function(a,b){0>a?a=0:1<a&&(a=1);void 0===b&&(b=new J);if(this.type===te)return b.h(this.startX+a*(this.endX-this.startX),this.startY+a*(this.endY-this.startY)),b;for(var c=this.flattenedSegments,d=this.flattenedLengths,e=c.length,f=this.flattenedTotalLength*a,g=0,h=0;h<e;h++){var k=d[h],l=k.length;for(a=0;a<l;a++){var m=k[a];if(g+m>=f)return d=(f-g)/m,c=c[h],e=c[2*a],h=c[2*a+1],b.h(e+(c[2*a+2]-e)*d,h+(c[2*a+3]-h)*d),b;g+=m}}b.h(NaN,NaN);return b};
t.px=function(a){if(this.type===te){var b=this.startX,c=this.startY,d=this.endX,e=this.endY;if(b!==d||c!==e){var f=a.x;a=a.y;if(b===d){if(c<e){var g=c;d=e}else g=e,d=c;return a<=g?g===c?0:1:a>=d?d===c?0:1:Math.abs(a-c)/(d-g)}return c===e?(b<d?g=b:(g=d,d=b),f<=g?g===b?0:1:f>=d?d===b?0:1:Math.abs(f-b)/(d-g)):((f-b)*(f-b)+(a-c)*(a-c))/((d-b)*(d-b)+(e-c)*(e-c))}}else if(this.type===xe){g=this.startX;var h=this.startY,k=this.endX;e=this.endY;if(g!==k||h!==e){b=k-g;c=e-h;f=2*b+2*c;d=a.x;a=a.y;d=Math.min(Math.max(d,
g),k);a=Math.min(Math.max(a,h),e);g=Math.abs(d-g);k=Math.abs(d-k);h=Math.abs(a-h);e=Math.abs(a-e);var l=Math.min(g,k,h,e);if(l===h)return d/f;if(l===k)return(b+a)/f;if(l===e)return(2*b+c-d)/f;if(l===g)return(2*b+2*c-a)/f}}else{b=this.flattenedSegments;c=this.flattenedLengths;f=this.flattenedTotalLength;d=J.alloc();e=Infinity;h=g=0;k=b.length;for(var m=l=0,n=0;n<k;n++)for(var p=b[n],q=c[n],r=p.length,u=0;u<r;u+=2){var y=p[u],x=p[u+1];if(0!==u){K.Pi(l,m,y,x,a.x,a.y,d);var A=(d.x-a.x)*(d.x-a.x)+(d.y-
a.y)*(d.y-a.y);A<e&&(e=A,g=h,g+=Math.sqrt((d.x-l)*(d.x-l)+(d.y-m)*(d.y-m)));h+=q[(u-2)/2]}l=y;m=x}J.free(d);a=g/f;return 0>a?0:1<a?1:a}return 0};
function We(a){if(null===a.wk){var b=a.wk=[],c=a.Qm=[],d=[],e=[];if(a.type===te)d.push(a.startX),d.push(a.startY),d.push(a.endX),d.push(a.endY),b.push(d),e.push(Math.sqrt((a.startX-a.endX)*(a.startX-a.endX)+(a.startY-a.endY)*(a.startY-a.endY))),c.push(e);else if(a.type===xe)d.push(a.startX),d.push(a.startY),d.push(a.endX),d.push(a.startY),d.push(a.endX),d.push(a.endY),d.push(a.startX),d.push(a.endY),d.push(a.startX),d.push(a.startY),b.push(d),e.push(Math.abs(a.startX-a.endX)),e.push(Math.abs(a.startY-
a.endY)),e.push(Math.abs(a.startX-a.endX)),e.push(Math.abs(a.startY-a.endY)),c.push(e);else if(a.type===ye){var f=new Xe;f.startX=a.endX;f.startY=(a.startY+a.endY)/2;var g=new Ye(Qe);g.startAngle=0;g.sweepAngle=360;g.centerX=(a.startX+a.endX)/2;g.centerY=(a.startY+a.endY)/2;g.radiusX=Math.abs(a.startX-a.endX)/2;g.radiusY=Math.abs(a.startY-a.endY)/2;f.add(g);a=Se(g,f);e=a.length;if(0===e)d.push(g.centerX),d.push(g.centerY);else{g=f.startX;f=f.startY;for(var h=0;h<e;h++){var k=a[h];K.Ce(g,f,k[2],k[3],
k[4],k[5],k[6],k[7],.5,d);g=k[6];f=k[7]}}b.push(d);c.push(jf(d))}else for(a=a.figures.iterator;a.next();){e=a.value;d=[];d.push(e.startX);d.push(e.startY);g=e.startX;f=e.startY;h=g;k=f;for(var l=e.segments.j,m=l.length,n=0;n<m;n++){var p=l[n];switch(p.type){case Ne:4<=d.length&&(b.push(d),c.push(jf(d)));d=[];d.push(p.endX);d.push(p.endY);g=p.endX;f=p.endY;h=g;k=f;break;case ve:d.push(p.endX);d.push(p.endY);g=p.endX;f=p.endY;break;case Oe:K.Ce(g,f,p.point1X,p.point1Y,p.point2X,p.point2Y,p.endX,p.endY,
.5,d);g=p.endX;f=p.endY;break;case Pe:K.pq(g,f,p.point1X,p.point1Y,p.endX,p.endY,.5,d);g=p.endX;f=p.endY;break;case Qe:var q=Se(p,e),r=q.length;if(0===r){d.push(p.centerX);d.push(p.centerY);g=p.centerX;f=p.centerY;break}for(var u=0;u<r;u++){var y=q[u];K.Ce(g,f,y[2],y[3],y[4],y[5],y[6],y[7],.5,d);g=y[6];f=y[7]}break;case Re:q=Te(p,e,g,f);r=q.length;if(0===r){d.push(p.centerX);d.push(p.centerY);g=p.centerX;f=p.centerY;break}for(u=0;u<r;u++)y=q[u],K.Ce(g,f,y[2],y[3],y[4],y[5],y[6],y[7],.5,d),g=y[6],
f=y[7];break;default:v("Segment not of valid type: "+p.type)}p.isClosed&&(d.push(h),d.push(k))}4<=d.length&&(b.push(d),c.push(jf(d)))}}}function jf(a){for(var b=[],c=0,d=0,e=a.length,f=0;f<e;f+=2){var g=a[f],h=a[f+1];0!==f&&(c=Math.sqrt(dc(c,d,g,h)),b.push(c));c=g;d=h}return b}t.add=function(a){this.fj.add(a);return this};t.Am=function(a,b,c,d,e,f,g,h){this.u&&ya(this);this.ef=(new M(a,b,e,f)).freeze();this.ff=(new M(c,d,g,h)).freeze();return this};
na.Object.defineProperties(me.prototype,{flattenedSegments:{configurable:!0,get:function(){We(this);return this.wk}},flattenedLengths:{configurable:!0,get:function(){We(this);return this.Qm}},flattenedTotalLength:{configurable:!0,get:function(){var a=this.Rm;if(isNaN(a)){if(this.type===te){a=Math.abs(this.endX-this.startX);var b=Math.abs(this.endY-this.startY);a=Math.sqrt(a*a+b*b)}else if(this.type===xe)a=2*Math.abs(this.endX-this.startX)+2*Math.abs(this.endY-
this.startY);else{b=this.flattenedLengths;for(var c=b.length,d=a=0;d<c;d++)for(var e=b[d],f=e.length,g=0;g<f;g++)a+=e[g]}this.Rm=a}return a}},type:{configurable:!0,get:function(){return this.wa},set:function(a){this.wa!==a&&(E&&tb(a,me,me,"type"),this.u&&ya(this,a),this.wa=a,this.ta=!0)}},startX:{configurable:!0,get:function(){return this.ed},set:function(a){this.ed!==a&&(E&&B(a,me,"startX"),this.u&&ya(this,a),this.ed=a,this.ta=!0)}},startY:{configurable:!0,
get:function(){return this.fd},set:function(a){this.fd!==a&&(E&&B(a,me,"startY"),this.u&&ya(this,a),this.fd=a,this.ta=!0)}},endX:{configurable:!0,get:function(){return this.qc},set:function(a){this.qc!==a&&(E&&B(a,me,"endX"),this.u&&ya(this,a),this.qc=a,this.ta=!0)}},endY:{configurable:!0,get:function(){return this.Fc},set:function(a){this.Fc!==a&&(E&&B(a,me,"endY"),this.u&&ya(this,a),this.Fc=a,this.ta=!0)}},figures:{configurable:!0,get:function(){return this.fj},
set:function(a){this.fj!==a&&(E&&w(a,G,me,"figures"),this.u&&ya(this,a),this.fj=a,this.ta=!0)}},spot1:{configurable:!0,get:function(){return this.ef},set:function(a){E&&w(a,M,me,"spot1");this.u&&ya(this,a);this.ef=a.J()}},spot2:{configurable:!0,get:function(){return this.ff},set:function(a){E&&w(a,M,me,"spot2");this.u&&ya(this,a);this.ff=a.J()}},defaultStretch:{configurable:!0,get:function(){return this.Ef},set:function(a){E&&tb(a,N,me,"stretch");this.u&&
ya(this,a);this.Ef=a}},bounds:{configurable:!0,get:function(){this.mv()&&this.computeBounds();return this.Xq}}});me.prototype.setSpots=me.prototype.Am;me.prototype.add=me.prototype.add;me.prototype.getFractionForPoint=me.prototype.px;me.prototype.getPointAlongPath=me.prototype.ev;me.prototype.transform=me.prototype.transform;me.prototype.rotate=me.prototype.rotate;me.prototype.scale=me.prototype.scale;me.prototype.offset=me.prototype.offset;me.prototype.normalize=me.prototype.normalize;
me.prototype.computeBoundsWithoutOrigin=me.prototype.bx;me.prototype.equalsApprox=me.prototype.Ra;var te=new D(me,"Line",0),xe=new D(me,"Rectangle",1),ye=new D(me,"Ellipse",2),ne=new D(me,"Path",3);me.className="Geometry";me.stringify=we;me.fillPath=function(a){"string"!==typeof a&&Ba(a,"string",me,"fillPath:str");a=a.split(/[Xx]/);for(var b=a.length,c="",d=0;d<b;d++){var e=a[d];c=null!==e.match(/[Ff]/)?0===d?c+e:c+("X"+(" "===e[0]?"":" ")+e):c+((0===d?"":"X ")+"F"+(" "===e[0]?"":" ")+e)}return c};
me.parse=ze;me.Line=te;me.Rectangle=xe;me.Ellipse=ye;me.Path=ne;function Xe(a,b,c,d){rb(this);this.u=!1;void 0===c&&(c=!0);this.Er=c;void 0===d&&(d=!0);this.Hr=d;void 0!==a?(E&&B(a,Xe,"sx"),this.ed=a):this.ed=0;void 0!==b?(E&&B(b,Xe,"sy"),this.fd=b):this.fd=0;this.Al=new G;this.us=this.Al.s;this.ta=!0}
Xe.prototype.copy=function(){var a=new Xe;a.Er=this.Er;a.Hr=this.Hr;a.ed=this.ed;a.fd=this.fd;for(var b=this.Al.j,c=b.length,d=a.Al,e=0;e<c;e++){var f=b[e].copy();d.add(f)}a.us=this.us;a.ta=this.ta;return a};t=Xe.prototype;t.Ra=function(a){if(!(a instanceof Xe&&K.B(this.startX,a.startX)&&K.B(this.startY,a.startY)))return!1;var b=this.segments.j;a=a.segments.j;var c=b.length;if(c!==a.length)return!1;for(var d=0;d<c;d++)if(!b[d].Ra(a[d]))return!1;return!0};
t.toString=function(a){void 0===a&&(a=-1);var b=0>a?"M"+this.startX.toString()+" "+this.startY.toString():"M"+this.startX.toFixed(a)+" "+this.startY.toFixed(a);for(var c=this.segments.j,d=c.length,e=0;e<d;e++)b+=" "+c[e].toString(a);return b};t.freeze=function(){this.u=!0;var a=this.segments;a.freeze();var b=a.j;a=a.length;for(var c=0;c<a;c++)b[c].freeze();return this};t.ja=function(){this.u=!1;var a=this.segments;a.ja();a=a.j;for(var b=a.length,c=0;c<b;c++)a[c].ja();return this};
t.mv=function(){if(this.ta)return!0;var a=this.segments;if(this.us!==a.s)return!0;a=a.j;for(var b=a.length,c=0;c<b;c++)if(a[c].ta)return!0;return!1};t.add=function(a){this.Al.add(a);return this};
t.fa=function(a,b,c){for(var d=this.startX,e=this.startY,f=d,g=e,h=this.segments.j,k=h.length,l=0;l<k;l++){var m=h[l];switch(m.type){case Ne:f=m.endX;g=m.endY;d=m.endX;e=m.endY;break;case ve:if(K.Vb(d,e,m.endX,m.endY,c,a,b))return!0;d=m.endX;e=m.endY;break;case Oe:if(K.Ls(d,e,m.point1X,m.point1Y,m.point2X,m.point2Y,m.endX,m.endY,.5,a,b,c))return!0;d=m.endX;e=m.endY;break;case Pe:if(K.vv(d,e,m.point1X,m.point1Y,m.endX,m.endY,.5,a,b,c))return!0;d=m.endX;e=m.endY;break;case Qe:case Re:var n=m.type===
Qe?Se(m,this):Te(m,this,d,e),p=n.length;if(0===p){if(K.Vb(d,e,m.centerX,m.centerY,c,a,b))return!0;d=m.centerX;e=m.centerY;break}for(var q=null,r=0;r<p;r++)if(q=n[r],0===r&&K.Vb(d,e,q[0],q[1],c,a,b)||K.Ls(q[0],q[1],q[2],q[3],q[4],q[5],q[6],q[7],.5,a,b,c))return!0;null!==q&&(d=q[6],e=q[7]);break;default:v("Unknown Segment type: "+m.type)}if(m.isClosed&&(d!==f||e!==g)&&K.Vb(d,e,f,g,c,a,b))return!0}return!1};
na.Object.defineProperties(Xe.prototype,{isFilled:{configurable:!0,get:function(){return this.Er},set:function(a){E&&z(a,"boolean",Xe,"isFilled");this.u&&ya(this,a);this.Er=a}},isShadowed:{configurable:!0,get:function(){return this.Hr},set:function(a){E&&z(a,"boolean",Xe,"isShadowed");this.u&&ya(this,a);this.Hr=a}},startX:{configurable:!0,get:function(){return this.ed},set:function(a){E&&B(a,Xe,"startX");this.u&&ya(this,a);this.ed=a;this.ta=!0}},startY:{configurable:!0,
enumerable:!0,get:function(){return this.fd},set:function(a){E&&B(a,Xe,"startY");this.u&&ya(this,a);this.fd=a;this.ta=!0}},segments:{configurable:!0,get:function(){return this.Al},set:function(a){E&&w(a,G,Xe,"segments");this.u&&ya(this,a);this.Al=a;this.ta=!0}}});Xe.prototype.add=Xe.prototype.add;Xe.prototype.equalsApprox=Xe.prototype.Ra;Xe.className="PathFigure";
function Ye(a,b,c,d,e,f,g,h){rb(this);this.u=!1;void 0===a?a=ve:E&&tb(a,Ye,Ye,"constructor:type");this.wa=a;void 0!==b?(E&&B(b,Ye,"ex"),this.qc=b):this.qc=0;void 0!==c?(E&&B(c,Ye,"ey"),this.Fc=c):this.Fc=0;void 0===d&&(d=0);void 0===e&&(e=0);void 0===f&&(f=0);void 0===g&&(g=0);a===Re?(a=f%360,0>a&&(a+=360),this.ve=a,this.li=0,E&&B(d,Ye,"x1"),this.mi=Math.max(d,0),E&&B(e,Ye,"y1"),this.Yg=Math.max(e,0),this.fl="boolean"===typeof g?!!g:!1,this.Bk=!!h):(E&&B(d,Ye,"x1"),this.ve=d,E&&B(e,Ye,"y1"),this.li=
e,E&&B(f,Ye,"x2"),a===Qe&&(f=Math.max(f,0)),this.mi=f,"number"===typeof g?(a===Qe&&(g=Math.max(g,0)),this.Yg=g):this.Yg=0,this.Bk=this.fl=!1);this.kj=!1;this.ta=!0;this.Me=null}Ye.prototype.copy=function(){var a=new Ye;a.wa=this.wa;a.qc=this.qc;a.Fc=this.Fc;a.ve=this.ve;a.li=this.li;a.mi=this.mi;a.Yg=this.Yg;a.fl=this.fl;a.Bk=this.Bk;a.kj=this.kj;a.ta=this.ta;return a};t=Ye.prototype;
t.Ra=function(a){if(!(a instanceof Ye)||this.type!==a.type||this.isClosed!==a.isClosed)return!1;switch(this.type){case Ne:case ve:return K.B(this.endX,a.endX)&&K.B(this.endY,a.endY);case Oe:return K.B(this.endX,a.endX)&&K.B(this.endY,a.endY)&&K.B(this.point1X,a.point1X)&&K.B(this.point1Y,a.point1Y)&&K.B(this.point2X,a.point2X)&&K.B(this.point2Y,a.point2Y);case Pe:return K.B(this.endX,a.endX)&&K.B(this.endY,a.endY)&&K.B(this.point1X,a.point1X)&&K.B(this.point1Y,a.point1Y);case Qe:return K.B(this.startAngle,
a.startAngle)&&K.B(this.sweepAngle,a.sweepAngle)&&K.B(this.centerX,a.centerX)&&K.B(this.centerY,a.centerY)&&K.B(this.radiusX,a.radiusX)&&K.B(this.radiusY,a.radiusY);case Re:return this.isClockwiseArc===a.isClockwiseArc&&this.isLargeArc===a.isLargeArc&&K.B(this.xAxisRotation,a.xAxisRotation)&&K.B(this.endX,a.endX)&&K.B(this.endY,a.endY)&&K.B(this.radiusX,a.radiusX)&&K.B(this.radiusY,a.radiusY);default:return!1}};t.ib=function(a){a.classType===Ye?this.type=a:Fa(this,a)};
t.toString=function(a){void 0===a&&(a=-1);switch(this.type){case Ne:a=0>a?"M"+this.endX.toString()+" "+this.endY.toString():"M"+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;case ve:a=0>a?"L"+this.endX.toString()+" "+this.endY.toString():"L"+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;case Oe:a=0>a?"C"+this.point1X.toString()+" "+this.point1Y.toString()+" "+this.point2X.toString()+" "+this.point2Y.toString()+" "+this.endX.toString()+" "+this.endY.toString():"C"+this.point1X.toFixed(a)+
" "+this.point1Y.toFixed(a)+" "+this.point2X.toFixed(a)+" "+this.point2Y.toFixed(a)+" "+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;case Pe:a=0>a?"Q"+this.point1X.toString()+" "+this.point1Y.toString()+" "+this.endX.toString()+" "+this.endY.toString():"Q"+this.point1X.toFixed(a)+" "+this.point1Y.toFixed(a)+" "+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;case Qe:a=0>a?"B"+this.startAngle.toString()+" "+this.sweepAngle.toString()+" "+this.centerX.toString()+" "+this.centerY.toString()+
" "+this.radiusX.toString()+" "+this.radiusY.toString():"B"+this.startAngle.toFixed(a)+" "+this.sweepAngle.toFixed(a)+" "+this.centerX.toFixed(a)+" "+this.centerY.toFixed(a)+" "+this.radiusX.toFixed(a)+" "+this.radiusY.toFixed(a);break;case Re:a=0>a?"A"+this.radiusX.toString()+" "+this.radiusY.toString()+" "+this.xAxisRotation.toString()+" "+(this.isLargeArc?1:0)+" "+(this.isClockwiseArc?1:0)+" "+this.endX.toString()+" "+this.endY.toString():"A"+this.radiusX.toFixed(a)+" "+this.radiusY.toFixed(a)+
" "+this.xAxisRotation.toFixed(a)+" "+(this.isLargeArc?1:0)+" "+(this.isClockwiseArc?1:0)+" "+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;default:a=this.type.toString()}return a+(this.kj?"z":"")};t.freeze=function(){this.u=!0;return this};t.ja=function(){this.u=!1;return this};t.close=function(){this.kj=!0;return this};
function Se(a,b){if(null!==a.Me&&!1===b.ta)return a.Me;var c=a.radiusX,d=a.radiusY;void 0===d&&(d=c);if(0===c||0===d)return a.Me=[],a.Me;b=a.ve;var e=a.li,f=K.gx(0,0,c<d?c:d,a.startAngle,a.startAngle+a.sweepAngle,!1);if(c!==d){var g=$b.alloc();g.reset();c<d?g.scale(1,d/c):g.scale(c/d,1);Le(f,g);$b.free(g)}c=f.length;for(d=0;d<c;d++)g=f[d],g[0]+=b,g[1]+=e,g[2]+=b,g[3]+=e,g[4]+=b,g[5]+=e,g[6]+=b,g[7]+=e;a.Me=f;return a.Me}
function Te(a,b,c,d){function e(a,b,c,d){return(a*d<b*c?-1:1)*Math.acos((a*c+b*d)/(Math.sqrt(a*a+b*b)*Math.sqrt(c*c+d*d)))}if(null!==a.Me&&!1===b.ta)return a.Me;b=a.mi;var f=a.Yg;0===b&&(b=1E-4);0===f&&(f=1E-4);var g=Math.PI/180*a.ve,h=a.fl,k=a.Bk,l=a.qc,m=a.Fc,n=Math.cos(g),p=Math.sin(g),q=n*(c-l)/2+p*(d-m)/2;g=-p*(c-l)/2+n*(d-m)/2;var r=q*q/(b*b)+g*g/(f*f);1<r&&(b*=Math.sqrt(r),f*=Math.sqrt(r));r=(h===k?-1:1)*Math.sqrt((b*b*f*f-b*b*g*g-f*f*q*q)/(b*b*g*g+f*f*q*q));isNaN(r)&&(r=0);h=r*b*g/f;r=r*-f*
q/b;isNaN(h)&&(h=0);isNaN(r)&&(r=0);c=(c+l)/2+n*h-p*r;d=(d+m)/2+p*h+n*r;m=e(1,0,(q-h)/b,(g-r)/f);n=(q-h)/b;l=(g-r)/f;q=(-q-h)/b;h=(-g-r)/f;g=e(n,l,q,h);q=(n*q+l*h)/(Math.sqrt(n*n+l*l)*Math.sqrt(q*q+h*h));-1>=q?g=Math.PI:1<=q&&(g=0);!k&&0<g&&(g-=2*Math.PI);k&&0>g&&(g+=2*Math.PI);k=b>f?1:b/f;q=b>f?f/b:1;b=K.gx(0,0,b>f?b:f,m,m+g,!0);f=$b.alloc();f.reset();f.translate(c,d);f.rotate(a.ve,0,0);f.scale(k,q);Le(b,f);$b.free(f);a.Me=b;return a.Me}
na.Object.defineProperties(Ye.prototype,{isClosed:{configurable:!0,get:function(){return this.kj},set:function(a){this.kj!==a&&(this.kj=a,this.ta=!0)}},type:{configurable:!0,get:function(){return this.wa},set:function(a){E&&tb(a,Ye,Ye,"type");this.u&&ya(this,a);this.wa=a;this.ta=!0}},endX:{configurable:!0,get:function(){return this.qc},set:function(a){E&&B(a,Ye,"endX");this.u&&ya(this,a);this.qc=a;this.ta=!0}},endY:{configurable:!0,get:function(){return this.Fc},
set:function(a){E&&B(a,Ye,"endY");this.u&&ya(this,a);this.Fc=a;this.ta=!0}},point1X:{configurable:!0,get:function(){return this.ve},set:function(a){E&&B(a,Ye,"point1X");this.u&&ya(this,a);this.ve=a;this.ta=!0}},point1Y:{configurable:!0,get:function(){return this.li},set:function(a){E&&B(a,Ye,"point1Y");this.u&&ya(this,a);this.li=a;this.ta=!0}},point2X:{configurable:!0,get:function(){return this.mi},set:function(a){E&&B(a,Ye,"point2X");this.u&&ya(this,a);this.mi=
a;this.ta=!0}},point2Y:{configurable:!0,get:function(){return this.Yg},set:function(a){E&&B(a,Ye,"point2Y");this.u&&ya(this,a);this.Yg=a;this.ta=!0}},centerX:{configurable:!0,get:function(){return this.ve},set:function(a){E&&B(a,Ye,"centerX");this.u&&ya(this,a);this.ve=a;this.ta=!0}},centerY:{configurable:!0,get:function(){return this.li},set:function(a){E&&B(a,Ye,"centerY");this.u&&ya(this,a);this.li=a;this.ta=!0}},radiusX:{configurable:!0,
get:function(){return this.mi},set:function(a){E&&B(a,Ye,"radiusX");0>a&&Ca(a,">= zero",Ye,"radiusX");this.u&&ya(this,a);this.mi=a;this.ta=!0}},radiusY:{configurable:!0,get:function(){return this.Yg},set:function(a){E&&B(a,Ye,"radiusY");0>a&&Ca(a,">= zero",Ye,"radiusY");this.u&&ya(this,a);this.Yg=a;this.ta=!0}},startAngle:{configurable:!0,get:function(){return this.qc},set:function(a){this.qc!==a&&(this.u&&ya(this,a),E&&B(a,Ye,"startAngle"),a%=360,0>a&&(a+=360),this.qc=
a,this.ta=!0)}},sweepAngle:{configurable:!0,get:function(){return this.Fc},set:function(a){E&&B(a,Ye,"sweepAngle");this.u&&ya(this,a);360<a&&(a=360);-360>a&&(a=-360);this.Fc=a;this.ta=!0}},isClockwiseArc:{configurable:!0,get:function(){return this.Bk},set:function(a){this.u&&ya(this,a);this.Bk=a;this.ta=!0}},isLargeArc:{configurable:!0,get:function(){return this.fl},set:function(a){this.u&&ya(this,a);this.fl=a;this.ta=!0}},xAxisRotation:{configurable:!0,
get:function(){return this.ve},set:function(a){E&&B(a,Ye,"xAxisRotation");a%=360;0>a&&(a+=360);this.u&&ya(this,a);this.ve=a;this.ta=!0}}});Ye.prototype.equalsApprox=Ye.prototype.Ra;var Ne=new D(Ye,"Move",0),ve=new D(Ye,"Line",1),Oe=new D(Ye,"Bezier",2),Pe=new D(Ye,"QuadraticBezier",3),Qe=new D(Ye,"Arc",4),Re=new D(Ye,"SvgArc",4);Ye.className="PathSegment";Ye.Move=Ne;Ye.Line=ve;Ye.Bezier=Oe;Ye.QuadraticBezier=Pe;Ye.Arc=Qe;Ye.SvgArc=Re;
function kf(){this.G=null;this.Eu=(new J(0,0)).freeze();this.Wt=(new J(0,0)).freeze();this.Qq=this.Wr=0;this.Rq=1;this.Lr="";this.Gs=this.gr=!1;this.fr=this.Tq=0;this.Bg=this.tr=this.Fr=!1;this.mr=null;this.Es=0;this.Td=this.Ds=null}kf.prototype.copy=function(){var a=new kf;return this.clone(a)};
kf.prototype.clone=function(a){a.G=this.G;a.Eu.assign(this.viewPoint);a.Wt.assign(this.documentPoint);a.Wr=this.Wr;a.Qq=this.Qq;a.Rq=this.Rq;a.Lr=this.Lr;a.gr=this.gr;a.Gs=this.Gs;a.Tq=this.Tq;a.fr=this.fr;a.Fr=this.Fr;a.tr=this.tr;a.Bg=this.Bg;a.mr=this.mr;a.Es=this.Es;a.Ds=this.Ds;a.Td=this.Td;return a};
kf.prototype.toString=function(){var a="^";0!==this.modifiers&&(a+="M:"+this.modifiers);0!==this.button&&(a+="B:"+this.button);""!==this.key&&(a+="K:"+this.key);0!==this.clickCount&&(a+="C:"+this.clickCount);0!==this.delta&&(a+="D:"+this.delta);this.handled&&(a+="h");this.bubbles&&(a+="b");null!==this.documentPoint&&(a+="@"+this.documentPoint.toString());return a};kf.prototype.aq=function(a,b){var c=this.diagram;if(null===c)return b;lf(c,this.event,a,b);return b};
kf.prototype.iz=function(a,b){var c=this.diagram;if(null===c)return b;lf(c,this.event,a,b);b.assign(c.Ct(b));return b};
na.Object.defineProperties(kf.prototype,{diagram:{configurable:!0,get:function(){return this.G},set:function(a){this.G=a}},viewPoint:{configurable:!0,get:function(){return this.Eu},set:function(a){w(a,J,kf,"viewPoint");this.Eu.assign(a)}},documentPoint:{configurable:!0,get:function(){return this.Wt},set:function(a){w(a,J,kf,"documentPoint");this.Wt.assign(a)}},modifiers:{configurable:!0,get:function(){return this.Wr},set:function(a){this.Wr=
a}},button:{configurable:!0,get:function(){return this.Qq},set:function(a){this.Qq=a;if(null===this.event)switch(a){case 0:this.buttons=1;break;case 1:this.buttons=4;break;case 2:this.buttons=2}}},buttons:{configurable:!0,get:function(){return this.Rq},set:function(a){this.Rq=a}},key:{configurable:!0,get:function(){return this.Lr},set:function(a){this.Lr=a}},down:{configurable:!0,get:function(){return this.gr},set:function(a){this.gr=a}},up:{configurable:!0,
enumerable:!0,get:function(){return this.Gs},set:function(a){this.Gs=a}},clickCount:{configurable:!0,get:function(){return this.Tq},set:function(a){this.Tq=a}},delta:{configurable:!0,get:function(){return this.fr},set:function(a){this.fr=a}},isMultiTouch:{configurable:!0,get:function(){return this.Fr},set:function(a){this.Fr=a}},handled:{configurable:!0,get:function(){return this.tr},set:function(a){this.tr=a}},bubbles:{configurable:!0,
get:function(){return this.Bg},set:function(a){this.Bg=a}},event:{configurable:!0,get:function(){return this.mr},set:function(a){this.mr=a}},isTouchEvent:{configurable:!0,get:function(){var a=qa.TouchEvent,b=this.event;return a&&b instanceof a?!0:(a=qa.PointerEvent)&&b instanceof a&&("touch"===b.pointerType||"pen"===b.pointerType)}},timestamp:{configurable:!0,get:function(){return this.Es},set:function(a){this.Es=a}},targetDiagram:{configurable:!0,
get:function(){return this.Ds},set:function(a){this.Ds=a}},targetObject:{configurable:!0,get:function(){return this.Td},set:function(a){this.Td=a}},control:{configurable:!0,get:function(){return 0!==(this.modifiers&1)},set:function(a){this.modifiers=a?this.modifiers|1:this.modifiers&-2}},shift:{configurable:!0,get:function(){return 0!==(this.modifiers&4)},set:function(a){this.modifiers=a?this.modifiers|4:this.modifiers&-5}},alt:{configurable:!0,
get:function(){return 0!==(this.modifiers&2)},set:function(a){this.modifiers=a?this.modifiers|2:this.modifiers&-3}},meta:{configurable:!0,get:function(){return 0!==(this.modifiers&8)},set:function(a){this.modifiers=a?this.modifiers|8:this.modifiers&-9}},left:{configurable:!0,get:function(){var a=this.event;return null===a||"mousedown"!==a.type&&"mouseup"!==a.type&&"pointerdown"!==a.type&&"pointerup"!==a.type?0!==(this.buttons&1):0===this.button},set:function(a){this.buttons=
a?this.buttons|1:this.buttons&-2}},right:{configurable:!0,get:function(){var a=this.event;return null===a||"mousedown"!==a.type&&"mouseup"!==a.type&&"pointerdown"!==a.type&&"pointerup"!==a.type?0!==(this.buttons&2):2===this.button},set:function(a){this.buttons=a?this.buttons|2:this.buttons&-3}},middle:{configurable:!0,get:function(){var a=this.event;return null===a||"mousedown"!==a.type&&"mouseup"!==a.type&&"pointerdown"!==a.type&&"pointerup"!==a.type?0!==(this.buttons&
4):1===this.button},set:function(a){this.buttons=a?this.buttons|4:this.buttons&-5}}});kf.prototype.getMultiTouchDocumentPoint=kf.prototype.iz;kf.prototype.getMultiTouchViewPoint=kf.prototype.aq;kf.className="InputEvent";function mf(){this.G=null;this.Va="";this.fs=this.Bs=null}mf.prototype.copy=function(){var a=new mf;a.G=this.G;a.Va=this.Va;a.Bs=this.Bs;a.fs=this.fs;return a};
mf.prototype.toString=function(){var a="*"+this.name;null!==this.subject&&(a+=":"+this.subject.toString());null!==this.parameter&&(a+="("+this.parameter.toString()+")");return a};
na.Object.defineProperties(mf.prototype,{diagram:{configurable:!0,get:function(){return this.G},set:function(a){this.G=a}},name:{configurable:!0,get:function(){return this.Va},set:function(a){this.Va=a}},subject:{configurable:!0,get:function(){return this.Bs},set:function(a){this.Bs=a}},parameter:{configurable:!0,get:function(){return this.fs},set:function(a){this.fs=a}}});mf.className="DiagramEvent";
function nf(){this.Zm=of;this.Cj=this.Vr="";this.Co=this.Do=this.Io=this.Jo=this.Ho=this.G=this.bc=null}nf.prototype.clear=function(){this.Co=this.Do=this.Io=this.Jo=this.Ho=this.G=this.bc=null};
nf.prototype.copy=function(){var a=new nf;a.Zm=this.Zm;a.Vr=this.Vr;a.Cj=this.Cj;a.bc=this.bc;a.G=this.G;a.Ho=this.Ho;var b=this.Jo;a.Jo=Ia(b)&&"function"===typeof b.J?b.J():b;b=this.Io;a.Io=Ia(b)&&"function"===typeof b.J?b.J():b;b=this.Do;a.Do=Ia(b)&&"function"===typeof b.J?b.J():b;b=this.Co;a.Co=Ia(b)&&"function"===typeof b.J?b.J():b;return a};nf.prototype.ib=function(a){a.classType===nf?this.change=a:Fa(this,a)};
nf.prototype.toString=function(){var a="";a=this.change===pf?a+"* ":this.change===of?a+(null!==this.model?"!m":"!d"):a+((null!==this.model?"!m":"!d")+this.change);this.propertyName&&"string"===typeof this.propertyName&&(a+=" "+this.propertyName);this.modelChange&&this.modelChange!==this.propertyName&&(a+=" "+this.modelChange);a+=": ";this.change===pf?null!==this.oldValue&&(a+=" "+this.oldValue):(null!==this.object&&(a+=Wa(this.object)),null!==this.oldValue&&(a+="  old: "+Wa(this.oldValue)),null!==
this.oldParam&&(a+=" "+this.oldParam),null!==this.newValue&&(a+="  new: "+Wa(this.newValue)),null!==this.newParam&&(a+=" "+this.newParam));return a};nf.prototype.K=function(a){return a?this.oldValue:this.newValue};nf.prototype.kz=function(a){return a?this.oldParam:this.newParam};nf.prototype.canUndo=function(){return null!==this.model||null!==this.diagram?!0:!1};nf.prototype.undo=function(){this.canUndo()&&(null!==this.model?this.model.Pj(this,!0):null!==this.diagram&&this.diagram.Pj(this,!0))};
nf.prototype.canRedo=function(){return null!==this.model||null!==this.diagram?!0:!1};nf.prototype.redo=function(){this.canRedo()&&(null!==this.model?this.model.Pj(this,!1):null!==this.diagram&&this.diagram.Pj(this,!1))};
na.Object.defineProperties(nf.prototype,{model:{configurable:!0,get:function(){return this.bc},set:function(a){this.bc=a}},diagram:{configurable:!0,get:function(){return this.G},set:function(a){this.G=a}},change:{configurable:!0,get:function(){return this.Zm},set:function(a){E&&tb(a,nf,nf,"change");this.Zm=a}},modelChange:{configurable:!0,get:function(){return this.Vr},set:function(a){E&&z(a,"string",nf,"modelChange");this.Vr=a}},propertyName:{configurable:!0,
enumerable:!0,get:function(){return this.Cj},set:function(a){E&&"string"!==typeof a&&z(a,"function",nf,"propertyName");this.Cj=a}},isTransactionFinished:{configurable:!0,get:function(){return this.Zm===pf&&("CommittedTransaction"===this.Cj||"FinishedUndo"===this.Cj||"FinishedRedo"===this.Cj)}},object:{configurable:!0,get:function(){return this.Ho},set:function(a){this.Ho=a}},oldValue:{configurable:!0,get:function(){return this.Jo},set:function(a){this.Jo=
a}},oldParam:{configurable:!0,get:function(){return this.Io},set:function(a){this.Io=a}},newValue:{configurable:!0,get:function(){return this.Do},set:function(a){this.Do=a}},newParam:{configurable:!0,get:function(){return this.Co},set:function(a){this.Co=a}}});nf.prototype.redo=nf.prototype.redo;nf.prototype.canRedo=nf.prototype.canRedo;nf.prototype.undo=nf.prototype.undo;nf.prototype.canUndo=nf.prototype.canUndo;nf.prototype.getParam=nf.prototype.kz;
nf.prototype.getValue=nf.prototype.K;nf.prototype.clear=nf.prototype.clear;var pf=new D(nf,"Transaction",-1),of=new D(nf,"Property",0),qf=new D(nf,"Insert",1),rf=new D(nf,"Remove",2);nf.className="ChangedEvent";nf.Transaction=pf;nf.Property=of;nf.Insert=qf;nf.Remove=rf;function sf(){this.w=(new G).freeze();this.Va="";this.l=!1}
sf.prototype.toString=function(a){var b="Transaction: "+this.name+" "+this.changes.count.toString()+(this.isComplete?"":", incomplete");if(void 0!==a&&0<a){a=this.changes.count;for(var c=0;c<a;c++){var d=this.changes.O(c);null!==d&&(b+="\n  "+d.toString())}}return b};sf.prototype.clear=function(){var a=this.changes;a.ja();for(var b=a.count-1;0<=b;b--){var c=a.O(b);null!==c&&c.clear()}a.clear();a.freeze()};sf.prototype.canUndo=function(){return this.isComplete};
sf.prototype.undo=function(){if(this.canUndo())for(var a=this.changes.count-1;0<=a;a--){var b=this.changes.O(a);null!==b&&b.undo()}};sf.prototype.canRedo=function(){return this.isComplete};sf.prototype.redo=function(){if(this.canRedo())for(var a=this.changes.count,b=0;b<a;b++){var c=this.changes.O(b);null!==c&&c.redo()}};
na.Object.defineProperties(sf.prototype,{changes:{configurable:!0,get:function(){return this.w}},name:{configurable:!0,get:function(){return this.Va},set:function(a){this.Va=a}},isComplete:{configurable:!0,get:function(){return this.l},set:function(a){this.l=a}}});sf.prototype.redo=sf.prototype.redo;sf.prototype.canRedo=sf.prototype.canRedo;sf.prototype.undo=sf.prototype.undo;sf.prototype.canUndo=sf.prototype.canUndo;sf.prototype.clear=sf.prototype.clear;
sf.className="Transaction";function tf(){this.mu=new H;this.Hc=!1;this.L=(new G).freeze();this.ie=-1;this.w=999;this.le=!1;this.dr=null;this.xi=0;this.l=!1;E&&(this.l=!0);this.se=(new G).freeze();this.pl=new G;this.cu=!0;this.fu=!1}t=tf.prototype;
t.toString=function(a){var b="UndoManager "+this.historyIndex+"<"+this.history.count+"<="+this.maxHistoryLength;b+="[";for(var c=this.nestedTransactionNames.count,d=0;d<c;d++)0<d&&(b+=" "),b+=this.nestedTransactionNames.O(d);b+="]";if(void 0!==a&&0<a)for(c=this.history.count,d=0;d<c;d++)b+="\n "+this.history.O(d).toString(a-1);return b};
t.clear=function(){var a=this.history;a.ja();for(var b=a.count-1;0<=b;b--){var c=a.O(b);null!==c&&c.clear()}a.clear();this.ie=-1;a.freeze();this.le=!1;this.dr=null;this.xi=0;this.se.ja();this.se.clear();this.se.freeze();this.pl.clear()};t.Uw=function(a){this.mu.add(a)};t.Fx=function(a){this.mu.remove(a)};
t.Ca=function(a){void 0===a&&(a="");null===a&&(a="");if(this.isUndoingRedoing)return!1;!0===this.cu&&(this.cu=!1,this.xi++,this.Ab("StartingFirstTransaction",a,this.currentTransaction),0<this.xi&&this.xi--);this.isEnabled&&(this.se.ja(),this.se.add(a),this.se.freeze(),null===this.currentTransaction?this.pl.add(0):this.pl.add(this.currentTransaction.changes.count));this.xi++;var b=1===this.transactionLevel;b&&this.Ab("StartedTransaction",a,this.currentTransaction);return b};
t.bb=function(a){void 0===a&&(a="");return uf(this,!0,a)};t.vf=function(){return uf(this,!1,"")};
function uf(a,b,c){if(a.isUndoingRedoing)return!1;a.checksTransactionLevel&&1>a.transactionLevel&&Ga("Ending transaction without having started a transaction: "+c);var d=1===a.transactionLevel;d&&b&&a.Ab("CommittingTransaction",c,a.currentTransaction);var e=0;if(0<a.transactionLevel&&(a.xi--,a.isEnabled)){var f=a.se.count;0<f&&(""===c&&(c=a.se.O(0)),a.se.ja(),a.se.nb(f-1),a.se.freeze());f=a.pl.count;0<f&&(e=a.pl.O(f-1),a.pl.nb(f-1))}f=a.currentTransaction;if(d){if(b){a.fu=!1;if(a.isEnabled&&null!==
f){b=f;b.isComplete=!0;b.name=c;d=a.history;d.ja();for(e=d.count-1;e>a.historyIndex;e--)f=d.O(e),null!==f&&f.clear(),d.nb(e),a.fu=!0;e=a.maxHistoryLength;0===e&&(e=1);0<e&&d.count>=e&&(e=d.O(0),null!==e&&e.clear(),d.nb(0),a.ie--);d.add(b);a.ie++;d.freeze();f=b}a.Ab("CommittedTransaction",c,f)}else{a.le=!0;try{a.isEnabled&&null!==f&&(f.isComplete=!0,f.undo())}finally{a.Ab("RolledBackTransaction",c,f),a.le=!1}null!==f&&f.clear()}a.dr=null;return!0}if(a.isEnabled&&!b&&null!==f){a=e;c=f.changes;for(b=
c.count-1;b>=a;b--)d=c.O(b),null!==d&&d.undo(),c.ja(),c.nb(b);c.freeze()}return!1}tf.prototype.canUndo=function(){if(!this.isEnabled||0<this.transactionLevel)return!1;var a=this.transactionToUndo;return null!==a&&a.canUndo()?!0:!1};tf.prototype.undo=function(){if(this.canUndo()){var a=this.transactionToUndo;try{this.le=!0,this.Ab("StartingUndo","Undo",a),this.ie--,a.undo()}catch(b){Ga("undo error: "+b.toString())}finally{this.Ab("FinishedUndo","Undo",a),this.le=!1}}};
tf.prototype.canRedo=function(){if(!this.isEnabled||0<this.transactionLevel)return!1;var a=this.transactionToRedo;return null!==a&&a.canRedo()?!0:!1};tf.prototype.redo=function(){if(this.canRedo()){var a=this.transactionToRedo;try{this.le=!0,this.Ab("StartingRedo","Redo",a),this.ie++,a.redo()}catch(b){Ga("redo error: "+b.toString())}finally{this.Ab("FinishedRedo","Redo",a),this.le=!1}}};
tf.prototype.Ab=function(a,b,c){void 0===c&&(c=null);var d=new nf;d.change=pf;d.propertyName=a;d.object=c;d.oldValue=b;for(a=this.models;a.next();)b=a.value,d.model=b,b.Ms(d)};
tf.prototype.hv=function(a){if(this.isEnabled&&!this.isUndoingRedoing&&!this.skipsEvent(a)){var b=this.currentTransaction;null===b&&(this.dr=b=new sf);var c=a.copy();b=b.changes;b.ja();b.add(c);b.freeze();this.checksTransactionLevel&&0>=this.transactionLevel&&!this.cu&&(a=a.diagram,null!==a&&!1===a.Ni||Ga("Change not within a transaction: "+c.toString()))}};
tf.prototype.skipsEvent=function(a){if(null===a||0>a.change.value)return!0;a=a.object;if(void 0!==a.layer){if(a=a.layer,null!==a&&a.isTemporary)return!0}else if(a.isTemporary)return!0;return!1};
na.Object.defineProperties(tf.prototype,{models:{configurable:!0,get:function(){return this.mu.iterator}},isEnabled:{configurable:!0,get:function(){return this.Hc},set:function(a){this.Hc=a}},transactionToUndo:{configurable:!0,get:function(){return 0<=this.historyIndex&&this.historyIndex<=this.history.count-1?this.history.O(this.historyIndex):null}},transactionToRedo:{configurable:!0,get:function(){return this.historyIndex<this.history.count-
1?this.history.O(this.historyIndex+1):null}},isUndoingRedoing:{configurable:!0,get:function(){return this.le}},history:{configurable:!0,get:function(){return this.L}},maxHistoryLength:{configurable:!0,get:function(){return this.w},set:function(a){this.w=a}},historyIndex:{configurable:!0,get:function(){return this.ie}},currentTransaction:{configurable:!0,get:function(){return this.dr}},transactionLevel:{configurable:!0,
get:function(){return this.xi}},isInTransaction:{configurable:!0,get:function(){return 0<this.xi}},checksTransactionLevel:{configurable:!0,get:function(){return this.l},set:function(a){this.l=a}},nestedTransactionNames:{configurable:!0,get:function(){return this.se}}});tf.prototype.handleChanged=tf.prototype.hv;tf.prototype.redo=tf.prototype.redo;tf.prototype.undo=tf.prototype.undo;tf.prototype.canUndo=tf.prototype.canUndo;
tf.prototype.rollbackTransaction=tf.prototype.vf;tf.prototype.commitTransaction=tf.prototype.bb;tf.prototype.startTransaction=tf.prototype.Ca;tf.prototype.removeModel=tf.prototype.Fx;tf.prototype.addModel=tf.prototype.Uw;tf.prototype.clear=tf.prototype.clear;tf.className="UndoManager";function vf(){0<arguments.length&&Da(vf);rb(this);this.G=yf;this.Va="";this.Hc=!0;this.Wb=!1;this.fw=null;this.hy=new kf;this.Js=-1}vf.prototype.ob=function(a){this.G=a};
vf.prototype.toString=function(){return""!==this.name?this.name+" Tool":Va(this.constructor)};vf.prototype.updateAdornments=function(){};vf.prototype.canStart=function(){return this.isEnabled};vf.prototype.doStart=function(){};vf.prototype.doActivate=function(){this.isActive=!0};vf.prototype.doDeactivate=function(){this.isActive=!1};vf.prototype.doStop=function(){};vf.prototype.doCancel=function(){this.transactionResult=null;this.stopTool()};
vf.prototype.stopTool=function(){var a=this.diagram;a.currentTool===this&&(a.currentTool=null,a.currentCursor="")};vf.prototype.doMouseDown=function(){!this.isActive&&this.canStart()&&this.doActivate()};vf.prototype.doMouseMove=function(){};vf.prototype.doMouseUp=function(){this.stopTool()};vf.prototype.doMouseWheel=function(){};vf.prototype.canStartMultiTouch=function(){return!0};
vf.prototype.standardPinchZoomStart=function(){var a=this.diagram,b=a.lastInput,c=b.aq(0,J.allocAt(NaN,NaN)),d=b.aq(1,J.allocAt(NaN,NaN));if(c.o()&&d.o()&&(this.doCancel(),a.dm("hasGestureZoom"))){a.Ko=a.scale;var e=d.x-c.x,f=d.y-c.y;a.Kw=Math.sqrt(e*e+f*f);b.bubbles=!1}J.free(c);J.free(d)};
vf.prototype.standardPinchZoomMove=function(){var a=this.diagram,b=a.lastInput,c=b.aq(0,J.allocAt(NaN,NaN)),d=b.aq(1,J.allocAt(NaN,NaN));if(c.o()&&d.o()&&(this.doCancel(),a.dm("hasGestureZoom"))){var e=d.x-c.x,f=d.y-c.y;f=Math.sqrt(e*e+f*f)/a.Kw;e=new J((Math.min(d.x,c.x)+Math.max(d.x,c.x))/2,(Math.min(d.y,c.y)+Math.max(d.y,c.y))/2);f*=a.Ko;var g=a.commandHandler;if(f!==a.scale&&g.canResetZoom(f)){var h=a.zoomPoint;a.zoomPoint=e;g.resetZoom(f);a.zoomPoint=h}b.bubbles=!1}J.free(c);J.free(d)};
vf.prototype.doKeyDown=function(){"Esc"===this.diagram.lastInput.key&&this.doCancel()};vf.prototype.doKeyUp=function(){};vf.prototype.Ca=function(a){void 0===a&&(a=this.name);this.transactionResult=null;return this.diagram.Ca(a)};vf.prototype.wg=function(){var a=this.diagram;return null===this.transactionResult?a.vf():a.bb(this.transactionResult)};
vf.prototype.standardMouseSelect=function(){var a=this.diagram;if(a.allowSelect){var b=a.lastInput,c=a.bm(b.documentPoint,!1);if(null!==c)if(kb?b.meta:b.control){a.ba("ChangingSelection",a.selection);for(b=c;null!==b&&!b.canSelect();)b=b.containingGroup;null!==b&&(b.isSelected=!b.isSelected);a.ba("ChangedSelection",a.selection)}else if(b.shift){if(!c.isSelected){a.ba("ChangingSelection",a.selection);for(b=c;null!==b&&!b.canSelect();)b=b.containingGroup;null!==b&&(b.isSelected=!0);a.ba("ChangedSelection",
a.selection)}}else{if(!c.isSelected){for(b=c;null!==b&&!b.canSelect();)b=b.containingGroup;null!==b&&a.select(b)}}else!b.left||(kb?b.meta:b.control)||b.shift||a.Ns()}};vf.prototype.standardMouseClick=function(a,b){void 0===a&&(a=null);void 0===b&&(b=function(a){return!a.layer.isTemporary});var c=this.diagram,d=c.lastInput;a=c.Tb(d.documentPoint,a,b);d.targetObject=a;zf(a,d,c);return d.handled};
function zf(a,b,c){b.handled=!1;if(null===a||a.sg()){var d=0;b.left?d=1===b.clickCount?1:2===b.clickCount?2:1:b.right&&1===b.clickCount&&(d=3);var e="ObjectSingleClicked";if(null!==a){switch(d){case 1:e="ObjectSingleClicked";break;case 2:e="ObjectDoubleClicked";break;case 3:e="ObjectContextClicked"}0!==d&&c.ba(e,a)}else{switch(d){case 1:e="BackgroundSingleClicked";break;case 2:e="BackgroundDoubleClicked";break;case 3:e="BackgroundContextClicked"}0!==d&&c.ba(e)}if(null!==a)for(;null!==a;){c=null;switch(d){case 1:c=
a.click;break;case 2:c=a.doubleClick?a.doubleClick:a.click;break;case 3:c=a.contextClick}if(null!==c&&(c(b,a),b.handled))break;a=a.panel}else{a=null;switch(d){case 1:a=c.click;break;case 2:a=c.doubleClick?c.doubleClick:c.click;break;case 3:a=c.contextClick}null!==a&&a(b)}}}
vf.prototype.standardMouseOver=function(){var a=this.diagram,b=a.lastInput;if(!0!==a.animationManager.tb){var c=a.skipsUndoManager;a.skipsUndoManager=!0;var d=a.ke?a.Tb(b.documentPoint,null,null):null;b.targetObject=d;var e=!1;if(d!==a.Gk){var f=a.Gk,g=f;a.Gk=d;this.doCurrentObjectChanged(f,d);for(b.handled=!1;null!==f;){var h=f.mouseLeave;if(null!==h){if(d===f)break;if(null!==d&&d.rg(f))break;h(b,f,d);e=!0;if(b.handled)break}f=f.panel}f=g;for(b.handled=!1;null!==d;){g=d.mouseEnter;if(null!==g){if(f===
d)break;if(null!==f&&f.rg(d))break;g(b,d,f);e=!0;if(b.handled)break}d=d.panel}d=a.Gk}if(null!==d){f=d;for(g="";null!==f;){g=f.cursor;if(""!==g)break;f=f.panel}a.currentCursor=g;b.handled=!1;for(f=d;null!==f;){d=f.mouseOver;if(null!==d&&(d(b,f),e=!0,b.handled))break;f=f.panel}}else a.currentCursor="",d=a.mouseOver,null!==d&&(d(b),e=!0);e&&a.gc();a.skipsUndoManager=c}};vf.prototype.doCurrentObjectChanged=function(){};
vf.prototype.standardMouseWheel=function(){var a=this.diagram,b=a.lastInput,c=b.delta;if(0!==c&&a.documentBounds.o()){var d=a.commandHandler,e=a.toolManager.mouseWheelBehavior;if(null!==d&&(e===Af&&!b.shift||e===Bf&&b.control)&&(0<c?d.canIncreaseZoom():d.canDecreaseZoom()))e=a.zoomPoint,a.zoomPoint=b.viewPoint,0<c?d.increaseZoom():d.decreaseZoom(),a.zoomPoint=e,b.bubbles=!1;else if(e===Af&&b.shift||e===Bf&&!b.control){d=a.position.copy();var f=0<c?c:-c,g=b.event,h=g.deltaMode;e=g.deltaX;g=g.deltaY;
if(gb||ib||jb)h=1,0<e&&(e=3),0>e&&(e=-3),0<g&&(g=3),0>g&&(g=-3);if(void 0===h||void 0===e||void 0===g||0===e&&0===g||b.shift)!b.shift&&a.allowVerticalScroll?(f=3*f*a.scrollVerticalLineChange,0<c?a.scroll("pixel","up",f):a.scroll("pixel","down",f)):b.shift&&a.allowHorizontalScroll&&(f=3*f*a.scrollHorizontalLineChange,0<c?a.scroll("pixel","left",f):a.scroll("pixel","right",f));else{switch(h){case 0:c="pixel";break;case 1:c="line";break;case 2:c="page";break;default:c="pixel"}0!==e&&a.allowHorizontalScroll&&
(0<e?a.scroll(c,"left",-e):a.scroll(c,"right",e));0!==g&&a.allowVerticalScroll&&(0<g?a.scroll(c,"up",-g):a.scroll(c,"down",g))}a.position.A(d)||(b.bubbles=!1)}}};vf.prototype.standardWaitAfter=function(a,b){E&&z(a,"number",vf,"standardWaitAfter:delay");void 0===b&&(b=this.diagram.lastInput);this.cancelWaitAfter();var c=this,d=b.clone(this.hy);this.Js=wa(function(){c.doWaitAfter(d)},a)};vf.prototype.cancelWaitAfter=function(){-1!==this.Js&&qa.clearTimeout(this.Js);this.Js=-1};
vf.prototype.doWaitAfter=function(){};vf.prototype.findToolHandleAt=function(a,b){a=this.diagram.Tb(a,function(a){for(;null!==a&&!(a.panel instanceof Cf);)a=a.panel;return a});return null===a?null:a.part.category===b?a:null};vf.prototype.isBeyondDragSize=function(a,b){var c=this.diagram;void 0===a&&(a=c.firstInput.viewPoint);void 0===b&&(b=c.lastInput.viewPoint);var d=c.toolManager.dragSize,e=d.width;d=d.height;c.firstInput.isTouchEvent&&(e+=6,d+=6);return Math.abs(b.x-a.x)>e||Math.abs(b.y-a.y)>d};
na.Object.defineProperties(vf.prototype,{diagram:{configurable:!0,get:function(){return this.G},set:function(a){a instanceof P&&(this.G=a)}},name:{configurable:!0,get:function(){return this.Va},set:function(a){z(a,"string",vf,"name");this.Va=a}},isEnabled:{configurable:!0,get:function(){return this.Hc},set:function(a){z(a,"boolean",vf,"isEnabled");this.Hc=a}},isActive:{configurable:!0,get:function(){return this.Wb},set:function(a){z(a,"boolean",
vf,"isActive");this.Wb=a}},transactionResult:{configurable:!0,get:function(){return this.fw},set:function(a){null!==a&&z(a,"string",vf,"transactionResult");this.fw=a}}});vf.prototype.stopTransaction=vf.prototype.wg;vf.prototype.startTransaction=vf.prototype.Ca;vf.className="Tool";function $a(){vf.call(this);this.name="ToolManager";this.Oc=new G;this.Pc=new G;this.xg=new G;this.ea=this.Ma=850;this.w=(new Zb(2,2)).ia();this.Xb=5E3;this.Xa=Bf;this.L=Df;this.cr=this.l=null;this.Ij=-1}
ma($a,vf);$a.prototype.initializeStandardTools=function(){};$a.prototype.updateAdornments=function(a){var b=this.currentToolTip;if(b instanceof Cf&&this.cr===a){var c=b.adornedObject;(null!==a?c.part===a:null===c)?this.showToolTip(b,c):this.hideToolTip()}};
$a.prototype.doMouseDown=function(){var a=this.diagram,b=a.lastInput;b.isTouchEvent&&this.gestureBehavior===Ef&&(b.bubbles=!1);if(b.isMultiTouch){this.cancelWaitAfter();if(this.gestureBehavior===Ff){b.bubbles=!0;return}if(this.gestureBehavior===Ef)return;if(a.currentTool.canStartMultiTouch()){a.currentTool.standardPinchZoomStart();return}}var c=a.undoManager;E&&c.checksTransactionLevel&&0!==c.transactionLevel&&Ga("WARNING: In ToolManager.doMouseDown: UndoManager.transactionLevel is not zero");c=this.mouseDownTools.length;
for(var d=0;d<c;d++){var e=this.mouseDownTools.O(d);e.ob(this.diagram);if(e.canStart()){a.doFocus();a.currentTool=e;a.currentTool===e&&(e.isActive||e.doActivate(),e.doMouseDown());return}}1===a.lastInput.button&&(this.mouseWheelBehavior===Bf?this.mouseWheelBehavior=Af:this.mouseWheelBehavior===Af&&(this.mouseWheelBehavior=Bf));this.doActivate();this.standardWaitAfter(this.holdDelay,b)};
$a.prototype.doMouseMove=function(){var a=this.diagram,b=a.lastInput;if(b.isMultiTouch){if(this.gestureBehavior===Ff){b.bubbles=!0;return}if(this.gestureBehavior===Ef)return;if(a.currentTool.canStartMultiTouch()){a.currentTool.standardPinchZoomMove();return}}if(this.isActive)for(var c=this.mouseMoveTools.length,d=0;d<c;d++){var e=this.mouseMoveTools.O(d);e.ob(this.diagram);if(e.canStart()){a.doFocus();a.currentTool=e;a.currentTool===e&&(e.isActive||e.doActivate(),e.doMouseMove());return}}Gf(this,
a);a=b.event;null===a||"mousemove"!==a.type&&"pointermove"!==a.type&&a.cancelable||(b.bubbles=!0)};function Gf(a,b){a.standardMouseOver();a.isBeyondDragSize()&&a.standardWaitAfter(a.isActive?a.holdDelay:a.hoverDelay,b.lastInput)}$a.prototype.doCurrentObjectChanged=function(a,b){a=this.currentToolTip;null===a||null!==b&&a instanceof Cf&&(b===a||b.rg(a))||this.hideToolTip()};
$a.prototype.doWaitAfter=function(a){var b=this.diagram;b.Ea&&(this.doMouseHover(),this.isActive||this.doToolTip(),a.isTouchEvent&&!b.lastInput.handled&&(a=a.copy(),a.button=2,a.buttons=2,b.lastInput=a,b.Nl=!0,b.doMouseUp()))};
$a.prototype.doMouseHover=function(){var a=this.diagram,b=a.lastInput;null===b.targetObject&&(b.targetObject=a.Tb(b.documentPoint,null,null));var c=b.targetObject;if(null!==c)for(b.handled=!1;null!==c;){a=this.isActive?c.mouseHold:c.mouseHover;if(null!==a&&(a(b,c),b.handled))break;c=c.panel}else c=this.isActive?a.mouseHold:a.mouseHover,null!==c&&c(b)};
$a.prototype.doToolTip=function(){var a=this.diagram,b=a.lastInput;null===b.targetObject&&(b.targetObject=a.Tb(b.documentPoint,null,null));b=b.targetObject;if(null!==b){if(a=this.currentToolTip,!(a instanceof Cf)||b!==a&&!b.rg(a)){for(;null!==b;){a=b.toolTip;if(null!==a){this.showToolTip(a,b);return}b=b.panel}this.hideToolTip()}}else b=a.toolTip,null!==b?this.showToolTip(b,null):this.hideToolTip()};
$a.prototype.showToolTip=function(a,b){!E||a instanceof Cf||a instanceof Hf||v("showToolTip:tooltip must be an Adornment or HTMLInfo.");null!==b&&w(b,N,$a,"showToolTip:obj");var c=this.diagram;a!==this.currentToolTip&&this.hideToolTip();if(a instanceof Cf){a.layerName="Tool";a.selectable=!1;a.scale=1/c.scale;a.category="ToolTip";null!==a.placeholder&&(a.placeholder.scale=c.scale);var d=a.diagram;null!==d&&d!==c&&d.remove(a);c.add(a);null!==b?(c=null,d=b.th(),null!==d&&(c=d.data),a.adornedObject=b,
a.data=c):a.data=c.model;a.dc();this.positionToolTip(a,b)}else a instanceof Hf&&a!==this.currentToolTip&&a.show(b,c,this);this.currentToolTip=a;-1!==this.Ij&&(qa.clearTimeout(this.Ij),this.Ij=-1);a=this.toolTipDuration;if(0<a&&Infinity!==a){var e=this;this.Ij=wa(function(){e.hideToolTip()},a)}};
$a.prototype.positionToolTip=function(a){if(null===a.placeholder){var b=this.diagram,c=b.lastInput.documentPoint.copy(),d=a.measuredBounds,e=b.viewportBounds;b.lastInput.isTouchEvent&&(c.x-=d.width);c.x+d.width>e.right&&(c.x-=d.width+5/b.scale);c.x<e.x&&(c.x=e.x);c.y=c.y+20/b.scale+d.height>e.bottom?c.y-(d.height+5/b.scale):c.y+20/b.scale;c.y<e.y&&(c.y=e.y);a.position=c}};
$a.prototype.hideToolTip=function(){-1!==this.Ij&&(qa.clearTimeout(this.Ij),this.Ij=-1);var a=this.diagram,b=this.currentToolTip;null!==b&&(b instanceof Cf?(a.remove(b),null!==this.cr&&this.cr.uf(b.category),b.data=null,b.adornedObject=null):b instanceof Hf&&null!==b.hide&&b.hide(a,this),this.currentToolTip=null)};
$a.prototype.doMouseUp=function(){this.cancelWaitAfter();var a=this.diagram;if(this.isActive)for(var b=this.mouseUpTools.length,c=0;c<b;c++){var d=this.mouseUpTools.O(c);d.ob(this.diagram);if(d.canStart()){a.doFocus();a.currentTool=d;a.currentTool===d&&(d.isActive||d.doActivate(),d.doMouseUp());return}}a.doFocus();this.doDeactivate()};$a.prototype.doMouseWheel=function(){this.standardMouseWheel()};$a.prototype.doKeyDown=function(){var a=this.diagram;null!==a.commandHandler&&a.commandHandler.doKeyDown()};
$a.prototype.doKeyUp=function(){var a=this.diagram;null!==a.commandHandler&&a.commandHandler.doKeyUp()};$a.prototype.findTool=function(a){z(a,"string",$a,"findTool:name");for(var b=this.mouseDownTools.length,c=0;c<b;c++){var d=this.mouseDownTools.O(c);if(d.name===a)return d}b=this.mouseMoveTools.length;for(c=0;c<b;c++)if(d=this.mouseMoveTools.O(c),d.name===a)return d;b=this.mouseUpTools.length;for(c=0;c<b;c++)if(d=this.mouseUpTools.O(c),d.name===a)return d;return null};
$a.prototype.replaceTool=function(a,b){z(a,"string",$a,"replaceTool:name");null!==b&&(w(b,vf,$a,"replaceTool:newtool"),b.ob(this.diagram));for(var c=this.mouseDownTools.length,d=0;d<c;d++){var e=this.mouseDownTools.O(d);if(e.name===a)return null!==b?this.mouseDownTools.ld(d,b):this.mouseDownTools.nb(d),e}c=this.mouseMoveTools.length;for(d=0;d<c;d++)if(e=this.mouseMoveTools.O(d),e.name===a)return null!==b?this.mouseMoveTools.ld(d,b):this.mouseMoveTools.nb(d),e;c=this.mouseUpTools.length;for(d=0;d<
c;d++)if(e=this.mouseUpTools.O(d),e.name===a)return null!==b?this.mouseUpTools.ld(d,b):this.mouseUpTools.nb(d),e;return null};function If(a,b,c,d){z(b,"string",$a,"replaceStandardTool:name");w(d,G,$a,"replaceStandardTool:list");null!==c&&(w(c,vf,$a,"replaceStandardTool:newtool"),c.name=b,c.ob(a.diagram));a.findTool(b)?a.replaceTool(b,c):null!==c&&d.add(c)}
na.Object.defineProperties($a.prototype,{mouseWheelBehavior:{configurable:!0,get:function(){return this.Xa},set:function(a){tb(a,$a,$a,"mouseWheelBehavior");this.Xa=a}},gestureBehavior:{configurable:!0,get:function(){return this.L},set:function(a){tb(a,$a,$a,"gestureBehavior");this.L=a}},currentToolTip:{configurable:!0,get:function(){return this.l},set:function(a){!E||null===a||a instanceof Cf||a instanceof Hf||v("ToolManager.currentToolTip must be an Adornment or HTMLInfo.");
this.l=a;this.cr=null!==a&&a instanceof Cf?a.adornedPart:null}},mouseDownTools:{configurable:!0,get:function(){return this.Oc}},mouseMoveTools:{configurable:!0,get:function(){return this.Pc}},mouseUpTools:{configurable:!0,get:function(){return this.xg}},hoverDelay:{configurable:!0,get:function(){return this.Ma},set:function(a){z(a,"number",$a,"hoverDelay");this.Ma=a}},holdDelay:{configurable:!0,get:function(){return this.ea},set:function(a){z(a,
"number",$a,"holdDelay");this.ea=a}},dragSize:{configurable:!0,get:function(){return this.w},set:function(a){w(a,Zb,$a,"dragSize");this.w=a.J()}},toolTipDuration:{configurable:!0,get:function(){return this.Xb},set:function(a){z(a,"number",$a,"toolTipDuration");this.Xb=a}}});var Bf=new D($a,"WheelScroll",0),Af=new D($a,"WheelZoom",1),Jf=new D($a,"WheelNone",2),Df=new D($a,"GestureZoom",3),Ef=new D($a,"GestureCancel",4),Ff=new D($a,"GestureNone",5);$a.className="ToolManager";
$a.WheelScroll=Bf;$a.WheelZoom=Af;$a.WheelNone=Jf;$a.GestureZoom=Df;$a.GestureCancel=Ef;$a.GestureNone=Ff;function Kf(){vf.call(this);0<arguments.length&&Da(Kf);this.name="Dragging";this.L=this.Oc=!0;this.w=this.Xa=this.ea=this.cg=null;this.Bn=this.Pc=!1;this.Gl=new J(NaN,NaN);this.zs=new J;this.Xb=!0;this.Nk=100;this.Ig=[];this.xg=(new H).freeze();this.Ma=new Lf}ma(Kf,vf);
Kf.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(a.isReadOnly&&!a.allowDragOut||!a.allowMove&&!a.allowCopy&&!a.allowDragOut||!a.allowSelect)return!1;var b=a.lastInput;return!b.left||a.currentTool!==this&&(!this.isBeyondDragSize()||b.isTouchEvent&&b.timestamp-a.firstInput.timestamp<this.Nk)?!1:null!==this.findDraggablePart()};
Kf.prototype.findDraggablePart=function(){var a=this.diagram;a=a.bm(a.firstInput.documentPoint,!1);if(null===a)return null;for(;null!==a&&!a.canSelect();)a=a.containingGroup;return null!==a&&(a.canMove()||a.canCopy())?a:null};
Kf.prototype.standardMouseSelect=function(){var a=this.diagram;if(a.allowSelect){var b=a.bm(a.firstInput.documentPoint,!1);if(null!==b){for(;null!==b&&!b.canSelect();)b=b.containingGroup;this.currentPart=b;null===this.currentPart||this.currentPart.isSelected||(a.ba("ChangingSelection",a.selection),b=a.lastInput,(kb?b.meta:b.control)||b.shift||Mf(a),this.currentPart.isSelected=!0,a.ba("ChangedSelection",a.selection))}}};
Kf.prototype.doActivate=function(){var a=this.diagram;null===this.currentPart&&this.standardMouseSelect();var b=this.currentPart;null!==b&&(b.canMove()||b.canCopy())&&(Nf=null,this.isActive=!0,this.Gl.set(a.position),Of(this,a.selection),this.Ig.length=0,this.draggedParts=this.computeEffectiveCollection(a.selection,this.dragOptions),a.Ti=!0,!0===a.Ge("temporaryPixelRatio")&&30<a.gu&&(a.ye=1),Yf(a,this.draggedParts),this.Ca("Drag"),this.startPoint=a.firstInput.documentPoint,a.isMouseCaptured=!0,a.allowDragOut&&
(this.isDragOutStarted=!0,this.Bn=!1,Nf=this,Zf=this.diagram,this.doSimulatedDragOut()))};function Of(a,b){if(a.dragsLink){var c=a.diagram;c.allowRelink&&(c.model.bk()&&1===b.count&&b.first()instanceof Q?(a.draggedLink=b.first(),a.draggedLink.canRelinkFrom()&&a.draggedLink.canRelinkTo()&&a.draggedLink.Qj(),a.cg=c.toolManager.findTool("Relinking"),null===a.cg&&(a.cg=new $f,a.cg.ob(c))):(a.draggedLink=null,a.cg=null))}}
Kf.prototype.computeEffectiveCollection=function(a,b){return this.diagram.commandHandler.computeEffectiveCollection(a,b)};Kf.prototype.td=function(a){return void 0===a?new ag(gc):this.isGridSnapEnabled?new ag(new J(Math.round(a.x),Math.round(a.y))):new ag(a.copy())};
Kf.prototype.doDeactivate=function(){this.isActive=!1;var a=this.diagram;a.wf();bg(this);cg(a,this.draggedParts);this.draggedParts=this.currentPart=null;this.Bn=this.isDragOutStarted=!1;if(0<dg.count){for(var b=dg,c=b.length,d=0;d<c;d++){var e=b.O(d);eg(e);fg(e);bg(e);e.diagram.wf()}b.clear()}eg(this);this.Gl.h(NaN,NaN);Nf=Zf=null;fg(this);a.isMouseCaptured=!1;a.currentCursor="";a.Ti=!1;this.wg();gg(a,!0)};
function bg(a){var b=a.diagram,c=b.skipsUndoManager;b.skipsUndoManager=!0;hg(a,b.lastInput,null);b.skipsUndoManager=c;a.Ig.length=0}function ig(){var a=Nf;fg(a);jg(a);var b=a.diagram;a.Gl.o()&&(b.position=a.Gl);b.wf()}Kf.prototype.doCancel=function(){fg(this);jg(this);var a=this.diagram;this.Gl.o()&&(a.position=this.Gl);this.stopTool()};Kf.prototype.doKeyDown=function(){this.isActive&&("Esc"===this.diagram.lastInput.key?this.doCancel():this.doMouseMove())};
Kf.prototype.doKeyUp=function(){this.isActive&&this.doMouseMove()};function kg(a,b){var c=Infinity,d=Infinity,e=-Infinity,f=-Infinity;for(a=a.iterator;a.next();){var g=a.value;if(g.fc()&&g.isVisible()){var h=g.location;g=h.x;h=h.y;isNaN(g)||isNaN(h)||(g<c&&(c=g),h<d&&(d=h),g>e&&(e=g),h>f&&(f=h))}}Infinity===c?b.h(0,0,0,0):b.h(c,d,e-c,f-d)}
function lg(a,b){if(null===a.copiedParts){var c=a.diagram;if((!b||!c.isReadOnly&&!c.isModelReadOnly)&&null!==a.draggedParts){var d=c.undoManager;d.isEnabled&&d.isInTransaction?null!==d.currentTransaction&&0<d.currentTransaction.changes.count&&(c.undoManager.vf(),c.Ca("Drag")):jg(a);c.skipsUndoManager=!b;c.partManager.addsToTemporaryLayer=!b;a.startPoint=c.firstInput.documentPoint;b=a.copiesEffectiveCollection?a.draggedParts.ae():c.selection;c=c.Vj(b,c,!0);for(b=c.iterator;b.next();)b.value.location=
b.key.location;b=L.alloc();kg(c,b);L.free(b);b=new Ub;for(d=a.draggedParts.iterator;d.next();){var e=d.key;e.fc()&&e.canCopy()&&(e=c.K(e),null!==e&&(e.dc(),b.add(e,a.td(e.location))))}for(c=c.iterator;c.next();)d=c.value,d instanceof Q&&d.canCopy()&&b.add(d,a.td());a.copiedParts=b;Of(a,b.ae());null!==a.draggedLink&&(c=a.draggedLink,b=c.routeBounds,mg(c,a.startPoint.x-(b.x+b.width/2),a.startPoint.y-(b.y+b.height/2)))}}}
function fg(a){var b=a.diagram;if(null!==a.copiedParts&&(b.ut(a.copiedParts.ae(),!1),a.copiedParts=null,null!==a.draggedParts))for(var c=a.draggedParts.iterator;c.next();)c.key instanceof Q&&(c.value.point=new J(0,0));b.skipsUndoManager=!1;b.partManager.addsToTemporaryLayer=!1;a.startPoint=b.firstInput.documentPoint}
function eg(a){if(null!==a.draggedLink){if(a.dragsLink&&null!==a.cg){var b=a.cg;b.diagram.remove(b.temporaryFromNode);b.diagram.remove(b.temporaryToNode)}a.draggedLink=null;a.cg=null}}function ng(a,b,c){var d=a.diagram,e=a.startPoint,f=J.alloc();f.assign(d.lastInput.documentPoint);a.moveParts(b,f.$d(e),c);J.free(f);!0===d.Ge("temporaryPixelRatio")&&null===d.ye&&30<d.gu&&(d.ye=1,d.rt())}Kf.prototype.moveParts=function(a,b,c){var d=this.diagram;null!==d&&og(d,a,b,this.dragOptions,c)};
function jg(a){if(null!==a.draggedParts){for(var b=a.diagram,c=a.draggedParts.iterator;c.next();){var d=c.key;d.fc()&&(d.location=c.value.point)}for(c=a.draggedParts.iterator;c.next();)if(d=c.key,d instanceof Q&&d.suspendsRouting){var e=c.value.point;a.draggedParts.add(d,a.td());mg(d,-e.x,-e.y)}b.kd()}}function pg(a,b){if(null===b)return!0;b=b.part;return null===b||b instanceof Cf||b.layer.isTemporary||a.draggedParts&&a.draggedParts.contains(b)||a.copiedParts&&a.copiedParts.contains(b)?!0:!1}
function sg(a,b){var c=a.diagram;a.dragsLink&&(null!==a.draggedLink&&(a.draggedLink.fromNode=null,a.draggedLink.toNode=null),tg(a,!1));var d=ug(c,b,null,function(b){return!pg(a,b)}),e=c.lastInput;e.targetObject=d;var f=c.skipsUndoManager,g=!1;try{c.skipsUndoManager=!0;g=hg(a,e,d);if(!a.isActive&&null===Nf)return;if(null===d||c.handlesDragDropForTopLevelParts){var h=c.mouseDragOver;null!==h&&(h(e),g=!0)}if(!a.isActive&&null===Nf)return;a.doDragOver(b,d);if(!a.isActive&&null===Nf)return}finally{c.skipsUndoManager=
f,g&&c.kd()}(c.allowHorizontalScroll||c.allowVerticalScroll)&&c.Rs(e.viewPoint)}function hg(a,b,c){var d=!1,e=a.Ig.length,f=0<e?a.Ig[0]:null;if(c===f)return!1;b.handled=!1;for(var g=0;g<e;g++){var h=a.Ig[g],k=h.mouseDragLeave;if(null!==k&&(k(b,h,c),d=!0,b.handled))break}a.Ig.length=0;if(!a.isActive&&null===Nf||null===c)return d;b.handled=!1;for(e=c;null!==e;)a.Ig.push(e),e=vg(e);e=a.Ig.length;for(c=0;c<e&&(g=a.Ig[c],h=g.mouseDragEnter,null===h||(h(b,g,f),d=!0,!b.handled));c++);return d}
function vg(a){var b=a.panel;return null!==b?b:a instanceof R&&!(a instanceof wg)&&(a=a.containingGroup,null!==a&&a.handlesDragDropForMembers)?a:null}function xg(a,b,c){var d=a.cg;if(null===d)return null;var e=a.diagram.og(b,d.portGravity,function(a){return d.findValidLinkablePort(a,c)});a=J.alloc();var f=Infinity,g=null;for(e=e.iterator;e.next();){var h=e.value;if(null!==h.part){var k=h.oa(qd,a);k=b.Ee(k);k<f&&(g=h,f=k)}}J.free(a);return g}
function tg(a,b){var c=a.draggedLink;if(null!==c&&!(2>c.pointsCount)){var d=a.diagram;if(!d.isReadOnly){var e=a.cg;if(null!==e){var f=null,g=null;null===c.fromNode&&(f=xg(a,c.i(0),!1),null!==f&&(g=f.part));var h=null,k=null;null===c.toNode&&(h=xg(a,c.i(c.pointsCount-1),!0),null!==h&&(k=h.part));e.isValidLink(g,f,k,h)?b?(c.defaultFromPoint=c.i(0),c.defaultToPoint=c.i(c.pointsCount-1),c.suspendsRouting=!1,c.fromNode=g,null!==f&&(c.fromPortId=f.portId),c.toNode=k,null!==h&&(c.toPortId=h.portId),c.fromPort!==
d.zx&&d.ba("LinkRelinked",c,d.zx),c.toPort!==d.Ax&&d.ba("LinkRelinked",c,d.Ax)):yg(e,g,f,k,h):yg(e,null,null,null,null)}}}}Kf.prototype.doDragOver=function(){};
function zg(a,b){var c=a.diagram;a.dragsLink&&tg(a,!0);bg(a);var d=ug(c,b,null,function(b){return!pg(a,b)}),e=c.lastInput;e.targetObject=d;if(null!==d){e.handled=!1;for(var f=d;null!==f;){var g=f.mouseDrop;if(null!==g&&(g(e,f),e.handled))break;Ag(a,e,f);f=vg(f)}}else f=c.mouseDrop,null!==f&&f(e);if(a.isActive||null!==Nf){for(e=(a.copiedParts||a.draggedParts).iterator;e.next();)f=e.key,f instanceof V&&f.linksConnected.each(function(a){a.suspendsRouting=!1});a.doDropOnto(b,d);if(a.isActive||null!==
Nf){b=L.alloc();for(d=c.selection.iterator;d.next();)e=d.value,e instanceof V&&Bg(a,c,e,b);L.free(b)}}}function Ag(a,b,c){a=a.diagram;c instanceof R&&null===c.containingGroup&&!(c instanceof wg)&&a.handlesDragDropForTopLevelParts&&(c=a.mouseDrop,null!==c&&c(b))}
function Bg(a,b,c,d){var e=!1;c.getAvoidableRect(d);b.viewportBounds.pf(d)&&(e=!0);b=b.links;for(a=a.copiedParts||a.draggedParts;b.next();){var f=b.value;if(!e||Cg(f))a.contains(f)&&a.contains(c)||!f.Yd(c)&&f.isAvoiding&&Oc(f.actualBounds,d,0)&&f.Sa()}}Kf.prototype.doDropOnto=function(){};
Kf.prototype.doMouseMove=function(){if(this.isActive){var a=this.diagram,b=a.lastInput;this.simulatedMouseMove(b.event,null,b.targetDiagram||null)||null===this.currentPart||null===this.draggedParts||(this.mayCopy()?(a.currentCursor="copy",lg(this,!1),Yf(a,this.copiedParts),ng(this,this.copiedParts,!1),cg(a,this.copiedParts)):this.mayMove()?(fg(this),ng(this,this.draggedParts,!0)):this.mayDragOut()?(a.currentCursor="no-drop",lg(this,!1),ng(this,this.copiedParts,!1)):fg(this),sg(this,a.lastInput.documentPoint))}};
Kf.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram,b=a.lastInput;if(!this.simulatedMouseUp(b.event,null,b.documentPoint,b.targetDiagram)){var c=!1;(b=this.mayCopy())&&null!==this.copiedParts?(fg(this),lg(this,!0),Yf(a,this.copiedParts),ng(this,this.copiedParts,!1),cg(a,this.copiedParts),null!==this.copiedParts&&a.Hv(this.copiedParts.ae())):(c=!0,fg(this),this.mayMove()&&(ng(this,this.draggedParts,!0),sg(this,a.lastInput.documentPoint)));this.Bn=!0;zg(this,a.lastInput.documentPoint);
if(this.isActive){var d=b?this.copiedParts.ae():this.draggedParts.ae();this.copiedParts=null;if(c&&null!==this.draggedParts)for(c=this.draggedParts.iterator;c.next();){var e=c.key;e instanceof V&&(e=e.containingGroup,null===e||null===e.placeholder||this.draggedParts.contains(e)||e.placeholder.v())}a.Ya();cg(a,this.draggedParts);this.transactionResult=b?"Copy":"Move";a.ba(b?"SelectionCopied":"SelectionMoved",d)}this.stopTool()}}};
Kf.prototype.simulatedMouseMove=function(a,b,c){if(null===Nf)return!1;var d=Nf.diagram;c instanceof P||(c=null);var e=Zf;c!==e&&(null!==e&&e!==d&&(e.wf(),Nf.isDragOutStarted=!1,e=e.toolManager.findTool("Dragging"),null!==e&&e.doSimulatedDragLeave()),Zf=c,null!==c&&c!==d&&(ig(),e=c.toolManager.findTool("Dragging"),null!==e&&(dg.contains(e)||dg.add(e),e.doSimulatedDragEnter())));if(null===c||c===d||!c.allowDrop||c.isReadOnly||!c.allowInsert)return!1;d=c.toolManager.findTool("Dragging");null!==d&&(null!==
a?(void 0!==a.targetTouches&&(0<a.targetTouches.length?a=a.targetTouches[0]:0<a.changedTouches.length&&(a=a.changedTouches[0])),b=c.getMouse(a)):null===b&&(b=new J),c.lastInput.documentPoint=b,c.lastInput.viewPoint=c.Bt(b),c.lastInput.down=!1,c.lastInput.up=!1,d.doSimulatedDragOver());return!0};
Kf.prototype.simulatedMouseUp=function(a,b,c,d){if(null===Nf)return!1;null===d&&(d=b);b=Zf;var e=Nf.diagram;if(d!==b){var f=b.toolManager.findTool("Dragging");if(null!==b&&b!==e&&null!==f)return b.wf(),Nf.isDragOutStarted=!1,f.doSimulatedDragLeave(),!1;Zf=d;b=d.toolManager.findTool("Dragging");null!==d&&null!==b&&(ig(),dg.contains(b)||dg.add(b),b.doSimulatedDragEnter())}return null===d?(Nf.doCancel(),!0):d!==this.diagram?(null!==a?(void 0!==a.targetTouches&&(0<a.targetTouches.length?a=a.targetTouches[0]:
0<a.changedTouches.length&&(a=a.changedTouches[0])),c=d.getMouse(a)):null===c&&(c=new J),d.lastInput.documentPoint=c,d.lastInput.viewPoint=d.Bt(c),d.lastInput.down=!1,d.lastInput.up=!0,a=d.toolManager.findTool("Dragging"),null!==a&&a.doSimulatedDrop(),a=Nf,null!==a&&(d=a.mayCopy(),a.transactionResult=d?"Copy":"Move",a.stopTool()),!0):!1};
Kf.prototype.mayCopy=function(){if(!this.isCopyEnabled)return!1;var a=this.diagram;if(a.isReadOnly||a.isModelReadOnly||!a.allowInsert||!a.allowCopy||(kb?!a.lastInput.alt:!a.lastInput.control))return!1;for(a=a.selection.iterator;a.next();){var b=a.value;if(b.fc()&&b.canCopy())return!0}return null!==this.draggedLink&&this.dragsLink&&this.draggedLink.canCopy()?!0:!1};
Kf.prototype.mayDragOut=function(){if(!this.isCopyEnabled)return!1;var a=this.diagram;if(!a.allowDragOut||!a.allowCopy||a.allowMove)return!1;for(a=a.selection.iterator;a.next();){var b=a.value;if(b.fc()&&b.canCopy())return!0}return null!==this.draggedLink&&this.dragsLink&&this.draggedLink.canCopy()?!0:!1};
Kf.prototype.mayMove=function(){var a=this.diagram;if(a.isReadOnly||!a.allowMove)return!1;for(a=a.selection.iterator;a.next();){var b=a.value;if(b.fc()&&b.canMove())return!0}return null!==this.draggedLink&&this.dragsLink&&this.draggedLink.canMove()?!0:!1};Kf.prototype.computeBorder=function(a,b,c){return this.Bn||null===this.draggedParts||this.draggedParts.contains(a)?null:c.assign(b)};Kf.prototype.fz=function(){return Nf};
Kf.prototype.mayDragIn=function(){var a=this.diagram;if(!a.allowDrop||a.isReadOnly||a.isModelReadOnly||!a.allowInsert)return!1;var b=Nf;return null===b||b.diagram.model.dataFormat!==a.model.dataFormat?!1:!0};Kf.prototype.doSimulatedDragEnter=function(){if(this.mayDragIn()){var a=this.diagram;a.animationManager.zd();Dg(a);a.animationManager.zd();a=Nf;null!==a&&(a.diagram.currentCursor="copy",a.diagram.Ti=!1)}};Kf.prototype.doSimulatedDragLeave=function(){var a=Nf;null!==a&&a.doSimulatedDragOut();this.doCancel()};
Kf.prototype.doSimulatedDragOver=function(){var a=this.diagram,b=Nf;null!==b&&null!==b.draggedParts&&this.mayDragIn()&&(a.currentCursor="copy",Eg(this,b.draggedParts.ae(),!1,a.firstInput),ng(this,this.copiedParts,!1),sg(this,a.lastInput.documentPoint))};
Kf.prototype.doSimulatedDrop=function(){var a=this.diagram,b=Nf;if(null!==b){var c=b.diagram;b.Bn=!0;fg(this);this.mayDragIn()&&(this.Ca("Drop"),Eg(this,b.draggedParts.ae(),!0,a.lastInput),ng(this,this.copiedParts,!1),null!==this.copiedParts&&a.Hv(this.copiedParts.ae()),zg(this,a.lastInput.documentPoint),a.Ya(),b=a.selection,null!==this.copiedParts?this.transactionResult="ExternalCopy":b=new H,this.copiedParts=null,a.doFocus(),a.ba("ExternalObjectsDropped",b,c),this.wg())}};
function Eg(a,b,c,d){if(null===a.copiedParts){var e=a.diagram;if(!e.isReadOnly&&!e.isModelReadOnly){e.skipsUndoManager=!c;e.partManager.addsToTemporaryLayer=!c;a.startPoint=d.documentPoint;c=e.Vj(b,e,!0);var f=L.alloc();kg(b,f);d=f.x+f.width/2;e=f.y+f.height/2;L.free(f);f=a.zs;var g=new Ub,h=J.alloc();for(b=b.iterator;b.next();){var k=b.value,l=c.K(k);k.fc()&&k.canCopy()?(k=k.location,h.h(f.x-(d-k.x),f.y-(e-k.y)),l.location=h,l.dc(),g.add(l,a.td(h))):l instanceof Q&&k.canCopy()&&(mg(l,f.x-d,f.y-e),
g.add(l,a.td()))}J.free(h);a.copiedParts=g;Of(a,g.ae());null!==a.draggedLink&&(c=a.draggedLink,d=c.routeBounds,mg(c,a.startPoint.x-(d.x+d.width/2),a.startPoint.y-(d.y+d.height/2)))}}}Kf.prototype.doSimulatedDragOut=function(){var a=this.diagram;a.Ti=!1;this.mayCopy()||this.mayMove()?a.currentCursor="":a.currentCursor="no-drop"};Kf.prototype.computeMove=function(a,b,c,d){c=this.diagram;return null!==c?c.computeMove(a,b,this.dragOptions,d):new J};
na.Object.defineProperties(Kf.prototype,{isCopyEnabled:{configurable:!0,get:function(){return this.Oc},set:function(a){z(a,"boolean",Kf,"isCopyEnabled");this.Oc=a}},copiesEffectiveCollection:{configurable:!0,get:function(){return this.L},set:function(a){z(a,"boolean",Kf,"copiesEffectiveCollection");this.L=a}},dragOptions:{configurable:!0,get:function(){return this.Ma},set:function(a){w(a,Lf,Kf,"dragOptions");this.Ma=a}},isGridSnapEnabled:{configurable:!0,
enumerable:!0,get:function(){return this.dragOptions.isGridSnapEnabled},set:function(a){z(a,"boolean",Kf,"isGridSnapEnabled");this.dragOptions.isGridSnapEnabled=a}},isComplexRoutingRealtime:{configurable:!0,get:function(){return this.Xb},set:function(a){z(a,"boolean",Kf,"isComplexRoutingRealtime");this.Xb=a}},isGridSnapRealtime:{configurable:!0,get:function(){return this.dragOptions.isGridSnapRealtime},set:function(a){z(a,"boolean",Kf,"isGridSnapRealtime");this.dragOptions.isGridSnapRealtime=
a}},gridSnapCellSize:{configurable:!0,get:function(){return this.dragOptions.gridSnapCellSize},set:function(a){w(a,Zb,Kf,"gridSnapCellSize");null===this.diagram||this.dragOptions.gridSnapCellSize.A(a)||(a=a.J(),this.dragOptions.gridSnapCellSize=a)}},gridSnapCellSpot:{configurable:!0,get:function(){return this.dragOptions.gridSnapCellSpot},set:function(a){w(a,M,Kf,"gridSnapCellSpot");this.dragOptions.gridSnapCellSpot.A(a)||(a=a.J(),this.dragOptions.gridSnapCellSpot=a)}},
gridSnapOrigin:{configurable:!0,get:function(){return this.dragOptions.gridSnapOrigin},set:function(a){w(a,J,Kf,"gridSnapOrigin");this.dragOptions.gridSnapOrigin.A(a)||(a=a.J(),this.dragOptions.gridSnapOrigin=a)}},dragsLink:{configurable:!0,get:function(){return this.dragOptions.dragsLink},set:function(a){z(a,"boolean",Kf,"dragsLink");this.dragOptions.dragsLink=a}},dragsTree:{configurable:!0,get:function(){return this.dragOptions.dragsTree},set:function(a){z(a,
"boolean",Kf,"dragsTree");this.dragOptions.dragsTree=a}},currentPart:{configurable:!0,get:function(){return this.ea},set:function(a){null!==a&&w(a,R,Kf,"currentPart");this.ea=a}},copiedParts:{configurable:!0,get:function(){return this.w},set:function(a){this.w=a}},draggedParts:{configurable:!0,get:function(){return this.Xa},set:function(a){this.Xa=a}},draggingParts:{configurable:!0,get:function(){return null!==this.copiedParts?this.copiedParts.ae():
null!==this.draggedParts?this.draggedParts.ae():this.xg}},draggedLink:{configurable:!0,get:function(){return this.diagram.draggedLink},set:function(a){null!==a&&w(a,Q,Kf,"draggedLink");this.diagram.draggedLink=a}},isDragOutStarted:{configurable:!0,get:function(){return this.Pc},set:function(a){this.Pc=a}},startPoint:{configurable:!0,get:function(){return this.zs},set:function(a){w(a,J,Kf,"startPoint");this.zs.A(a)||this.zs.assign(a)}},delay:{configurable:!0,
enumerable:!0,get:function(){return this.Nk},set:function(a){z(a,"number",Kf,"delay");this.Nk=a}}});Kf.prototype.getDraggingSource=Kf.prototype.fz;var dg=null,Nf=null,Zf=null;Kf.className="DraggingTool";dg=new G;Za("draggingTool",function(){return this.findTool("Dragging")},function(a){If(this,"Dragging",a,this.mouseMoveTools)});$a.prototype.doCancel=function(){null!==Nf&&Nf.doCancel();vf.prototype.doCancel.call(this)};
function Fg(){0<arguments.length&&Da(Fg);vf.call(this);this.xg=100;this.ea=!1;var a=new Q,b=new Gg;b.isPanelMain=!0;b.stroke="blue";a.add(b);b=new Gg;b.toArrow="Standard";b.fill="blue";b.stroke="blue";a.add(b);a.layerName="Tool";this.Jm=a;a=new V;b=new Gg;b.portId="";b.figure="Rectangle";b.fill=null;b.stroke="magenta";b.strokeWidth=2;b.desiredSize=sc;a.add(b);a.selectable=!1;a.layerName="Tool";this.Hm=a;this.Im=b;a=new V;b=new Gg;b.portId="";b.figure="Rectangle";b.fill=null;b.stroke="magenta";b.strokeWidth=
2;b.desiredSize=sc;a.add(b);a.selectable=!1;a.layerName="Tool";this.Cq=a;this.ew=b;this.Pc=this.Oc=this.Xa=this.Ma=this.Xb=null;this.L=!0;this.Ux=new Ub;this.Em=this.hi=this.Gm=null}ma(Fg,vf);Fg.prototype.doStop=function(){this.diagram.wf();this.originalToPort=this.originalToNode=this.originalFromPort=this.originalFromNode=this.originalLink=null;this.validPortsCache.clear();this.targetPort=null};
Fg.prototype.copyPortProperties=function(a,b,c,d,e){if(null!==a&&null!==b&&null!==c&&null!==d){var f=b.Fe(),g=Zb.alloc();g.width=b.naturalBounds.width*f;g.height=b.naturalBounds.height*f;d.desiredSize=g;Zb.free(g);e?(d.toSpot=b.toSpot,d.toEndSegmentLength=b.toEndSegmentLength):(d.fromSpot=b.fromSpot,d.fromEndSegmentLength=b.fromEndSegmentLength);c.locationSpot=qd;f=J.alloc();c.location=b.oa(qd,f);J.free(f);d.angle=b.Hi();null!==this.portTargeted&&this.portTargeted(a,b,c,d,e)}};
Fg.prototype.setNoTargetPortProperties=function(a,b,c){null!==b&&(b.desiredSize=sc,b.fromSpot=ed,b.toSpot=ed);null!==a&&(a.location=this.diagram.lastInput.documentPoint);null!==this.portTargeted&&this.portTargeted(null,null,a,b,c)};Fg.prototype.doMouseDown=function(){this.isActive&&this.doMouseMove()};
Fg.prototype.doMouseMove=function(){if(this.isActive){var a=this.diagram;this.targetPort=this.findTargetPort(this.isForwards);if(null!==this.targetPort&&this.targetPort.part instanceof V){var b=this.targetPort.part;this.isForwards?this.copyPortProperties(b,this.targetPort,this.temporaryToNode,this.temporaryToPort,!0):this.copyPortProperties(b,this.targetPort,this.temporaryFromNode,this.temporaryFromPort,!1)}else this.isForwards?this.setNoTargetPortProperties(this.temporaryToNode,this.temporaryToPort,
!0):this.setNoTargetPortProperties(this.temporaryFromNode,this.temporaryFromPort,!1);(a.allowHorizontalScroll||a.allowVerticalScroll)&&a.Rs(a.lastInput.viewPoint)}};Fg.prototype.findValidLinkablePort=function(a,b){if(null===a)return null;var c=a.part;if(!(c instanceof V))return null;for(;null!==a;){var d=b?a.toLinkable:a.fromLinkable;if(!0===d&&(null!==a.portId||a instanceof V)&&(b?this.isValidTo(c,a):this.isValidFrom(c,a)))return a;if(!1===d)break;a=a.panel}return null};
Fg.prototype.findTargetPort=function(a){var b=this.diagram,c=b.lastInput.documentPoint,d=this.portGravity;0>=d&&(d=.1);var e=this,f=b.og(c,d,function(b){return e.findValidLinkablePort(b,a)},null,!0);d=Infinity;b=null;for(f=f.iterator;f.next();){var g=f.value,h=g.part;if(h instanceof V){var k=g.oa(qd,J.alloc()),l=c.x-k.x,m=c.y-k.y;J.free(k);k=l*l+m*m;k<d&&(l=this.validPortsCache.K(g),null!==l?l&&(b=g,d=k):a&&this.isValidLink(this.originalFromNode,this.originalFromPort,h,g)||!a&&this.isValidLink(h,
g,this.originalToNode,this.originalToPort)?(this.validPortsCache.add(g,!0),b=g,d=k):this.validPortsCache.add(g,!1))}}return null!==b&&(c=b.part,c instanceof V&&(null===c.layer||c.layer.allowLink))?b:null};
Fg.prototype.isValidFrom=function(a,b){if(null===a||null===b)return this.isUnconnectedLinkValid;if(this.diagram.currentTool===this&&(null!==a.layer&&!a.layer.allowLink||!0!==b.fromLinkable))return!1;var c=b.fromMaxLinks;if(Infinity>c){if(null!==this.originalLink&&a===this.originalFromNode&&b===this.originalFromPort)return!0;b=b.portId;null===b&&(b="");if(a.Xp(b).count>=c)return!1}return!0};
Fg.prototype.isValidTo=function(a,b){if(null===a||null===b)return this.isUnconnectedLinkValid;if(this.diagram.currentTool===this&&(null!==a.layer&&!a.layer.allowLink||!0!==b.toLinkable))return!1;var c=b.toMaxLinks;if(Infinity>c){if(null!==this.originalLink&&a===this.originalToNode&&b===this.originalToPort)return!0;b=b.portId;null===b&&(b="");if(a.wd(b).count>=c)return!1}return!0};
Fg.prototype.isInSameNode=function(a,b){if(null===a||null===b)return!1;if(a===b)return!0;a=a.part;b=b.part;return null!==a&&a===b};Fg.prototype.isLinked=function(a,b){if(null===a||null===b)return!1;var c=a.part;if(!(c instanceof V))return!1;a=a.portId;null===a&&(a="");var d=b.part;if(!(d instanceof V))return!1;b=b.portId;null===b&&(b="");for(b=d.wd(b);b.next();)if(d=b.value,d.fromNode===c&&d.fromPortId===a)return!0;return!1};
Fg.prototype.isValidLink=function(a,b,c,d){if(!this.isValidFrom(a,b)||!this.isValidTo(c,d)||!(null===b||null===d||(b.fromLinkableSelfNode&&d.toLinkableSelfNode||!this.isInSameNode(b,d))&&(b.fromLinkableDuplicates&&d.toLinkableDuplicates||!this.isLinked(b,d)))||null!==this.originalLink&&(null!==a&&this.isLabelDependentOnLink(a,this.originalLink)||null!==c&&this.isLabelDependentOnLink(c,this.originalLink))||null!==a&&null!==c&&(null===a.data&&null!==c.data||null!==a.data&&null===c.data)||!this.isValidCycle(a,
c,this.originalLink))return!1;if(null!==a){var e=a.linkValidation;if(null!==e&&!e(a,b,c,d,this.originalLink))return!1}if(null!==c&&(e=c.linkValidation,null!==e&&!e(a,b,c,d,this.originalLink)))return!1;e=this.linkValidation;return null!==e?e(a,b,c,d,this.originalLink):!0};Fg.prototype.isLabelDependentOnLink=function(a,b){if(null===a)return!1;var c=a.labeledLink;if(null===c)return!1;if(c===b)return!0;var d=new H;d.add(a);return Hg(this,c,b,d)};
function Hg(a,b,c,d){if(b===c)return!0;var e=b.fromNode;if(null!==e&&e.isLinkLabel&&(d.add(e),Hg(a,e.labeledLink,c,d)))return!0;b=b.toNode;return null!==b&&b.isLinkLabel&&(d.add(b),Hg(a,b.labeledLink,c,d))?!0:!1}
Fg.prototype.isValidCycle=function(a,b,c){void 0===c&&(c=null);if(null===a||null===b)return this.isUnconnectedLinkValid;var d=this.diagram.validCycle;if(d!==Ig){if(d===Jg){d=c||this.temporaryLink;if(null!==d&&!d.isTreeLink)return!0;for(d=b.linksConnected;d.next();){var e=d.value;if(e!==c&&e.isTreeLink&&e.toNode===b)return!1}return!Kg(this,a,b,c,!0)}if(d===Lg){d=c||this.temporaryLink;if(null!==d&&!d.isTreeLink)return!0;for(d=a.linksConnected;d.next();)if(e=d.value,e!==c&&e.isTreeLink&&e.fromNode===
a)return!1;return!Kg(this,a,b,c,!0)}if(d===Mg)return a===b?a=!0:(d=new H,d.add(b),a=Ng(this,d,a,b,c)),!a;if(d===Og)return!Kg(this,a,b,c,!1);if(d===Pg)return a===b?a=!0:(d=new H,d.add(b),a=Qg(this,d,a,b,c)),!a}return!0};function Kg(a,b,c,d,e){if(b===c)return!0;if(null===b||null===c)return!1;for(var f=b.linksConnected;f.next();){var g=f.value;if(g!==d&&(!e||g.isTreeLink)&&g.toNode===b&&(g=g.fromNode,g!==b&&Kg(a,g,c,d,e)))return!0}return!1}
function Ng(a,b,c,d,e){if(c===d)return!0;if(null===c||null===d||b.contains(c))return!1;b.add(c);for(var f=c.linksConnected;f.next();){var g=f.value;if(g!==e&&g.toNode===c&&(g=g.fromNode,g!==c&&Ng(a,b,g,d,e)))return!0}return!1}function Qg(a,b,c,d,e){if(c===d)return!0;if(null===c||null===d||b.contains(c))return!1;b.add(c);for(var f=c.linksConnected;f.next();){var g=f.value;if(g!==e){var h=g.fromNode;g=g.toNode;h=h===c?g:h;if(h!==c&&Qg(a,b,h,d,e))return!0}}return!1}
na.Object.defineProperties(Fg.prototype,{portGravity:{configurable:!0,get:function(){return this.xg},set:function(a){z(a,"number",Fg,"portGravity");0<=a&&(this.xg=a)}},isUnconnectedLinkValid:{configurable:!0,get:function(){return this.ea},set:function(a){z(a,"boolean",Fg,"isUnconnectedLinkValid");this.ea=a}},temporaryLink:{configurable:!0,get:function(){return this.Jm},set:function(a){w(a,Q,Fg,"temporaryLink");this.Jm=a}},temporaryFromNode:{configurable:!0,
enumerable:!0,get:function(){return this.Hm},set:function(a){w(a,V,Fg,"temporaryFromNode");this.Hm=a}},temporaryFromPort:{configurable:!0,get:function(){return this.Im},set:function(a){w(a,N,Fg,"temporaryFromPort");this.Im=a}},temporaryToNode:{configurable:!0,get:function(){return this.Cq},set:function(a){w(a,V,Fg,"temporaryToNode");this.Cq=a}},temporaryToPort:{configurable:!0,get:function(){return this.ew},set:function(a){w(a,N,Fg,"temporaryToPort");this.ew=
a}},originalLink:{configurable:!0,get:function(){return this.Xb},set:function(a){null!==a&&w(a,Q,Fg,"originalLink");this.Xb=a}},originalFromNode:{configurable:!0,get:function(){return this.Ma},set:function(a){null!==a&&w(a,V,Fg,"originalFromNode");this.Ma=a}},originalFromPort:{configurable:!0,get:function(){return this.Xa},set:function(a){null!==a&&w(a,N,Fg,"originalFromPort");this.Xa=a}},originalToNode:{configurable:!0,get:function(){return this.Oc},
set:function(a){null!==a&&w(a,V,Fg,"originalToNode");this.Oc=a}},originalToPort:{configurable:!0,get:function(){return this.Pc},set:function(a){null!==a&&w(a,N,Fg,"originalToPort");this.Pc=a}},isForwards:{configurable:!0,get:function(){return this.L},set:function(a){z(a,"boolean",Fg,"isForwards");this.L=a}},validPortsCache:{configurable:!0,get:function(){return this.Ux}},targetPort:{configurable:!0,get:function(){return this.Gm},set:function(a){null!==
a&&w(a,N,Fg,"targetPort");this.Gm=a}},linkValidation:{configurable:!0,get:function(){return this.hi},set:function(a){null!==a&&z(a,"function",Fg,"linkValidation");this.hi=a}},portTargeted:{configurable:!0,get:function(){return this.Em},set:function(a){null!==a&&z(a,"function",Fg,"portTargeted");this.Em=a}}});Fg.className="LinkingBaseTool";function Rg(){0<arguments.length&&Da(Rg);Fg.call(this);this.name="Linking";this.w={};this.l=null;this.M=Sg;this.Fm=null}ma(Rg,Fg);
Rg.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return a.isReadOnly||a.isModelReadOnly||!a.allowLink||!a.model.ht()||!a.lastInput.left||a.currentTool!==this&&!this.isBeyondDragSize()?!1:null!==this.findLinkablePort()};
Rg.prototype.findLinkablePort=function(){var a=this.diagram,b=this.startObject;null===b&&(b=a.Tb(a.firstInput.documentPoint,null,null));if(null===b||!(b.part instanceof V))return null;a=this.direction;if(a===Sg||a===Tg){var c=this.findValidLinkablePort(b,!1);if(null!==c)return this.isForwards=!0,c}if(a===Sg||a===Ug)if(b=this.findValidLinkablePort(b,!0),null!==b)return this.isForwards=!1,b;return null};
Rg.prototype.doActivate=function(){var a=this.diagram,b=this.findLinkablePort();null!==b&&(this.Ca(this.name),a.isMouseCaptured=!0,a.currentCursor="pointer",this.isForwards?(null===this.temporaryToNode||this.temporaryToNode.location.o()||(this.temporaryToNode.location=a.lastInput.documentPoint),this.originalFromPort=b,b=this.originalFromPort.part,b instanceof V&&(this.originalFromNode=b),this.copyPortProperties(this.originalFromNode,this.originalFromPort,this.temporaryFromNode,this.temporaryFromPort,
!1)):(null===this.temporaryFromNode||this.temporaryFromNode.location.o()||(this.temporaryFromNode.location=a.lastInput.documentPoint),this.originalToPort=b,b=this.originalToPort.part,b instanceof V&&(this.originalToNode=b),this.copyPortProperties(this.originalToNode,this.originalToPort,this.temporaryToNode,this.temporaryToPort,!0)),a.add(this.temporaryFromNode),a.add(this.temporaryToNode),null!==this.temporaryLink&&(null!==this.temporaryFromNode&&(this.temporaryLink.fromNode=this.temporaryFromNode),
null!==this.temporaryToNode&&(this.temporaryLink.toNode=this.temporaryToNode),this.temporaryLink.isTreeLink=this.isNewTreeLink(),this.temporaryLink.Sa(),a.add(this.temporaryLink)),this.isActive=!0)};Rg.prototype.doDeactivate=function(){this.isActive=!1;var a=this.diagram;a.remove(this.temporaryLink);a.remove(this.temporaryFromNode);a.remove(this.temporaryToNode);a.isMouseCaptured=!1;a.currentCursor="";this.wg()};Rg.prototype.doStop=function(){Fg.prototype.doStop.call(this);this.startObject=null};
Rg.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram,b=this.transactionResult=null,c=null,d=null,e=null,f=this.targetPort=this.findTargetPort(this.isForwards);if(null!==f){var g=f.part;g instanceof V&&(this.isForwards?(null!==this.originalFromNode&&(b=this.originalFromNode,c=this.originalFromPort),d=g,e=f):(b=g,c=f,null!==this.originalToNode&&(d=this.originalToNode,e=this.originalToPort)))}else this.isForwards?null!==this.originalFromNode&&this.isUnconnectedLinkValid&&(b=this.originalFromNode,
c=this.originalFromPort):null!==this.originalToNode&&this.isUnconnectedLinkValid&&(d=this.originalToNode,e=this.originalToPort);null!==b||null!==d?(g=this.insertLink(b,c,d,e),null!==g?(null===f&&(this.isForwards?g.defaultToPoint=a.lastInput.documentPoint:g.defaultFromPoint=a.lastInput.documentPoint),a.allowSelect&&a.select(g),this.transactionResult=this.name,a.ba("LinkDrawn",g)):(a.model.Nu(),this.doNoLink(b,c,d,e))):this.isForwards?this.doNoLink(this.originalFromNode,this.originalFromPort,null,null):
this.doNoLink(null,null,this.originalToNode,this.originalToPort)}this.stopTool()};Rg.prototype.isNewTreeLink=function(){var a=this.archetypeLinkData;if(null===a)return!0;if(a instanceof Q)return a.isTreeLink;var b=this.diagram;if(null===b)return!0;a=b.partManager.getLinkCategoryForData(a);b=b.partManager.findLinkTemplateForCategory(a);return null!==b?b.isTreeLink:!0};Rg.prototype.insertLink=function(a,b,c,d){return this.diagram.partManager.insertLink(a,b,c,d)};Rg.prototype.doNoLink=function(){};
na.Object.defineProperties(Rg.prototype,{archetypeLinkData:{configurable:!0,get:function(){return this.w},set:function(a){null!==a&&z(a,"object",Rg,"archetypeLinkData");a instanceof N&&w(a,Q,Rg,"archetypeLinkData");this.w=a}},archetypeLabelNodeData:{configurable:!0,get:function(){return this.l},set:function(a){null!==a&&z(a,"object",Rg,"archetypeLabelNodeData");a instanceof N&&w(a,V,Rg,"archetypeLabelNodeData");this.l=a}},direction:{configurable:!0,get:function(){return this.M},
set:function(a){tb(a,Rg,Rg,"direction");this.M=a}},startObject:{configurable:!0,get:function(){return this.Fm},set:function(a){null!==a&&w(a,N,Rg,"startObject");this.Fm=a}}});var Sg=new D(Rg,"Either",0),Tg=new D(Rg,"ForwardsOnly",0),Ug=new D(Rg,"BackwardsOnly",0);Rg.className="LinkingTool";Rg.Either=Sg;Rg.ForwardsOnly=Tg;Rg.BackwardsOnly=Ug;
function $f(){0<arguments.length&&Da($f);Fg.call(this);this.name="Relinking";var a=new Gg;a.figure="Diamond";a.desiredSize=uc;a.fill="lightblue";a.stroke="dodgerblue";a.cursor="pointer";a.segmentIndex=0;this.l=a;a=new Gg;a.figure="Diamond";a.desiredSize=uc;a.fill="lightblue";a.stroke="dodgerblue";a.cursor="pointer";a.segmentIndex=-1;this.w=a;this.$a=null;this.Jw=new L}ma($f,Fg);
$f.prototype.updateAdornments=function(a){if(null!==a&&a instanceof Q){var b="RelinkFrom",c=null;if(a.isSelected&&!this.diagram.isReadOnly){var d=a.selectionObject;null!==d&&a.canRelinkFrom()&&a.actualBounds.o()&&a.isVisible()&&d.actualBounds.o()&&d.tf()&&(c=a.Yj(b),null===c&&(c=this.makeAdornment(d,!1),a.lh(b,c)))}null===c&&a.uf(b);b="RelinkTo";c=null;a.isSelected&&!this.diagram.isReadOnly&&(d=a.selectionObject,null!==d&&a.canRelinkTo()&&a.actualBounds.o()&&a.isVisible()&&d.actualBounds.o()&&d.tf()&&
(c=a.Yj(b),null===c?(c=this.makeAdornment(d,!0),a.lh(b,c)):c.v()));null===c&&a.uf(b)}};$f.prototype.makeAdornment=function(a,b){var c=new Cf;c.type=W.Link;b=b?this.toHandleArchetype:this.fromHandleArchetype;null!==b&&c.add(b.copy());c.adornedObject=a;return c};
$f.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(a.isReadOnly||a.isModelReadOnly||!a.allowRelink||!a.model.ht()||!a.lastInput.left)return!1;var b=this.findToolHandleAt(a.firstInput.documentPoint,"RelinkFrom");null===b&&(b=this.findToolHandleAt(a.firstInput.documentPoint,"RelinkTo"));return null!==b};
$f.prototype.doActivate=function(){var a=this.diagram;if(null===this.originalLink){var b=this.findToolHandleAt(a.firstInput.documentPoint,"RelinkFrom");null===b&&(b=this.findToolHandleAt(a.firstInput.documentPoint,"RelinkTo"));if(null===b)return;var c=b.part;if(!(c instanceof Cf&&c.adornedPart instanceof Q))return;this.$a=b;this.isForwards=null===c||"RelinkTo"===c.category;this.originalLink=c.adornedPart}this.Ca(this.name);a.isMouseCaptured=!0;a.currentCursor="pointer";this.originalFromPort=this.originalLink.fromPort;
this.originalFromNode=this.originalLink.fromNode;this.originalToPort=this.originalLink.toPort;this.originalToNode=this.originalLink.toNode;this.Jw.set(this.originalLink.actualBounds);null!==this.originalLink&&0<this.originalLink.pointsCount&&(null===this.originalLink.fromNode&&(null!==this.temporaryFromPort&&(this.temporaryFromPort.desiredSize=rc),null!==this.temporaryFromNode&&(this.temporaryFromNode.location=this.originalLink.i(0))),null===this.originalLink.toNode&&(null!==this.temporaryToPort&&
(this.temporaryToPort.desiredSize=rc),null!==this.temporaryToNode&&(this.temporaryToNode.location=this.originalLink.i(this.originalLink.pointsCount-1))));this.copyPortProperties(this.originalFromNode,this.originalFromPort,this.temporaryFromNode,this.temporaryFromPort,!1);this.copyPortProperties(this.originalToNode,this.originalToPort,this.temporaryToNode,this.temporaryToPort,!0);a.add(this.temporaryFromNode);a.add(this.temporaryToNode);null!==this.temporaryLink&&(null!==this.temporaryFromNode&&(this.temporaryLink.fromNode=
this.temporaryFromNode),null!==this.temporaryToNode&&(this.temporaryLink.toNode=this.temporaryToNode),this.copyLinkProperties(this.originalLink,this.temporaryLink),this.temporaryLink.Sa(),a.add(this.temporaryLink));this.isActive=!0};
$f.prototype.copyLinkProperties=function(a,b){if(null!==a&&null!==b){b.adjusting=a.adjusting;b.corner=a.corner;var c=a.curve;if(c===$g||c===ah)c=bh;b.curve=c;b.curviness=a.curviness;b.isTreeLink=a.isTreeLink;b.points=a.points;b.routing=a.routing;b.smoothness=a.smoothness;b.fromSpot=a.fromSpot;b.fromEndSegmentLength=a.fromEndSegmentLength;b.fromShortLength=a.fromShortLength;b.toSpot=a.toSpot;b.toEndSegmentLength=a.toEndSegmentLength;b.toShortLength=a.toShortLength}};
$f.prototype.doDeactivate=function(){this.isActive=!1;var a=this.diagram;a.remove(this.temporaryLink);a.remove(this.temporaryFromNode);a.remove(this.temporaryToNode);a.isMouseCaptured=!1;a.currentCursor="";this.wg()};$f.prototype.doStop=function(){Fg.prototype.doStop.call(this);this.$a=null};
$f.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram;this.transactionResult=null;var b=this.originalFromNode,c=this.originalFromPort,d=this.originalToNode,e=this.originalToPort,f=this.originalLink;this.targetPort=this.findTargetPort(this.isForwards);if(null!==this.targetPort){var g=this.targetPort.part;g instanceof V&&(this.isForwards?(d=g,e=this.targetPort):(b=g,c=this.targetPort))}else this.isUnconnectedLinkValid?this.isForwards?e=d=null:c=b=null:f=null;null!==f?(this.reconnectLink(f,
this.isForwards?d:b,this.isForwards?e:c,this.isForwards),null===this.targetPort&&(this.isForwards?f.defaultToPoint=a.lastInput.documentPoint:f.defaultFromPoint=a.lastInput.documentPoint,f.Sa()),a.allowSelect&&(f.isSelected=!0),this.transactionResult=this.name,a.ba("LinkRelinked",f,this.isForwards?this.originalToPort:this.originalFromPort)):this.doNoRelink(this.originalLink,this.isForwards);this.originalLink.fq(this.Jw)}this.stopTool()};
$f.prototype.reconnectLink=function(a,b,c,d){c=null!==c&&null!==c.portId?c.portId:"";d?(a.toNode=b,a.toPortId=c):(a.fromNode=b,a.fromPortId=c);return!0};$f.prototype.doNoRelink=function(){};
function yg(a,b,c,d,e){null!==b?(a.copyPortProperties(b,c,a.temporaryFromNode,a.temporaryFromPort,!1),a.diagram.add(a.temporaryFromNode)):a.diagram.remove(a.temporaryFromNode);null!==d?(a.copyPortProperties(d,e,a.temporaryToNode,a.temporaryToPort,!0),a.diagram.add(a.temporaryToNode)):a.diagram.remove(a.temporaryToNode)}
na.Object.defineProperties($f.prototype,{fromHandleArchetype:{configurable:!0,get:function(){return this.l},set:function(a){null!==a&&w(a,N,$f,"fromHandleArchetype");this.l=a}},toHandleArchetype:{configurable:!0,get:function(){return this.w},set:function(a){null!==a&&w(a,N,$f,"toHandleArchetype");this.w=a}},handle:{configurable:!0,get:function(){return this.$a}}});$f.className="RelinkingTool";
Za("linkingTool",function(){return this.findTool("Linking")},function(a){If(this,"Linking",a,this.mouseMoveTools)});Za("relinkingTool",function(){return this.findTool("Relinking")},function(a){If(this,"Relinking",a,this.mouseDownTools)});
function ch(){0<arguments.length&&Da(ch);vf.call(this);this.name="LinkReshaping";var a=new Gg;a.figure="Rectangle";a.desiredSize=tc;a.fill="lightblue";a.stroke="dodgerblue";this.l=a;a=new Gg;a.figure="Diamond";a.desiredSize=uc;a.fill="lightblue";a.stroke="dodgerblue";a.cursor="move";this.w=a;this.L=3;this.Kt=this.$a=null;this.rl=new J;this.es=new G}ma(ch,vf);ch.prototype.fv=function(a){return a&&a.ks&&0!==a.ks.value?a.ks:dh};
ch.prototype.zm=function(a,b){w(a,N,ch,"setReshapingBehavior:obj");tb(b,ch,ch,"setReshapingBehavior:behavior");a.ks=b};
ch.prototype.updateAdornments=function(a){if(null!==a&&a instanceof Q){var b=null;if(a.isSelected&&!this.diagram.isReadOnly){var c=a.path;null!==c&&a.canReshape()&&a.actualBounds.o()&&a.isVisible()&&c.actualBounds.o()&&c.tf()&&(b=a.Yj(this.name),null===b||b.Gw!==a.pointsCount||b.Rw!==a.resegmentable)&&(b=this.makeAdornment(c),null!==b&&(b.Gw=a.pointsCount,b.Rw=a.resegmentable,a.lh(this.name,b)))}null===b&&a.uf(this.name)}};
ch.prototype.makeAdornment=function(a){var b=a.part,c=b.pointsCount,d=b.isOrthogonal,e=null;if(null!==b.points&&1<c){e=new Cf;e.type=W.Link;c=b.firstPickIndex;var f=b.lastPickIndex,g=d?1:0;if(b.resegmentable&&b.computeCurve()!==eh)for(var h=c+g;h<f-g;h++){var k=this.makeResegmentHandle(a,h);null!==k&&(k.segmentIndex=h,k.segmentFraction=.5,k.fromMaxLinks=999,e.add(k))}for(g=c+1;g<f;g++)if(h=this.makeHandle(a,g),null!==h){h.segmentIndex=g;if(g!==c)if(g===c+1&&d){k=b.i(c);var l=b.i(c+1);K.B(k.x,l.x)&&
K.B(k.y,l.y)&&(l=b.i(c-1));K.B(k.x,l.x)?(this.zm(h,fh),h.cursor="n-resize"):K.B(k.y,l.y)&&(this.zm(h,gh),h.cursor="w-resize")}else g===f-1&&d?(k=b.i(f-1),l=b.i(f),K.B(k.x,l.x)&&K.B(k.y,l.y)&&(k=b.i(f+1)),K.B(k.x,l.x)?(this.zm(h,fh),h.cursor="n-resize"):K.B(k.y,l.y)&&(this.zm(h,gh),h.cursor="w-resize")):g!==f&&(this.zm(h,hh),h.cursor="move");e.add(h)}e.adornedObject=a}return e};ch.prototype.makeHandle=function(){var a=this.handleArchetype;return null===a?null:a.copy()};
ch.prototype.makeResegmentHandle=function(){var a=this.midHandleArchetype;return null===a?null:a.copy()};ch.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!a.isReadOnly&&a.allowReshape&&a.lastInput.left?null!==this.findToolHandleAt(a.firstInput.documentPoint,this.name):!1};
ch.prototype.doActivate=function(){var a=this.diagram;this.$a=this.findToolHandleAt(a.firstInput.documentPoint,this.name);if(null!==this.$a){var b=this.$a.part.adornedPart;if(b instanceof Q){this.Kt=b;a.isMouseCaptured=!0;this.Ca(this.name);if(b.resegmentable&&999===this.$a.fromMaxLinks){var c=b.points.copy(),d=this.getResegmentingPoint();c.Mb(this.$a.segmentIndex+1,d);b.isOrthogonal&&c.Mb(this.$a.segmentIndex+1,d);b.points=c;b.Nb();b.updateAdornments();this.$a=this.findToolHandleAt(a.firstInput.documentPoint,
this.name);if(null===this.$a){this.doDeactivate();return}}this.rl=b.i(this.$a.segmentIndex);this.es=b.points.copy();this.isActive=!0}}};ch.prototype.doDeactivate=function(){this.wg();this.Kt=this.$a=null;this.isActive=this.diagram.isMouseCaptured=!1};ch.prototype.doCancel=function(){var a=this.adornedLink;null!==a&&(a.points=this.es);this.stopTool()};ch.prototype.getResegmentingPoint=function(){return this.handle.oa(qd)};
ch.prototype.doMouseMove=function(){var a=this.diagram;this.isActive&&(a=this.computeReshape(a.lastInput.documentPoint),this.reshape(a))};
ch.prototype.doMouseUp=function(){var a=this.diagram;if(this.isActive){var b=this.computeReshape(a.lastInput.documentPoint);this.reshape(b);b=this.adornedLink;if(null!==b&&b.resegmentable){var c=this.handle.segmentIndex,d=b.i(c-1),e=b.i(c),f=b.i(c+1);if(b.isOrthogonal){if(c>b.firstPickIndex+1&&c<b.lastPickIndex-1){var g=b.i(c-2);if(Math.abs(d.x-e.x)<this.resegmentingDistance&&Math.abs(d.y-e.y)<this.resegmentingDistance&&(ih(this,g,d,e,f,!0)||ih(this,g,d,e,f,!1))){var h=b.points.copy();ih(this,g,d,
e,f,!0)?(h.ld(c-2,new J(g.x,(f.y+g.y)/2)),h.ld(c+1,new J(f.x,(f.y+g.y)/2))):(h.ld(c-2,new J((f.x+g.x)/2,g.y)),h.ld(c+1,new J((f.x+g.x)/2,f.y)));h.nb(c);h.nb(c-1);b.points=h;b.Nb()}else g=b.i(c+2),Math.abs(e.x-f.x)<this.resegmentingDistance&&Math.abs(e.y-f.y)<this.resegmentingDistance&&(ih(this,d,e,f,g,!0)||ih(this,d,e,f,g,!1))&&(h=b.points.copy(),ih(this,d,e,f,g,!0)?(h.ld(c-1,new J(d.x,(d.y+g.y)/2)),h.ld(c+2,new J(g.x,(d.y+g.y)/2))):(h.ld(c-1,new J((d.x+g.x)/2,d.y)),h.ld(c+2,new J((d.x+g.x)/2,g.y))),
h.nb(c+1),h.nb(c),b.points=h,b.Nb())}}else g=J.alloc(),K.Pi(d.x,d.y,f.x,f.y,e.x,e.y,g)&&g.Ee(e)<this.resegmentingDistance*this.resegmentingDistance&&(d=b.points.copy(),d.nb(c),b.points=d,b.Nb()),J.free(g)}a.Ya();this.transactionResult=this.name;a.ba("LinkReshaped",this.adornedLink,this.es)}this.stopTool()};
function ih(a,b,c,d,e,f){return f?Math.abs(b.y-c.y)<a.resegmentingDistance&&Math.abs(c.y-d.y)<a.resegmentingDistance&&Math.abs(d.y-e.y)<a.resegmentingDistance:Math.abs(b.x-c.x)<a.resegmentingDistance&&Math.abs(c.x-d.x)<a.resegmentingDistance&&Math.abs(d.x-e.x)<a.resegmentingDistance}
ch.prototype.reshape=function(a){var b=this.adornedLink;b.Ah();var c=this.handle.segmentIndex,d=this.fv(this.handle);if(b.isOrthogonal)if(c===b.firstPickIndex+1)c=b.firstPickIndex+1,d===fh?(b.N(c,b.i(c-1).x,a.y),b.N(c+1,b.i(c+2).x,a.y)):d===gh&&(b.N(c,a.x,b.i(c-1).y),b.N(c+1,a.x,b.i(c+2).y));else if(c===b.lastPickIndex-1)c=b.lastPickIndex-1,d===fh?(b.N(c-1,b.i(c-2).x,a.y),b.N(c,b.i(c+1).x,a.y)):d===gh&&(b.N(c-1,a.x,b.i(c-2).y),b.N(c,a.x,b.i(c+1).y));else{d=c;var e=b.i(d),f=b.i(d-1),g=b.i(d+1);K.B(f.x,
e.x)&&K.B(e.y,g.y)?(K.B(f.x,b.i(d-2).x)&&!K.B(f.y,b.i(d-2).y)?(b.m(d,a.x,f.y),c++,d++):b.N(d-1,a.x,f.y),K.B(g.y,b.i(d+2).y)&&!K.B(g.x,b.i(d+2).x)?b.m(d+1,g.x,a.y):b.N(d+1,g.x,a.y)):K.B(f.y,e.y)&&K.B(e.x,g.x)?(K.B(f.y,b.i(d-2).y)&&!K.B(f.x,b.i(d-2).x)?(b.m(d,f.x,a.y),c++,d++):b.N(d-1,f.x,a.y),K.B(g.x,b.i(d+2).x)&&!K.B(g.y,b.i(d+2).y)?b.m(d+1,a.x,g.y):b.N(d+1,a.x,g.y)):K.B(f.x,e.x)&&K.B(e.x,g.x)?(K.B(f.x,b.i(d-2).x)&&!K.B(f.y,b.i(d-2).y)?(b.m(d,a.x,f.y),c++,d++):b.N(d-1,a.x,f.y),K.B(g.x,b.i(d+2).x)&&
!K.B(g.y,b.i(d+2).y)?b.m(d+1,a.x,g.y):b.N(d+1,a.x,g.y)):K.B(f.y,e.y)&&K.B(e.y,g.y)&&(K.B(f.y,b.i(d-2).y)&&!K.B(f.x,b.i(d-2).x)?(b.m(d,f.x,a.y),c++,d++):b.N(d-1,f.x,a.y),K.B(g.y,b.i(d+2).y)&&!K.B(g.x,b.i(d+2).x)?b.m(d+1,g.x,a.y):b.N(d+1,g.x,a.y));b.N(c,a.x,a.y)}else b.N(c,a.x,a.y),d=b.fromNode,e=b.fromPort,null!==d&&(f=d.findVisibleNode(),null!==f&&f!==d&&(d=f,e=d.port)),1===c&&b.computeSpot(!0,e).Ob()&&(f=e.oa(qd,J.alloc()),d=b.getLinkPointFromPoint(d,e,f,a,!0,J.alloc()),b.N(0,d.x,d.y),J.free(f),
J.free(d)),d=b.toNode,e=b.toPort,null!==d&&(f=d.findVisibleNode(),null!==f&&f!==d&&(d=f,e=d.port)),c===b.pointsCount-2&&b.computeSpot(!1,e).Ob()&&(c=e.oa(qd,J.alloc()),a=b.getLinkPointFromPoint(d,e,c,a,!1,J.alloc()),b.N(b.pointsCount-1,a.x,a.y),J.free(c),J.free(a));b.nf()};ch.prototype.computeReshape=function(a){var b=this.adornedLink,c=this.handle.segmentIndex;switch(this.fv(this.handle)){case hh:return a;case fh:return new J(b.i(c).x,a.y);case gh:return new J(a.x,b.i(c).y);default:case dh:return b.i(c)}};
na.Object.defineProperties(ch.prototype,{handleArchetype:{configurable:!0,get:function(){return this.l},set:function(a){null!==a&&w(a,N,ch,"handleArchetype");this.l=a}},midHandleArchetype:{configurable:!0,get:function(){return this.w},set:function(a){null!==a&&w(a,N,ch,"midHandleArchetype");this.w=a}},handle:{configurable:!0,get:function(){return this.$a}},adornedLink:{configurable:!0,get:function(){return this.Kt}},resegmentingDistance:{configurable:!0,
enumerable:!0,get:function(){return this.L},set:function(a){z(a,"number",ch,"resegmentingDistance");this.L=a}},originalPoint:{configurable:!0,get:function(){return this.rl}},originalPoints:{configurable:!0,get:function(){return this.es}}});ch.prototype.setReshapingBehavior=ch.prototype.zm;ch.prototype.getReshapingBehavior=ch.prototype.fv;var dh=new D(ch,"None",0),gh=new D(ch,"Horizontal",1),fh=new D(ch,"Vertical",2),hh=new D(ch,"All",3);ch.className="LinkReshapingTool";
ch.None=dh;ch.Horizontal=gh;ch.Vertical=fh;ch.All=hh;Za("linkReshapingTool",function(){return this.findTool("LinkReshaping")},function(a){If(this,"LinkReshaping",a,this.mouseDownTools)});
function jh(){0<arguments.length&&Da(jh);vf.call(this);this.name="Resizing";this.Qf=(new Zb(1,1)).freeze();this.Pf=(new Zb(9999,9999)).freeze();this.Cg=(new Zb(NaN,NaN)).freeze();this.w=!1;this.Yb=null;var a=new Gg;a.alignmentFocus=qd;a.figure="Rectangle";a.desiredSize=tc;a.fill="lightblue";a.stroke="dodgerblue";a.strokeWidth=1;a.cursor="pointer";this.l=a;this.$a=null;this.rl=new J;this.Iw=new Zb;this.Lo=new J;this.au=new Zb(0,0);this.$t=new Zb(Infinity,Infinity);this.Zt=new Zb(1,1);this.Fw=!0}
ma(jh,vf);jh.prototype.updateAdornments=function(a){if(!(null===a||a instanceof Q)){if(a.isSelected&&!this.diagram.isReadOnly){var b=a.resizeObject,c=a.Yj(this.name);if(null!==b&&a.canResize()&&a.actualBounds.o()&&a.isVisible()&&b.actualBounds.o()&&b.tf()){if(null===c||c.adornedObject!==b)c=this.makeAdornment(b);if(null!==c){b=b.Hi();Cg(a)&&this.updateResizeHandles(c,b);a.lh(this.name,c);return}}}a.uf(this.name)}};
jh.prototype.makeAdornment=function(a){var b=a.part.resizeAdornmentTemplate;if(null===b){b=new Cf;b.type=W.Spot;b.locationSpot=qd;var c=new kh;c.isPanelMain=!0;b.add(c);b.add(this.makeHandle(a,fd));b.add(this.makeHandle(a,hd));b.add(this.makeHandle(a,ud));b.add(this.makeHandle(a,sd));b.add(this.makeHandle(a,Vd));b.add(this.makeHandle(a,Xd));b.add(this.makeHandle(a,de));b.add(this.makeHandle(a,Wd))}else if(lh(b),b=b.copy(),null===b)return null;b.adornedObject=a;return b};
jh.prototype.makeHandle=function(a,b){a=this.handleArchetype;if(null===a)return null;a=a.copy();a.alignment=b;return a};
jh.prototype.updateResizeHandles=function(a,b){if(null!==a)if(!a.alignment.Db()&&("pointer"===a.cursor||0<a.cursor.indexOf("resize")))a:{var c=a.alignment;c.Ob()&&(c=qd);if(0>=c.x)b=0>=c.y?b+225:1<=c.y?b+135:b+180;else if(1<=c.x)0>=c.y?b+=315:1<=c.y&&(b+=45);else if(0>=c.y)b+=270;else if(1<=c.y)b+=90;else break a;0>b?b+=360:360<=b&&(b-=360);a.cursor=22.5>b?"e-resize":67.5>b?"se-resize":112.5>b?"s-resize":157.5>b?"sw-resize":202.5>b?"w-resize":247.5>b?"nw-resize":292.5>b?"n-resize":337.5>b?"ne-resize":
"e-resize"}else if(a instanceof W)for(a=a.elements;a.next();)this.updateResizeHandles(a.value,b)};jh.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!a.isReadOnly&&a.allowResize&&a.lastInput.left?null!==this.findToolHandleAt(a.firstInput.documentPoint,this.name):!1};
jh.prototype.doActivate=function(){var a=this.diagram;this.$a=this.findToolHandleAt(a.firstInput.documentPoint,this.name);null!==this.$a&&(this.Yb=this.$a.part.adornedObject,this.rl.set(this.adornedObject.oa(this.handle.alignment.sv())),this.Lo.set(this.Yb.part.location),this.Iw.set(this.Yb.desiredSize),this.Zt=this.computeCellSize(),this.au=this.computeMinSize(),this.$t=this.computeMaxSize(),a.isMouseCaptured=!0,this.Fw=a.animationManager.isEnabled,a.animationManager.isEnabled=!1,this.Ca(this.name),
this.isActive=!0)};jh.prototype.doDeactivate=function(){var a=this.diagram;this.wg();this.Yb=this.$a=null;this.isActive=a.isMouseCaptured=!1;a.animationManager.isEnabled=this.Fw};jh.prototype.doCancel=function(){null!==this.adornedObject&&(this.adornedObject.desiredSize=this.originalDesiredSize,this.adornedObject.part.location=this.originalLocation);this.stopTool()};
jh.prototype.doMouseMove=function(){var a=this.diagram;if(this.isActive){var b=this.au,c=this.$t,d=this.Zt,e=this.adornedObject.Zs(a.lastInput.documentPoint,J.alloc()),f=this.computeReshape();b=this.computeResize(e,this.handle.alignment,b,c,d,f);this.resize(b);a.kd();J.free(e)}};
jh.prototype.doMouseUp=function(){var a=this.diagram;if(this.isActive){var b=this.au,c=this.$t,d=this.Zt,e=this.adornedObject.Zs(a.lastInput.documentPoint,J.alloc()),f=this.computeReshape();b=this.computeResize(e,this.handle.alignment,b,c,d,f);this.resize(b);J.free(e);a.Ya();this.transactionResult=this.name;a.ba("PartResized",this.adornedObject,this.originalDesiredSize)}this.stopTool()};
jh.prototype.resize=function(a){var b=this.diagram,c=this.adornedObject,d=c.part;c.desiredSize=a.size;d.dc();a=this.adornedObject.oa(this.handle.alignment.sv());d instanceof wg?(c=new G,c.add(d),b.moveParts(c,this.rl.copy().$d(a),!0)):d.location=d.location.copy().$d(a).add(this.rl)};
jh.prototype.computeResize=function(a,b,c,d,e,f){b.Ob()&&(b=qd);var g=this.adornedObject.naturalBounds,h=g.x,k=g.y,l=g.x+g.width,m=g.y+g.height,n=1;if(!f){n=g.width;var p=g.height;0>=n&&(n=1);0>=p&&(p=1);n=p/n}p=J.alloc();K.Yp(a.x,a.y,h,k,e.width,e.height,p);a=g.copy();0>=b.x?0>=b.y?(a.x=Math.max(p.x,l-d.width),a.x=Math.min(a.x,l-c.width),a.width=Math.max(l-a.x,c.width),a.y=Math.max(p.y,m-d.height),a.y=Math.min(a.y,m-c.height),a.height=Math.max(m-a.y,c.height),f||(1<=a.height/a.width?(a.height=Math.max(Math.min(n*
a.width,d.height),c.height),a.width=a.height/n):(a.width=Math.max(Math.min(a.height/n,d.width),c.width),a.height=n*a.width),a.x=l-a.width,a.y=m-a.height)):1<=b.y?(a.x=Math.max(p.x,l-d.width),a.x=Math.min(a.x,l-c.width),a.width=Math.max(l-a.x,c.width),a.height=Math.max(Math.min(p.y-k,d.height),c.height),f||(1<=a.height/a.width?(a.height=Math.max(Math.min(n*a.width,d.height),c.height),a.width=a.height/n):(a.width=Math.max(Math.min(a.height/n,d.width),c.width),a.height=n*a.width),a.x=l-a.width)):(a.x=
Math.max(p.x,l-d.width),a.x=Math.min(a.x,l-c.width),a.width=l-a.x,f||(a.height=Math.max(Math.min(n*a.width,d.height),c.height),a.width=a.height/n,a.y=k+.5*(m-k-a.height))):1<=b.x?0>=b.y?(a.width=Math.max(Math.min(p.x-h,d.width),c.width),a.y=Math.max(p.y,m-d.height),a.y=Math.min(a.y,m-c.height),a.height=Math.max(m-a.y,c.height),f||(1<=a.height/a.width?(a.height=Math.max(Math.min(n*a.width,d.height),c.height),a.width=a.height/n):(a.width=Math.max(Math.min(a.height/n,d.width),c.width),a.height=n*a.width),
a.y=m-a.height)):1<=b.y?(a.width=Math.max(Math.min(p.x-h,d.width),c.width),a.height=Math.max(Math.min(p.y-k,d.height),c.height),f||(1<=a.height/a.width?(a.height=Math.max(Math.min(n*a.width,d.height),c.height),a.width=a.height/n):(a.width=Math.max(Math.min(a.height/n,d.width),c.width),a.height=n*a.width))):(a.width=Math.max(Math.min(p.x-h,d.width),c.width),f||(a.height=Math.max(Math.min(n*a.width,d.height),c.height),a.width=a.height/n,a.y=k+.5*(m-k-a.height))):0>=b.y?(a.y=Math.max(p.y,m-d.height),
a.y=Math.min(a.y,m-c.height),a.height=m-a.y,f||(a.width=Math.max(Math.min(a.height/n,d.width),c.width),a.height=n*a.width,a.x=h+.5*(l-h-a.width))):1<=b.y&&(a.height=Math.max(Math.min(p.y-k,d.height),c.height),f||(a.width=Math.max(Math.min(a.height/n,d.width),c.width),a.height=n*a.width,a.x=h+.5*(l-h-a.width)));J.free(p);return a};jh.prototype.computeReshape=function(){var a=mh;this.adornedObject instanceof Gg&&(a=nh(this.adornedObject));return!(a===oh||this.diagram.lastInput.shift)};
jh.prototype.computeMinSize=function(){var a=this.adornedObject.minSize.copy(),b=this.minSize;!isNaN(b.width)&&b.width>a.width&&(a.width=b.width);!isNaN(b.height)&&b.height>a.height&&(a.height=b.height);return a};jh.prototype.computeMaxSize=function(){var a=this.adornedObject.maxSize.copy(),b=this.maxSize;!isNaN(b.width)&&b.width<a.width&&(a.width=b.width);!isNaN(b.height)&&b.height<a.height&&(a.height=b.height);return a};
jh.prototype.computeCellSize=function(){var a=new Zb(NaN,NaN),b=this.adornedObject.part;null!==b&&(b=b.resizeCellSize,!isNaN(b.width)&&0<b.width&&(a.width=b.width),!isNaN(b.height)&&0<b.height&&(a.height=b.height));b=this.cellSize;isNaN(a.width)&&!isNaN(b.width)&&0<b.width&&(a.width=b.width);isNaN(a.height)&&!isNaN(b.height)&&0<b.height&&(a.height=b.height);b=this.diagram;(isNaN(a.width)||isNaN(a.height))&&b&&(b=b.grid,null!==b&&b.visible&&this.isGridSnapEnabled&&(b=b.gridCellSize,isNaN(a.width)&&
!isNaN(b.width)&&0<b.width&&(a.width=b.width),isNaN(a.height)&&!isNaN(b.height)&&0<b.height&&(a.height=b.height)));if(isNaN(a.width)||0===a.width||Infinity===a.width)a.width=1;if(isNaN(a.height)||0===a.height||Infinity===a.height)a.height=1;return a};
na.Object.defineProperties(jh.prototype,{handleArchetype:{configurable:!0,get:function(){return this.l},set:function(a){null!==a&&w(a,N,jh,"handleArchetype");this.l=a}},handle:{configurable:!0,get:function(){return this.$a}},adornedObject:{configurable:!0,get:function(){return this.Yb},set:function(a){null!==a&&w(a,N,jh,"adornedObject");this.Yb=a}},minSize:{configurable:!0,get:function(){return this.Qf},set:function(a){w(a,Zb,jh,"minSize");if(!this.Qf.A(a)){var b=
a.width;isNaN(b)&&(b=0);a=a.height;isNaN(a)&&(a=0);this.Qf.h(b,a)}}},maxSize:{configurable:!0,get:function(){return this.Pf},set:function(a){w(a,Zb,jh,"maxSize");if(!this.Pf.A(a)){var b=a.width;isNaN(b)&&(b=Infinity);a=a.height;isNaN(a)&&(a=Infinity);this.Pf.h(b,a)}}},cellSize:{configurable:!0,get:function(){return this.Cg},set:function(a){w(a,Zb,jh,"cellSize");this.Cg.A(a)||this.Cg.assign(a)}},isGridSnapEnabled:{configurable:!0,get:function(){return this.w},
set:function(a){z(a,"boolean",jh,"isGridSnapEnabled");this.w=a}},originalDesiredSize:{configurable:!0,get:function(){return this.Iw}},originalLocation:{configurable:!0,get:function(){return this.Lo}}});jh.className="ResizingTool";Za("resizingTool",function(){return this.findTool("Resizing")},function(a){If(this,"Resizing",a,this.mouseDownTools)});
function ph(){0<arguments.length&&Da(ph);vf.call(this);this.name="Rotating";this.Ma=45;this.ea=2;this.Lo=new J;this.Yb=null;var a=new Gg;a.figure="Ellipse";a.desiredSize=uc;a.fill="lightblue";a.stroke="dodgerblue";a.strokeWidth=1;a.cursor="pointer";this.l=a;this.$a=null;this.Hw=0;this.su=new J(NaN,NaN);this.w=0;this.L=50}ma(ph,vf);
ph.prototype.updateAdornments=function(a){if(null!==a){if(a.xh()){var b=a.rotateObject;if(b===a||b===a.path||b.isPanelMain)return}if(a.isSelected&&!this.diagram.isReadOnly&&(b=a.rotateObject,null!==b&&a.canRotate()&&a.actualBounds.o()&&a.isVisible()&&b.actualBounds.o()&&b.tf())){var c=a.Yj(this.name);if(null===c||c.adornedObject!==b)c=this.makeAdornment(b);if(null!==c){c.angle=b.Hi();null===c.placeholder&&(c.location=this.computeAdornmentLocation(b));a.lh(this.name,c);return}}a.uf(this.name)}};
ph.prototype.makeAdornment=function(a){var b=a.part.rotateAdornmentTemplate;if(null===b){b=new Cf;b.type=W.Position;b.locationSpot=qd;var c=this.handleArchetype;null!==c&&b.add(c.copy())}else if(lh(b),b=b.copy(),null===b)return null;b.adornedObject=a;return b};ph.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!a.isReadOnly&&a.allowRotate&&a.lastInput.left?null!==this.findToolHandleAt(a.firstInput.documentPoint,this.name):!1};
ph.prototype.doActivate=function(){var a=this.diagram;this.$a=this.findToolHandleAt(a.firstInput.documentPoint,this.name);null!==this.$a&&(this.Yb=this.$a.part.adornedObject,this.Hw=this.Yb.angle,this.su=this.computeRotationPoint(this.Yb),this.Lo=this.adornedObject.part.location.copy(),a.isMouseCaptured=!0,a.delaysLayout=!0,this.Ca(this.name),this.isActive=!0)};
ph.prototype.computeRotationPoint=function(a){var b=a.part,c=b.locationObject;return b.rotationSpot.Za()?a.oa(b.rotationSpot):a===b||a===c?c.oa(b.locationSpot):a.oa(qd)};
ph.prototype.computeAdornmentLocation=function(a){var b=this.rotationPoint;b.o()||(b=this.computeRotationPoint(a));b=a.Zs(b);var c=this.handleAngle;0>c?c+=360:360<=c&&(c-=360);c=Math.round(45*Math.round(c/45));var d=this.handleDistance;0===c?b.x=a.naturalBounds.width+d:45===c?(b.x=a.naturalBounds.width+d,b.y=a.naturalBounds.height+d):90===c?b.y=a.naturalBounds.height+d:135===c?(b.x=-d,b.y=a.naturalBounds.height+d):180===c?b.x=-d:225===c?(b.x=-d,b.y=-d):270===c?b.y=-d:315===c&&(b.x=a.naturalBounds.width+
d,b.y=-d);return a.oa(b)};ph.prototype.doDeactivate=function(){var a=this.diagram;this.wg();this.Yb=this.$a=null;this.su=new J(NaN,NaN);this.isActive=a.isMouseCaptured=!1};ph.prototype.doCancel=function(){this.diagram.delaysLayout=!1;this.rotate(this.originalAngle);this.stopTool()};ph.prototype.doMouseMove=function(){var a=this.diagram;this.isActive&&(a=this.computeRotate(a.lastInput.documentPoint),this.rotate(a))};
ph.prototype.doMouseUp=function(){var a=this.diagram;if(this.isActive){a.delaysLayout=!1;var b=this.computeRotate(a.lastInput.documentPoint);this.rotate(b);a.Ya();this.transactionResult=this.name;a.ba("PartRotated",this.Yb,this.originalAngle)}this.stopTool()};
ph.prototype.rotate=function(a){E&&B(a,ph,"rotate:newangle");var b=this.adornedObject;if(null!==b){b.angle=a;b=b.part;b.dc();var c=b.locationObject,d=b.rotateObject;if(c===d||c.rg(d))c=this.Lo.copy(),b.location=c.$d(this.rotationPoint).rotate(a-this.originalAngle).add(this.rotationPoint)}};
ph.prototype.computeRotate=function(a){a=this.rotationPoint.Wa(a)-this.handleAngle;var b=this.Yb.panel;null!==b&&(a-=b.Hi());360<=a?a-=360:0>a&&(a+=360);b=Math.min(Math.abs(this.snapAngleMultiple),180);var c=Math.min(Math.abs(this.snapAngleEpsilon),b/2);!this.diagram.lastInput.shift&&0<b&&0<c&&(a%b<c?a=Math.floor(a/b)*b:a%b>b-c&&(a=(Math.floor(a/b)+1)*b));360<=a?a-=360:0>a&&(a+=360);return a};
na.Object.defineProperties(ph.prototype,{handleArchetype:{configurable:!0,get:function(){return this.l},set:function(a){null!==a&&w(a,N,ph,"handleArchetype");this.l=a}},handle:{configurable:!0,get:function(){return this.$a}},adornedObject:{configurable:!0,get:function(){return this.Yb},set:function(a){null!==a&&w(a,N,ph,"adornedObject");this.Yb=a}},snapAngleMultiple:{configurable:!0,get:function(){return this.Ma},set:function(a){z(a,"number",
ph,"snapAngleMultiple");this.Ma=a}},snapAngleEpsilon:{configurable:!0,get:function(){return this.ea},set:function(a){z(a,"number",ph,"snapAngleEpsilon");this.ea=a}},originalAngle:{configurable:!0,get:function(){return this.Hw}},rotationPoint:{configurable:!0,get:function(){return this.su}},handleAngle:{configurable:!0,get:function(){return this.w},set:function(a){z(a,"number",ph,"handleAngle");this.w=a}},handleDistance:{configurable:!0,
get:function(){return this.L},set:function(a){z(a,"number",ph,"handleDistance");this.L=a}}});ph.className="RotatingTool";Za("rotatingTool",function(){return this.findTool("Rotating")},function(a){If(this,"Rotating",a,this.mouseDownTools)});function qh(){vf.call(this);0<arguments.length&&Da(qh);this.name="ClickSelecting"}ma(qh,vf);qh.prototype.canStart=function(){return!this.isEnabled||this.isBeyondDragSize()?!1:!0};
qh.prototype.doMouseUp=function(){this.isActive&&(this.standardMouseSelect(),!this.standardMouseClick()&&this.diagram.lastInput.isTouchEvent&&this.diagram.toolManager.doToolTip());this.stopTool()};qh.className="ClickSelectingTool";function rh(){vf.call(this);0<arguments.length&&Da(rh);this.name="Action";this.tk=null}ma(rh,vf);
rh.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram,b=a.lastInput,c=a.Tb(b.documentPoint,function(a){for(;null!==a.panel&&!a.isActionable;)a=a.panel;return a});if(null!==c){if(!c.isActionable)return!1;this.tk=c;a.Gk=a.Tb(b.documentPoint,null,null);return!0}return!1};rh.prototype.doMouseDown=function(){if(this.isActive){var a=this.diagram.lastInput,b=this.tk;null!==b&&(a.targetObject=b,null!==b.actionDown&&b.actionDown(a,b))}else this.canStart()&&this.doActivate()};
rh.prototype.doMouseMove=function(){if(this.isActive){var a=this.diagram.lastInput,b=this.tk;null!==b&&(a.targetObject=b,null!==b.actionMove&&b.actionMove(a,b))}};rh.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram.lastInput,b=this.tk;if(null===b)return;a.targetObject=b;null!==b.actionUp&&b.actionUp(a,b);this.standardMouseClick(function(a){for(;null!==a.panel&&(!a.isActionable||a!==b);)a=a.panel;return a},function(a){return a===b})}this.stopTool()};
rh.prototype.doCancel=function(){var a=this.diagram.lastInput,b=this.tk;null!==b&&(a.targetObject=b,null!==b.actionCancel&&b.actionCancel(a,b),this.stopTool())};rh.prototype.doStop=function(){this.tk=null};rh.className="ActionTool";function sh(){vf.call(this);0<arguments.length&&Da(sh);this.name="ClickCreating";this.Zi=null;this.w=!0;this.l=!1;this.zw=new J(0,0)}ma(sh,vf);
sh.prototype.canStart=function(){if(!this.isEnabled||null===this.archetypeNodeData)return!1;var a=this.diagram;if(a.isReadOnly||a.isModelReadOnly||!a.allowInsert||!a.lastInput.left||this.isBeyondDragSize())return!1;if(this.isDoubleClick){if(1===a.lastInput.clickCount&&(this.zw=a.lastInput.viewPoint.copy()),2!==a.lastInput.clickCount||this.isBeyondDragSize(this.zw))return!1}else if(1!==a.lastInput.clickCount)return!1;return a.currentTool!==this&&null!==a.bm(a.lastInput.documentPoint,!0)?!1:!0};
sh.prototype.doMouseUp=function(){var a=this.diagram;this.isActive&&this.insertPart(a.lastInput.documentPoint);this.stopTool()};
sh.prototype.insertPart=function(a){var b=this.diagram,c=this.archetypeNodeData;if(null===c)return null;this.Ca(this.name);var d=null;c instanceof R?c.fc()&&(lh(c),d=c.copy(),null!==d&&b.add(d)):null!==c&&(c=b.model.copyNodeData(c),Ia(c)&&(b.model.lf(c),d=b.zc(c)));null!==d&&(c=J.allocAt(a.x,a.y),this.isGridSnapEnabled&&th(this.diagram,d,a,c),d.location=c,b.allowSelect&&b.select(d),J.free(c));b.Ya();this.transactionResult=this.name;b.ba("PartCreated",d);this.wg();return d};
na.Object.defineProperties(sh.prototype,{archetypeNodeData:{configurable:!0,get:function(){return this.Zi},set:function(a){null!==a&&z(a,"object",sh,"archetypeNodeData");this.Zi=a}},isDoubleClick:{configurable:!0,get:function(){return this.w},set:function(a){z(a,"boolean",sh,"isDoubleClick");this.w=a}},isGridSnapEnabled:{configurable:!0,get:function(){return this.l},set:function(a){z(a,"boolean",sh,"isGridSnapEnabled");this.l=a}}});sh.className="ClickCreatingTool";
function uh(){vf.call(this);0<arguments.length&&Da(uh);this.name="DragSelecting";this.Nk=175;this.w=!1;var a=new R;a.layerName="Tool";a.selectable=!1;var b=new Gg;b.name="SHAPE";b.figure="Rectangle";b.fill=null;b.stroke="magenta";a.add(b);this.l=a}ma(uh,vf);
uh.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(!a.allowSelect)return!1;var b=a.lastInput;return!b.left||a.currentTool!==this&&(!this.isBeyondDragSize()||b.timestamp-a.firstInput.timestamp<this.delay||null!==a.bm(b.documentPoint,!0))?!1:!0};uh.prototype.doActivate=function(){var a=this.diagram;this.isActive=!0;a.isMouseCaptured=!0;a.skipsUndoManager=!0;a.add(this.box);this.doMouseMove()};
uh.prototype.doDeactivate=function(){var a=this.diagram;a.wf();a.remove(this.box);a.skipsUndoManager=!1;this.isActive=a.isMouseCaptured=!1};uh.prototype.doMouseMove=function(){var a=this.diagram;if(this.isActive&&null!==this.box){var b=this.computeBoxBounds(),c=this.box.cb("SHAPE");null===c&&(c=this.box.Cb());var d=Zb.alloc().h(b.width,b.height);b=J.alloc().h(b.x,b.y);c.desiredSize=d;this.box.position=b;Zb.free(d);J.free(b);(a.allowHorizontalScroll||a.allowVerticalScroll)&&a.Rs(a.lastInput.viewPoint)}};
uh.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram;a.remove(this.box);try{a.currentCursor="wait",a.ba("ChangingSelection",a.selection),this.selectInRect(this.computeBoxBounds()),a.ba("ChangedSelection",a.selection)}finally{a.currentCursor=""}}this.stopTool()};uh.prototype.computeBoxBounds=function(){var a=this.diagram;return new L(a.firstInput.documentPoint,a.lastInput.documentPoint)};
uh.prototype.selectInRect=function(a){var b=this.diagram,c=b.lastInput;a=b.nx(a,this.isPartialInclusion);if(kb?c.meta:c.control)if(c.shift)for(a=a.iterator;a.next();)b=a.value,b.isSelected&&(b.isSelected=!1);else for(a=a.iterator;a.next();)b=a.value,b.isSelected=!b.isSelected;else if(c.shift)for(a=a.iterator;a.next();)b=a.value,b.isSelected||(b.isSelected=!0);else{c=new G;for(b=b.selection.iterator;b.next();){var d=b.value;a.contains(d)||c.add(d)}for(b=c.iterator;b.next();)b.value.isSelected=!1;for(a=
a.iterator;a.next();)b=a.value,b.isSelected||(b.isSelected=!0)}};na.Object.defineProperties(uh.prototype,{delay:{configurable:!0,get:function(){return this.Nk},set:function(a){z(a,"number",uh,"delay");this.Nk=a}},isPartialInclusion:{configurable:!0,get:function(){return this.w},set:function(a){z(a,"boolean",uh,"isPartialInclusion");this.w=a}},box:{configurable:!0,get:function(){return this.l},set:function(a){null!==a&&w(a,R,uh,"box");this.l=a}}});
uh.className="DragSelectingTool";function vh(){vf.call(this);0<arguments.length&&Da(vh);this.name="Panning";this.ou=new J;this.gy=new J;this.Bg=!1;var a=this;this.Lw=function(){qa.document.removeEventListener("scroll",a.Lw,!1);a.stopTool()}}ma(vh,vf);vh.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!a.allowHorizontalScroll&&!a.allowVerticalScroll||!a.lastInput.left||a.currentTool!==this&&!this.isBeyondDragSize()?!1:!0};
vh.prototype.doActivate=function(){var a=this.diagram;this.Bg?(a.lastInput.bubbles=!0,qa.document.addEventListener("scroll",this.Lw,!1)):(a.currentCursor="move",a.isMouseCaptured=!0,this.ou.assign(a.position));this.isActive=!0};vh.prototype.doDeactivate=function(){var a=this.diagram;a.currentCursor="";this.isActive=a.isMouseCaptured=!1};vh.prototype.doCancel=function(){var a=this.diagram;a.position=this.ou;a.isMouseCaptured=!1;this.stopTool()};vh.prototype.doMouseMove=function(){this.move()};
vh.prototype.doMouseUp=function(){this.move();this.stopTool()};vh.prototype.move=function(){var a=this.diagram;if(this.isActive&&a)if(this.Bg)a.lastInput.bubbles=!0;else{var b=a.position,c=a.firstInput.documentPoint,d=a.lastInput.documentPoint,e=b.x+c.x-d.x;c=b.y+c.y-d.y;a.allowHorizontalScroll||(e=b.x);a.allowVerticalScroll||(c=b.y);a.position=this.gy.h(e,c)}};
na.Object.defineProperties(vh.prototype,{bubbles:{configurable:!0,get:function(){return this.Bg},set:function(a){z(a,"boolean",vh,"bubbles");this.Bg=a}},originalPosition:{configurable:!0,get:function(){return this.ou}}});vh.className="PanningTool";Za("clickCreatingTool",function(){return this.findTool("ClickCreating")},function(a){If(this,"ClickCreating",a,this.mouseUpTools)});
Za("clickSelectingTool",function(){return this.findTool("ClickSelecting")},function(a){If(this,"ClickSelecting",a,this.mouseUpTools)});Za("panningTool",function(){return this.findTool("Panning")},function(a){If(this,"Panning",a,this.mouseMoveTools)});Za("dragSelectingTool",function(){return this.findTool("DragSelecting")},function(a){If(this,"DragSelecting",a,this.mouseMoveTools)});Za("actionTool",function(){return this.findTool("Action")},function(a){If(this,"Action",a,this.mouseDownTools)});
function Hf(){this.ea=this.L=this.l=this.w=null}
na.Object.defineProperties(Hf.prototype,{mainElement:{configurable:!0,get:function(){return this.L},set:function(a){null!==a&&w(a,HTMLElement,Hf,"mainElement");this.L=a}},show:{configurable:!0,get:function(){return this.w},set:function(a){this.w!==a&&(null!==a&&z(a,"function",Hf,"show"),this.w=a)}},hide:{configurable:!0,get:function(){return this.l},set:function(a){this.l!==a&&(null!==a&&z(a,"function",Hf,"hide"),this.l=a)}},valueFunction:{configurable:!0,
enumerable:!0,get:function(){return this.ea},set:function(a){this.ea=a}}});Hf.className="HTMLInfo";function wh(a,b,c){this.text=a;this.ax=b;this.visible=c}wh.className="ContextMenuButtonInfo";function xh(){vf.call(this);0<arguments.length&&Da(xh);this.name="ContextMenu";this.w=this.Qt=this.l=null;this.Ew=new J;this.Rt=null;var a=this;this.Cu=function(){a.stopTool()}}ma(xh,vf);
function yh(a){var b=new Hf;b.show=function(a,b,c){c.showDefaultContextMenu()};b.hide=function(a,b){b.hideDefaultContextMenu()};zh=b;a.Cu=function(){a.stopTool()};b=xa("div");var c=xa("div");b.style.cssText="top: 0px;z-index:10002;position: fixed;display: none;text-align: center;left: 25%;width: 50%;background-color: #F5F5F5;padding: 16px;border: 16px solid #444;border-radius: 10px;margin-top: 10px";c.style.cssText="z-index:10001;position: fixed;display: none;top: 0;left: 0;width: 100%;height: 100%;background-color: black;opacity: 0.8;";
var d=xa("style");qa.document.getElementsByTagName("head")[0].appendChild(d);d.sheet.insertRule(".goCXul { list-style: none; }",0);d.sheet.insertRule(".goCXli {font:700 1.5em Helvetica, Arial, sans-serif;position: relative;min-width: 60px; }",0);d.sheet.insertRule(".goCXa {color: #444;display: inline-block;padding: 4px;text-decoration: none;margin: 2px;border: 1px solid gray;border-radius: 10px; }",0);b.addEventListener("contextmenu",Ah,!1);b.addEventListener("selectstart",Ah,!1);c.addEventListener("contextmenu",
Ah,!1);b.className="goCXforeground";c.className="goCXbackground";qa.document.body&&(qa.document.body.appendChild(b),qa.document.body.appendChild(c));Bh=b;Ch=c;Dh=!0}function Ah(a){a.preventDefault();return!1}xh.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return this.isBeyondDragSize()||!a.lastInput.right?!1:a.lastInput.isTouchEvent&&null!==this.defaultTouchContextMenu||null!==this.findObjectWithContextMenu()?!0:!1};xh.prototype.doStart=function(){this.Ew.set(this.diagram.firstInput.documentPoint)};
xh.prototype.doStop=function(){this.hideContextMenu();this.currentObject=null};xh.prototype.findObjectWithContextMenu=function(a){void 0===a&&(a=null);var b=this.diagram,c=b.lastInput,d=null;a instanceof P||(a instanceof N?d=a:d=b.Tb(c.documentPoint,null,function(a){return!a.layer.isTemporary}));if(null!==d){for(a=d;null!==a;){if(null!==a.contextMenu)return a;a=a.panel}if(b.lastInput.isTouchEvent&&this.defaultTouchContextMenu)return d.part}else if(null!==b.contextMenu)return b;return null};
xh.prototype.doActivate=function(){};xh.prototype.doMouseDown=function(){vf.prototype.doMouseDown.call(this);if(this.isActive&&this.currentContextMenu instanceof Cf){var a=this.diagram.toolManager.findTool("Action");null!==a&&a.canStart()&&(a.doActivate(),a.doMouseDown(),a.doDeactivate())}this.diagram.toolManager.mouseDownTools.contains(this)&&Eh(this)};
xh.prototype.doMouseUp=function(){if(this.isActive&&this.currentContextMenu instanceof Cf){var a=this.diagram.toolManager.findTool("Action");null!==a&&a.canStart()&&(a.doActivate(),a.doCancel(),a.doDeactivate())}Eh(this)};
function Eh(a){var b=a.diagram;if(a.isActive){var c=a.currentContextMenu;if(null!==c){if(!(c instanceof Hf)){var d=b.Tb(b.lastInput.documentPoint,null,null);null!==d&&d.rg(c)&&a.standardMouseClick(null,null)}a.stopTool();a.canStart()&&(b.currentTool=a,a.doMouseUp())}}else a.canStart()&&(Fh(a,!0),a.isActive||a.stopTool())}
function Fh(a,b,c){void 0===c&&(c=null);b&&a.standardMouseSelect();if(!a.standardMouseClick())if(a.isActive=!0,b=zh,null===c&&(c=a.findObjectWithContextMenu()),null!==c){var d=c.contextMenu;null!==d?(a.currentObject=c instanceof N?c:null,a.showContextMenu(d,a.currentObject)):null!==b&&a.showContextMenu(b,a.currentObject)}else null!==b&&a.showContextMenu(b,null)}xh.prototype.doMouseMove=function(){var a=this.diagram.toolManager.findTool("Action");null!==a&&a.doMouseMove();this.isActive&&this.diagram.toolManager.doMouseMove()};
xh.prototype.showContextMenu=function(a,b){!E||a instanceof Cf||a instanceof Hf||v("showContextMenu:contextMenu must be an Adornment or HTMLInfo.");null!==b&&w(b,N,xh,"showContextMenu:obj");var c=this.diagram;a!==this.currentContextMenu&&this.hideContextMenu();if(a instanceof Cf){a.layerName="Tool";a.selectable=!1;a.scale=1/c.scale;a.category=this.name;null!==a.placeholder&&(a.placeholder.scale=c.scale);var d=a.diagram;null!==d&&d!==c&&d.remove(a);c.add(a);null!==b?(c=null,d=b.th(),null!==d&&(c=d.data),
a.adornedObject=b,a.data=c):a.data=c.model;a.dc();this.positionContextMenu(a,b)}else a instanceof Hf&&a.show(b,c,this);this.currentContextMenu=a};xh.prototype.positionContextMenu=function(a){if(null===a.placeholder){var b=this.diagram,c=b.lastInput.documentPoint.copy(),d=a.measuredBounds,e=b.viewportBounds;b.lastInput.isTouchEvent&&(c.x-=d.width);c.x+d.width>e.right&&(c.x-=d.width+5/b.scale);c.x<e.x&&(c.x=e.x);c.y+d.height>e.bottom&&(c.y-=d.height+5/b.scale);c.y<e.y&&(c.y=e.y);a.position=c}};
xh.prototype.hideContextMenu=function(){var a=this.diagram,b=this.currentContextMenu;null!==b&&(b instanceof Cf?(a.remove(b),null!==this.Qt&&this.Qt.uf(b.category),b.data=null,b.adornedObject=null):b instanceof Hf&&(null!==b.hide?b.hide(a,this):null!==b.mainElement&&(b.mainElement.style.display="none")),this.currentContextMenu=null,this.standardMouseOver())};
function Gh(){var a=new G;a.add(new wh("Copy",function(a){a.commandHandler.copySelection()},function(a){return a.commandHandler.canCopySelection()}));a.add(new wh("Cut",function(a){a.commandHandler.cutSelection()},function(a){return a.commandHandler.canCutSelection()}));a.add(new wh("Delete",function(a){a.commandHandler.deleteSelection()},function(a){return a.commandHandler.canDeleteSelection()}));a.add(new wh("Paste",function(a){a.commandHandler.pasteSelection(a.lastInput.documentPoint)},function(a){return a.commandHandler.canPasteSelection()}));
a.add(new wh("Select All",function(a){a.commandHandler.selectAll()},function(a){return a.commandHandler.canSelectAll()}));a.add(new wh("Undo",function(a){a.commandHandler.undo()},function(a){return a.commandHandler.canUndo()}));a.add(new wh("Redo",function(a){a.commandHandler.redo()},function(a){return a.commandHandler.canRedo()}));a.add(new wh("Scroll To Part",function(a){a.commandHandler.scrollToPart()},function(a){return a.commandHandler.canScrollToPart()}));a.add(new wh("Zoom To Fit",function(a){a.commandHandler.zoomToFit()},
function(a){return a.commandHandler.canZoomToFit()}));a.add(new wh("Reset Zoom",function(a){a.commandHandler.resetZoom()},function(a){return a.commandHandler.canResetZoom()}));a.add(new wh("Group Selection",function(a){a.commandHandler.groupSelection()},function(a){return a.commandHandler.canGroupSelection()}));a.add(new wh("Ungroup Selection",function(a){a.commandHandler.ungroupSelection()},function(a){return a.commandHandler.canUngroupSelection()}));a.add(new wh("Edit Text",function(a){a.commandHandler.editTextBlock()},
function(a){return a.commandHandler.canEditTextBlock()}));return a}
xh.prototype.showDefaultContextMenu=function(){var a=this.diagram;null===this.Rt&&(this.Rt=Gh());Bh.innerHTML="";Ch.addEventListener("click",this.Cu,!1);var b=this,c=xa("ul");c.className="goCXul";Bh.appendChild(c);c.innerHTML="";for(var d=this.Rt.iterator;d.next();){var e=d.value,f=e.visible;if("function"===typeof e.ax&&("function"!==typeof f||f(a))){f=xa("li");f.className="goCXli";var g=xa("a");g.className="goCXa";g.href="#";g.Wx=e.ax;g.addEventListener("click",function(c){this.Wx(a);b.stopTool();
c.preventDefault();return!1},!1);g.textContent=e.text;f.appendChild(g);c.appendChild(f)}}Bh.style.display="block";Ch.style.display="block"};xh.prototype.hideDefaultContextMenu=function(){null!==this.currentContextMenu&&this.currentContextMenu===zh&&(Bh.style.display="none",Ch.style.display="none",Ch.removeEventListener("click",this.Cu,!1),this.currentContextMenu=null)};
na.Object.defineProperties(xh.prototype,{currentContextMenu:{configurable:!0,get:function(){return this.l},set:function(a){!E||null===a||a instanceof Cf||a instanceof Hf||v("ContextMenuTool.currentContextMenu must be an Adornment or HTMLInfo.");this.l=a;this.Qt=a instanceof Cf?a.adornedPart:null}},defaultTouchContextMenu:{configurable:!0,get:function(){!1===Dh&&null===zh&&Hh&&yh(this);return zh},set:function(a){!E||null===a||a instanceof Cf||a instanceof Hf||v("ContextMenuTool.defaultTouchContextMenu must be an Adornment or HTMLInfo.");
null===a&&(Dh=!0);zh=a}},currentObject:{configurable:!0,get:function(){return this.w},set:function(a){null!==a&&w(a,N,xh,"currentObject");this.w=a}},mouseDownPoint:{configurable:!0,get:function(){return this.Ew}}});var zh=null,Dh=!1,Ch=null,Bh=null;xh.className="ContextMenuTool";Za("contextMenuTool",function(){return this.findTool("ContextMenu")},function(a){If(this,"ContextMenu",a,this.mouseUpTools)});
function Ih(){0<arguments.length&&Da(Ih);vf.call(this);this.name="TextEditing";this.fh=new Jh;this.Xa=null;this.Ma=Kh;this.ui=null;this.na=Lh;this.L=1;this.ea=!0;this.w=null;this.l=new Hf;this.St=null;Mh(this,this.l)}ma(Ih,vf);
function Mh(a,b){if(Hh){var c=xa("textarea");a.St=c;c.addEventListener("input",function(){if(null!==a.textBlock){var b=a.yx(this.value);this.style.width=20+b.measuredBounds.width*this.$z+"px";this.rows=b.lineCount}},!1);c.addEventListener("keydown",function(b){if(null!==a.textBlock){var c=b.which;13===c?(!1===a.textBlock.isMultiline&&b.preventDefault(),a.acceptText(Nh)):9===c?(a.acceptText(Oh),b.preventDefault()):27===c&&(a.doCancel(),null!==a.diagram&&a.diagram.doFocus())}},!1);c.addEventListener("focus",
function(){if(null!==a.currentTextEditor&&a.state!==Lh){var b=a.St;a.na===Ph&&(a.na=Qh);"function"===typeof b.select&&a.selectsTextOnActivate&&(b.select(),b.setSelectionRange(0,9999))}},!1);c.addEventListener("blur",function(){if(null!==a.currentTextEditor&&a.state!==Lh){var b=a.St;"function"===typeof b.focus&&b.focus();"function"===typeof b.select&&a.selectsTextOnActivate&&(b.select(),b.setSelectionRange(0,9999))}},!1);b.valueFunction=function(){return c.value};b.mainElement=c;b.show=function(a,
b,f){if(a instanceof Jh&&f instanceof Ih)if(f.state===Rh)c.style.border="3px solid red",c.focus();else{var d=a.oa(qd),e=b.position,k=b.scale,l=a.Fe()*k;l<f.minimumEditorScale&&(l=f.minimumEditorScale);var m=a.naturalBounds.width*l+6,n=a.naturalBounds.height*l+2,p=(d.x-e.x)*k;d=(d.y-e.y)*k;c.value=a.text;b.div.style.font=a.font;c.style.position="absolute";c.style.zIndex="100";c.style.font="inherit";c.style.fontSize=100*l+"%";c.style.lineHeight="normal";c.style.width=m+"px";c.style.left=(p-m/2|0)-1+
"px";c.style.top=(d-n/2|0)-1+"px";c.style.textAlign=a.textAlign;c.style.margin="0";c.style.padding="1px";c.style.border="0";c.style.outline="none";c.style.whiteSpace="pre-wrap";c.style.overflow="hidden";c.rows=a.lineCount;c.$z=l;c.className="goTXarea";b.div.appendChild(c);c.focus();f.selectsTextOnActivate&&(c.select(),c.setSelectionRange(0,9999))}};b.hide=function(a){a.div.removeChild(c)}}}
Ih.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(null===a||a.isReadOnly||!a.lastInput.left||this.isBeyondDragSize())return!1;var b=a.Tb(a.lastInput.documentPoint);if(!(null!==b&&b instanceof Jh&&b.editable&&b.part.canEdit()))return!1;b=b.part;return null===b||this.starting===Kh&&!b.isSelected||this.starting===Sh&&2>a.lastInput.clickCount?!1:!0};Ih.prototype.doStart=function(){this.isActive||null===this.textBlock||this.doActivate()};
Ih.prototype.doActivate=function(){if(!this.isActive){var a=this.diagram;if(null!==a){var b=this.textBlock;null===b&&(b=a.Tb(a.lastInput.documentPoint));if(null!==b&&b instanceof Jh&&(this.textBlock=b,null!==b.part)){this.isActive=!0;this.na=Ph;var c=this.defaultTextEditor;null!==b.textEditor&&(c=b.textEditor);this.fh=this.textBlock.copy();var d=new L(this.textBlock.oa(fd),this.textBlock.oa(ud));a.Gv(d);c.show(b,a,this);this.currentTextEditor=c}}}};Ih.prototype.doCancel=function(){this.stopTool()};
Ih.prototype.doMouseUp=function(){!this.isActive&&this.canStart()&&this.doActivate()};Ih.prototype.doMouseDown=function(){this.isActive&&this.acceptText(Th)};
Ih.prototype.acceptText=function(a){switch(a){case Th:if(this.na===Uh)this.currentTextEditor instanceof HTMLElement&&this.currentTextEditor.focus();else if(this.na===Ph||this.na===Rh||this.na===Qh)this.na=Vh,Wh(this);break;case Xh:case Nh:case Oh:if(Nh!==a||!0!==this.textBlock.isMultiline)if(this.na===Ph||this.na===Rh||this.na===Qh)this.na=Vh,Wh(this)}};
function Wh(a){var b=a.textBlock,c=a.diagram,d=a.currentTextEditor;if(null!==b&&null!==d){var e=b.text,f="";null!==d.valueFunction&&(f=d.valueFunction());a.isValidText(b,e,f)?(a.Ca(a.name),a.na=Uh,a.transactionResult=a.name,b.text=f,null!==b.textEdited&&b.textEdited(b,e,f),null!==c&&c.ba("TextEdited",b,e),a.wg(),a.stopTool(),null!==c&&c.doFocus()):(a.na=Rh,null!==b.errorFunction&&b.errorFunction(a,e,f),d.show(b,c,a))}}
Ih.prototype.doDeactivate=function(){var a=this.diagram;null!==a&&(this.na=Lh,this.textBlock=null,null!==this.currentTextEditor&&this.currentTextEditor.hide(a,this),this.isActive=!1)};Ih.prototype.isValidText=function(a,b,c){w(a,Jh,Ih,"isValidText:textblock");var d=this.textValidation;if(null!==d&&!d(a,b,c))return!1;d=a.textValidation;return null===d||d(a,b,c)?!0:!1};Ih.prototype.yx=function(a){var b=this.fh;b.text=a;b.measure(this.textBlock.gl,Infinity);return b};
na.Object.defineProperties(Ih.prototype,{textBlock:{configurable:!0,get:function(){return this.Xa},set:function(a){null!==a&&w(a,Jh,Ih,"textBlock");this.Xa=a}},currentTextEditor:{configurable:!0,get:function(){return this.w},set:function(a){this.w=a}},defaultTextEditor:{configurable:!0,get:function(){return this.l},set:function(a){!E||a instanceof Hf||v("TextEditingTool.defaultTextEditor must be an HTMLInfo.");this.l=a}},starting:{configurable:!0,
get:function(){return this.Ma},set:function(a){tb(a,Ih,Ih,"starting");this.Ma=a}},textValidation:{configurable:!0,get:function(){return this.ui},set:function(a){null!==a&&z(a,"function",Ih,"textValidation");this.ui=a}},minimumEditorScale:{configurable:!0,get:function(){return this.L},set:function(a){null!==a&&z(a,"number",Ih,"minimumEditorScale");this.L=a}},selectsTextOnActivate:{configurable:!0,get:function(){return this.ea},set:function(a){null!==a&&z(a,
"boolean",Ih,"selectsTextOnActivate");this.ea=a}},state:{configurable:!0,get:function(){return this.na},set:function(a){this.na!==a&&(tb(a,Ih,Ih,"starting"),this.na=a)}}});Ih.prototype.measureTemporaryTextBlock=Ih.prototype.yx;
var Xh=new D(Ih,"LostFocus",0),Th=new D(Ih,"MouseDown",1),Oh=new D(Ih,"Tab",2),Nh=new D(Ih,"Enter",3),Yh=new D(Ih,"SingleClick",0),Kh=new D(Ih,"SingleClickSelected",1),Sh=new D(Ih,"DoubleClick",2),Lh=new D(Ih,"StateNone",0),Ph=new D(Ih,"StateActive",1),Qh=new D(Ih,"StateEditing",2),Vh=new D(Ih,"StateValidating",3),Rh=new D(Ih,"StateInvalid",4),Uh=new D(Ih,"StateValidated",5);Ih.className="TextEditingTool";Ih.LostFocus=Xh;Ih.MouseDown=Th;Ih.Tab=Oh;Ih.Enter=Nh;Ih.SingleClick=Yh;
Ih.SingleClickSelected=Kh;Ih.DoubleClick=Sh;Ih.StateNone=Lh;Ih.StateActive=Ph;Ih.StateEditing=Qh;Ih.StateValidating=Vh;Ih.StateInvalid=Rh;Ih.StateValidated=Uh;Za("textEditingTool",function(){return this.findTool("TextEditing")},function(a){If(this,"TextEditing",a,this.mouseUpTools)});
function Zh(){this.rw=bi;this.G=yf;this.un=this.vn=null;this.Yi=this.wn=this.xn=0;this.xk=this.bg=this.tb=this.Ir=this.ai=!1;this.Qg=this.Hc=!0;this.ar=this.$q=this.qw=null;this.pw=0;this.br=new Ub;this.Sm=new H;this.Yt=600;this.Yx=new J(0,0);this.nw=this.mw=this.Ow=!1;this.wj=new Ub}Zh.prototype.ob=function(a){this.G=a};function bi(a,b,c,d){a/=d/2;return 1>a?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b}Zh.prototype.canStart=function(){return!0};t=Zh.prototype;
t.Qi=function(a){this.Hc&&(this.Qg||this.G.Ni)&&(this.Sm.add(a),this.canStart(a)&&(this.ai&&this.zd(),this.bg=this.tb=!0))};t.Mz=function(a){this.Hc&&(this.Qg||this.G.Ni)&&(this.Sm.add(a),this.canStart(a)&&(this.ai&&this.zd(),this.tb=!0))};
function ci(a){if(a.Hc&&(a.Sm.clear(),a.tb))if(!a.xk)a.tb=!1,a.bg=!1;else if(0===a.Yi){var b=+new Date;a.Yi=b;qa.requestAnimationFrame(function(){if(!1!==a.tb&&!a.ai&&a.Yi===b){var c=a.G;c.Ge("temporaryPixelRatio")&&(c.ye=1);di(c);a.tb=!1;a.bg=!1;c.ba("AnimationStarting");ei(a,b)}})}}
t.nh=function(a,b,c,d,e){if(!(!this.tb||(E&&w(a,N,Zh,"addToAnimation:obj"),"position"===b&&c.A(d))||a instanceof R&&!a.isAnimated)){var f=!1;if("delete"===b&&a instanceof R){f=!0;b="scale";c=1;d=.1;e=!0;var g=a.diagram;a=a.copy();a.data=null;g.add(a)}g=this.wj;if(g.contains(a)){var h=g.K(a);g=h.start;var k=h.end;void 0===g[b]&&(g[b]=fi(c));h.Ps&&void 0!==k[b]?h.Vp[b]=fi(d):(e||(h.Vp[b]=fi(d)),k[b]=fi(d))}else h={},k={},h[b]=fi(c),k[b]=fi(d),c=h.position,c instanceof J&&!c.o()&&this.Sm.contains("Expand SubGraph")&&
c.assign(k.position),h=new gi(h,k,e),g.add(a,h);e&&0===b.indexOf("position:")&&a instanceof R&&(h.Vp.location=fi(a.location));e&&f&&(h.Vp.scale=.001);this.xk=!0}};function fi(a){return a instanceof J?a.copy():a instanceof Zb?a.copy():a}
function ei(a,b){var c;function d(){if(!1!==f.ai&&f.Yi===b){var a=+new Date,c=a>r?l:a-q;hi(f);ii(f,e,p,g,c,l);f.$q&&f.$q();Dg(e);ji(f);a>r?ki(f):qa.requestAnimationFrame(d)}}void 0===c&&(c={});var e=a.G;if(null!==e){var f=a,g=c.jA||a.rw,h=c.oA||null,k=c.pA||null,l=c.duration||a.Yt,m=a.Yx;for(c=a.wj.iterator;c.next();){var n=c.value.start.position;n instanceof J&&(n.o()||n.assign(m))}a.qw=g;a.$q=h;a.ar=k;a.pw=l;a.br=a.wj;var p=a.br;for(c=p.iterator;c.next();)h=c.value.end,h["position:placeholder"]&&
(k=c.key.findVisibleNode(),k instanceof wg&&null!==k.placeholder&&(m=k.placeholder,k=m.oa(fd),m=m.padding,k.x+=m.left,k.y+=m.top,h["position:placeholder"]=k));a.ai=!0;hi(a);ii(a,e,p,g,0,l);Dg(a.G,!0);ji(a);var q=+new Date,r=q+l;f.Yi===b&&qa.requestAnimationFrame(function(){d()})}}function hi(a){if(!a.Ir){var b=a.G;a.Ow=b.skipsUndoManager;a.mw=b.skipsModelSourceBindings;a.nw=b.Ti;b.skipsUndoManager=!0;b.skipsModelSourceBindings=!0;b.Ti=!0;a.Ir=!0}}
function ji(a){var b=a.G;b.skipsUndoManager=a.Ow;b.skipsModelSourceBindings=a.mw;b.Ti=a.nw;a.Ir=!1}function ii(a,b,c,d,e,f){for(c=c.iterator;c.next();){var g=c.key,h=c.value,k=h.start;h=h.end;for(var l in h)if(("position"!==l||!h["position:placeholder"]&&!h["position:node"])&&void 0!==li[l])li[l](g,k[l],h[l],d,e,f)}d=b.lv;b.lv=!0;l=a.rw;0!==a.xn&&0!==a.wn&&(c=a.xn,b.Da=l(e,c,a.wn-c,f));null!==a.vn&&null!==a.un&&(c=a.vn,a=a.un,b.ua=new J(l(e,c.x,a.x-c.x,f),l(e,c.y,a.y-c.y,f)));b.lv=d}
t.zd=function(){!0===this.tb&&(this.bg=this.tb=!1,this.Yi=0,this.xk&&this.G.gc());this.ai&&this.Hc&&ki(this)};
function ki(a){a.ai=!1;a.xk=!1;hi(a);for(var b=a.G,c=a.qw,d=a.pw,e=a.br.iterator;e.next();){var f=e.key,g=e.value,h=g.start,k=g.end,l=g.Vp,m;for(m in k)if(void 0!==li[m]){var n=m;!g.Ps||"position:node"!==n&&"position:placeholder"!==n||(n="position");li[n](f,h[m],void 0!==l[m]?l[m]:g.Ps?h[m]:k[m],c,d,d)}g.Ps&&void 0!==l.location&&f instanceof R&&(f.location=l.location);g.st&&f instanceof R&&f.Pb(!1)}for(c=a.G.links;c.next();)d=c.value,null!==d.wl&&(d.points=d.wl,d.wl=null);b.jt.clear();gg(b,!1);b.Ya();
b.S();b.kd();mi(b);ji(a);a.ar&&a.ar();a.Yi=0;a.br=new Ub;a.ar=null;a.$q=null;a.vn=null;a.un=null;a.xn=0;a.wn=0;a.wj=new Ub;b.ba("AnimationFinished");b.gc()}
t.Np=function(a,b){if(this.bg){var c=a.actualBounds,d=b.actualBounds,e=null;b instanceof wg&&(e=b.placeholder);null!==e?(c=e.oa(fd),e=e.padding,c.x+=e.left,c.y+=e.top,this.nh(a,"position",c,a.position,!1)):this.nh(a,"position",new J(d.x+d.width/2-c.width/2,d.y+d.height/2-c.height/2),a.position,!1);this.nh(a,"scale",.01,a.scale,!1);if(a instanceof wg)for(a=a.memberParts;a.next();)e=a.value,e instanceof V&&this.Np(e,b)}};
t.Mp=function(a,b){if(a.isVisible()&&this.bg){var c=null;b instanceof wg&&(c=b.placeholder);null!==c?this.nh(a,"position:placeholder",a.position,c,!0):this.nh(a,"position:node",a.position,b,!0);this.nh(a,"scale",a.scale,.01,!0);this.tb&&(c=this.wj,c.contains(a)&&(c.K(a).st=!0));if(a instanceof wg)for(a=a.memberParts;a.next();)c=a.value,c instanceof V&&this.Mp(c,b)}};function ni(a,b,c){a.bg&&!b.A(c)&&(null===a.vn&&b.o()&&null===a.un&&(a.vn=b.copy()),a.un=c.copy(),a.xk=!0)}
function oi(a,b,c){a.bg&&a.G.Ni&&(0===a.xn&&0===a.wn&&(a.xn=b),a.wn=c,a.xk=!0)}
na.Object.defineProperties(Zh.prototype,{animationReasons:{configurable:!0,get:function(){return this.Sm}},isEnabled:{configurable:!0,get:function(){return this.Hc},set:function(a){z(a,"boolean",Zh,"isEnabled");this.Hc=a}},duration:{configurable:!0,get:function(){return this.Yt},set:function(a){z(a,"number",Zh,"duration");1>a&&Ca(a,">= 1",Zh,"duration");this.Yt=a}},isAnimating:{configurable:!0,get:function(){return this.ai}},isTicking:{configurable:!0,
enumerable:!0,get:function(){return this.Ir}},isInitial:{configurable:!0,get:function(){return this.Qg},set:function(a){z(a,"boolean",Zh,"isInitial");this.Qg=a}}});Zh.prototype.stopAnimation=Zh.prototype.zd;Zh.prototype.addToAnimation=Zh.prototype.nh;Zh.prototype.prepareAnimation=Zh.prototype.Mz;Zh.prototype.prepareAutomaticAnimation=Zh.prototype.Qi;Zh.className="AnimationManager";function gi(a,b,c){this.start=a;this.end=b;this.Vp={};this.Ps=c;this.st=!1}gi.className="AnimationStates";
var li={opacity:function(a,b,c,d,e,f){a.opacity=d(e,b,c-b,f)},position:function(a,b,c,d,e,f){e!==f?a.At(d(e,b.x,c.x-b.x,f),d(e,b.y,c.y-b.y,f)):a.position=new J(d(e,b.x,c.x-b.x,f),d(e,b.y,c.y-b.y,f))},"position:node":function(a,b,c,d,e,f){var g=a.actualBounds,h=c.actualBounds;c=h.x+h.width/2-g.width/2;g=h.y+h.height/2-g.height/2;e!==f?a.At(d(e,b.x,c-b.x,f),d(e,b.y,g-b.y,f)):a.position=new J(d(e,b.x,c-b.x,f),d(e,b.y,g-b.y,f))},"position:placeholder":function(a,b,c,d,e,f){e!==f?a.At(d(e,b.x,c.x-b.x,
f),d(e,b.y,c.y-b.y,f)):a.position=new J(d(e,b.x,c.x-b.x,f),d(e,b.y,c.y-b.y,f))},scale:function(a,b,c,d,e,f){a.scale=d(e,b,c-b,f)},visible:function(a,b,c,d,e,f){a.visible=e!==f?b:c}};function pi(){0<arguments.length&&Da(pi);rb(this);this.G=null;this.Ga=new G;this.Va="";this.mb=1;this.w=!1;this.Aj=this.L=this.Lh=this.Kh=this.Jh=this.Ih=this.Gh=this.Hh=this.Fh=this.Nh=this.Eh=this.Mh=this.Dh=this.Ch=!0;this.l=!1;this.Mo=[]}t=pi.prototype;t.ob=function(a){this.G=a};
t.toString=function(a){void 0===a&&(a=0);var b='Layer "'+this.name+'"';if(0>=a)return b;for(var c=0,d=0,e=0,f=0,g=0,h=this.Ga.iterator;h.next();){var k=h.value;k instanceof wg?e++:k instanceof V?d++:k instanceof Q?f++:k instanceof Cf?g++:c++}h="";0<c&&(h+=c+" Parts ");0<d&&(h+=d+" Nodes ");0<e&&(h+=e+" Groups ");0<f&&(h+=f+" Links ");0<g&&(h+=g+" Adornments ");if(1<a)for(a=this.Ga.iterator;a.next();)c=a.value,h+="\n    "+c.toString(),d=c.data,null!==d&&Jb(d)&&(h+=" #"+Jb(d)),c instanceof V?h+=" "+
Wa(d):c instanceof Q&&(h+=" "+Wa(c.fromNode)+" "+Wa(c.toNode));return b+" "+this.Ga.count+": "+h};
t.Tb=function(a,b,c){void 0===b&&(b=null);void 0===c&&(c=null);if(!1===this.Aj)return null;E&&!a.o()&&v("findObjectAt: Point must have a real value, not: "+a.toString());var d=!1;null!==this.diagram&&this.diagram.viewportBounds.fa(a)&&(d=!0);for(var e=J.alloc(),f=this.Ga.j,g=f.length;g--;){var h=f[g];if((!0!==d||!1!==Cg(h))&&h.isVisible()&&(e.assign(a),ac(e,h.vd),h=h.Tb(e,b,c),null!==h&&(null!==b&&(h=b(h)),null!==h&&(null===c||c(h)))))return J.free(e),h}J.free(e);return null};
t.Ei=function(a,b,c,d){void 0===b&&(b=null);void 0===c&&(c=null);d instanceof G||d instanceof H||(d=new H);if(!1===this.Aj)return d;E&&!a.o()&&v("findObjectsAt: Point must have a real value, not: "+a.toString());var e=!1;null!==this.diagram&&this.diagram.viewportBounds.fa(a)&&(e=!0);for(var f=J.alloc(),g=this.Ga.j,h=g.length;h--;){var k=g[h];if((!0!==e||!1!==Cg(k))&&k.isVisible()){f.assign(a);ac(f,k.vd);var l=k;k.Ei(f,b,c,d)&&(null!==b&&(l=b(l)),null===l||null!==c&&!c(l)||d.add(l))}}J.free(f);return d};
t.ng=function(a,b,c,d,e){void 0===b&&(b=null);void 0===c&&(c=null);void 0===d&&(d=!1);e instanceof G||e instanceof H||(e=new H);if(!1===this.Aj)return e;E&&!a.o()&&v("findObjectsIn: Rect must have a real value, not: "+a.toString());var f=!1;null!==this.diagram&&this.diagram.viewportBounds.pf(a)&&(f=!0);for(var g=this.Ga.j,h=g.length;h--;){var k=g[h];if((!0!==f||!1!==Cg(k))&&k.isVisible()){var l=k;k.ng(a,b,c,d,e)&&(null!==b&&(l=b(l)),null===l||null!==c&&!c(l)||e.add(l))}}return e};
t.og=function(a,b,c,d,e,f){void 0===c&&(c=null);void 0===d&&(d=null);void 0===e&&(e=!0);if(!1!==e&&!0!==e){if(e instanceof G||e instanceof H)f=e;e=!0}f instanceof G||f instanceof H||(f=new H);if(!1===this.Aj)return f;E&&!a.o()&&v("findObjectsNear: Point must have a real value, not: "+a.toString());var g=!1;null!==this.diagram&&this.diagram.viewportBounds.fa(a)&&(g=!0);for(var h=J.alloc(),k=J.alloc(),l=this.Ga.j,m=l.length;m--;){var n=l[m];if((!0!==g||!1!==Cg(n))&&n.isVisible()){h.assign(a);ac(h,n.vd);
k.h(a.x+b,a.y);ac(k,n.vd);var p=n;n.og(h,k,c,d,e,f)&&(null!==c&&(p=c(p)),null===p||null!==d&&!d(p)||f.add(p))}}J.free(h);J.free(k);return f};
t.md=function(a,b){if(this.visible){var c=void 0===b?a.viewportBounds:b;var d=this.Ga.j,e=d.length;a=Qa();b=Qa();for(var f=0;f<e;f++){var g=d[f];g.Dw=f;g instanceof Q&&!1===g.Nc||g instanceof Cf&&null!==g.adornedPart||(Oc(g.actualBounds,c,10)?(g.md(!0),a.push(g)):(g.md(!1),null!==g.adornments&&0<g.adornments.count&&b.push(g)))}for(c=0;c<a.length;c++)for(d=a[c],qi(d),d=d.adornments;d.next();)e=d.value,e.measure(Infinity,Infinity),e.arrange(),e.md(!0);for(c=0;c<b.length;c++)d=b[c],d.updateAdornments(),
ri(d,!0);Ta(a);Ta(b)}};t.mc=function(a,b,c){if(this.visible&&0!==this.mb&&(void 0===c&&(c=!0),c||!this.isTemporary)){c=this.Ga.j;var d=c.length;if(0!==d){1!==this.mb&&(a.globalAlpha=this.mb);var e=this.Mo;e.length=0;for(var f=b.scale,g=0;g<d;g++){var h=c[g];if(Cg(h)){if(h instanceof Q&&(h.isOrthogonal&&e.push(h),!1===h.Nc))continue;var k=h.actualBounds;1<k.width*f||1<k.height*f?h.mc(a,b):si(a,h)}}a.globalAlpha=1}}};
function si(a,b){var c=b.actualBounds,d=b.naturalBounds;if(0!==c.width&&0!==c.height&&!isNaN(c.x)&&!isNaN(c.y)&&b.isVisible()){var e=b.transform;null!==b.areaBackground&&(ti(b,a,b.areaBackground,!0,!0,d,c),a.fillRect(c.x,c.y,c.width,c.height));null===b.areaBackground&&null===b.background&&(ti(b,a,"rgba(0,0,0,0.4)",!0,!1,d,c),a.fillRect(c.x,c.y,c.width,c.height));null!==b.background&&(a.transform(e.m11,e.m12,e.m21,e.m22,e.dx,e.dy),ti(b,a,b.background,!0,!1,d,c),a.fillRect(0,0,d.width,d.height),e.gt()||
(b=1/(e.m11*e.m22-e.m12*e.m21),a.transform(e.m22*b,-e.m12*b,-e.m21*b,e.m11*b,b*(e.m21*e.dy-e.m22*e.dx),b*(e.m12*e.dx-e.m11*e.dy))))}}t.g=function(a,b,c,d,e){var f=this.diagram;null!==f&&f.eb(of,a,this,b,c,d,e)};t.Li=function(a,b,c){var d=this.Ga;b.ei=this;if(a>=d.count)a=d.count;else if(d.O(a)===b)return-1;d.Mb(a,b);b.cq(c);d=this.diagram;null!==d&&(c?d.S():d.Li(b));ui(this,a,b);return a};
t.Bc=function(a,b,c){if(!c&&b.layer!==this&&null!==b.layer)return b.layer.Bc(a,b,c);var d=this.Ga;if(0>a||a>=d.length){if(a=d.indexOf(b),0>a)return-1}else if(d.O(a)!==b&&(a=d.indexOf(b),0>a))return-1;b.eq(c);d.nb(a);d=this.diagram;null!==d&&(c?d.S():d.Bc(b));b.ei=null;return a};
function ui(a,b,c){b=vi(a,b,c);if(c instanceof wg&&null!==c&&isNaN(c.zOrder)){if(0!==c.memberParts.count){for(var d=-1,e=a.Ga.j,f=e.length,g=0;g<f;g++){var h=e[g];if(h===c&&(b=g,0<=d))break;if(0>d&&h.containingGroup===c&&(d=g,0<=b))break}!(0>d)&&d<b&&(e=a.Ga,e.nb(b),e.Mb(d,c))}c=c.containingGroup;null!==c&&ui(a,-1,c)}}
function vi(a,b,c){var d=c.zOrder;if(isNaN(d))return b;a=a.Ga;var e=a.count;if(1>=e)return b;0>b&&(b=a.indexOf(c));if(0>b)return-1;for(var f=b-1,g=NaN;0<=f;){g=a.O(f).zOrder;if(!isNaN(g))break;f--}for(var h=b+1,k=NaN;h<e;){k=a.O(h).zOrder;if(!isNaN(k))break;h++}if(!isNaN(g)&&g>d)for(;;){if(-1===f||g<=d){f++;if(f===b)break;a.nb(b);a.Mb(f,c);return f}for(g=NaN;0<=--f&&(g=a.O(f).zOrder,isNaN(g)););}else if(!isNaN(k)&&k<d)for(;;){if(h===e||k>=d){h--;if(h===b)break;a.nb(b);a.Mb(h,c);return h}for(k=NaN;++h<
e&&(k=a.O(h).zOrder,isNaN(k)););}return b}t.clear=function(){for(var a=this.Ga.Na(),b=a.length,c=0;c<b;c++)a[c].md(!1),this.Bc(-1,a[c],!1);this.Mo.length=0};
na.Object.defineProperties(pi.prototype,{parts:{configurable:!0,get:function(){return this.Ga.iterator}},partsBackwards:{configurable:!0,get:function(){return this.Ga.iteratorBackwards}},diagram:{configurable:!0,get:function(){return this.G}},name:{configurable:!0,get:function(){return this.Va},set:function(a){z(a,"string",pi,"name");var b=this.Va;if(b!==a){var c=this.diagram;if(null!==c)for(""===b&&v("Cannot rename default Layer to: "+a),c=
c.layers;c.next();)c.value.name===a&&v("Layer.name is already present in this diagram: "+a);this.Va=a;this.g("name",b,a);for(a=this.Ga.iterator;a.next();)a.value.layerName=this.Va}}},opacity:{configurable:!0,get:function(){return this.mb},set:function(a){var b=this.mb;b!==a&&(z(a,"number",pi,"opacity"),(0>a||1<a)&&Ca(a,"0 <= value <= 1",pi,"opacity"),this.mb=a,this.g("opacity",b,a),a=this.diagram,null!==a&&a.S())}},isTemporary:{configurable:!0,get:function(){return this.w},
set:function(a){var b=this.w;b!==a&&(z(a,"boolean",pi,"isTemporary"),this.w=a,this.g("isTemporary",b,a))}},visible:{configurable:!0,get:function(){return this.L},set:function(a){var b=this.L;if(b!==a){z(a,"boolean",pi,"visible");this.L=a;this.g("visible",b,a);for(b=this.Ga.iterator;b.next();)b.value.Pb(a);a=this.diagram;null!==a&&a.S()}}},pickable:{configurable:!0,get:function(){return this.Aj},set:function(a){var b=this.Aj;b!==a&&(z(a,"boolean",pi,"pickable"),this.Aj=
a,this.g("pickable",b,a))}},isBoundsIncluded:{configurable:!0,get:function(){return this.l},set:function(a){this.l!==a&&(this.l=a,null!==this.diagram&&this.diagram.Ya())}},allowCopy:{configurable:!0,get:function(){return this.Ch},set:function(a){var b=this.Ch;b!==a&&(z(a,"boolean",pi,"allowCopy"),this.Ch=a,this.g("allowCopy",b,a))}},allowDelete:{configurable:!0,get:function(){return this.Dh},set:function(a){var b=this.Dh;b!==a&&(z(a,"boolean",pi,"allowDelete"),
this.Dh=a,this.g("allowDelete",b,a))}},allowTextEdit:{configurable:!0,get:function(){return this.Mh},set:function(a){var b=this.Mh;b!==a&&(z(a,"boolean",pi,"allowTextEdit"),this.Mh=a,this.g("allowTextEdit",b,a))}},allowGroup:{configurable:!0,get:function(){return this.Eh},set:function(a){var b=this.Eh;b!==a&&(z(a,"boolean",pi,"allowGroup"),this.Eh=a,this.g("allowGroup",b,a))}},allowUngroup:{configurable:!0,get:function(){return this.Nh},set:function(a){var b=
this.Nh;b!==a&&(z(a,"boolean",pi,"allowUngroup"),this.Nh=a,this.g("allowUngroup",b,a))}},allowLink:{configurable:!0,get:function(){return this.Fh},set:function(a){var b=this.Fh;b!==a&&(z(a,"boolean",pi,"allowLink"),this.Fh=a,this.g("allowLink",b,a))}},allowRelink:{configurable:!0,get:function(){return this.Hh},set:function(a){var b=this.Hh;b!==a&&(z(a,"boolean",pi,"allowRelink"),this.Hh=a,this.g("allowRelink",b,a))}},allowMove:{configurable:!0,get:function(){return this.Gh},
set:function(a){var b=this.Gh;b!==a&&(z(a,"boolean",pi,"allowMove"),this.Gh=a,this.g("allowMove",b,a))}},allowReshape:{configurable:!0,get:function(){return this.Ih},set:function(a){var b=this.Ih;b!==a&&(z(a,"boolean",pi,"allowReshape"),this.Ih=a,this.g("allowReshape",b,a))}},allowResize:{configurable:!0,get:function(){return this.Jh},set:function(a){var b=this.Jh;b!==a&&(z(a,"boolean",pi,"allowResize"),this.Jh=a,this.g("allowResize",b,a))}},allowRotate:{configurable:!0,
enumerable:!0,get:function(){return this.Kh},set:function(a){var b=this.Kh;b!==a&&(z(a,"boolean",pi,"allowRotate"),this.Kh=a,this.g("allowRotate",b,a))}},allowSelect:{configurable:!0,get:function(){return this.Lh},set:function(a){var b=this.Lh;b!==a&&(z(a,"boolean",pi,"allowSelect"),this.Lh=a,this.g("allowSelect",b,a))}}});pi.prototype.findObjectsNear=pi.prototype.og;pi.prototype.findObjectsIn=pi.prototype.ng;pi.prototype.findObjectsAt=pi.prototype.Ei;pi.prototype.findObjectAt=pi.prototype.Tb;
pi.className="Layer";
function P(a){function b(){qa.document.removeEventListener("DOMContentLoaded",b,!1);c.setRTL()}1<arguments.length&&v("Diagram constructor can only take one optional argument, the DIV HTML element or its id.");wi||(xi(),wi=!0);rb(this);yf=this;bb=[];this.qb=!0;this.Nq=new Zh;this.Nq.ob(this);this.Kb=17;this.Wn=!1;this.tu="default";this.Ja=null;var c=this;Hh&&(null!==qa.document.body?this.setRTL():qa.document.addEventListener("DOMContentLoaded",b,!1));this.Qa=new G;this.ya=this.Aa=0;this.Ea=null;this.vl=
new Ub;this.Zg=this.bd=null;this.Ev();this.al=null;this.Dv();this.ua=(new J(NaN,NaN)).freeze();this.er=this.Da=1;this.zr=(new J(NaN,NaN)).freeze();this.Ar=NaN;this.Ur=1E-4;this.Sr=100;this.vb=new $b;this.Ks=(new J(NaN,NaN)).freeze();this.pr=(new L(NaN,NaN,NaN,NaN)).freeze();this.pi=(new Jc(0,0,0,0)).freeze();this.qs=yi;this.ts=!1;this.ns=this.js=null;this.$i=zi;this.bj=Qd;this.Zh=zi;this.Rn=Qd;this.Br=this.yr=fd;this.rc=!0;this.Sn=!1;this.Hd=new H;this.Uh=new Ub;this.An=!0;this.Wm=250;this.yk=-1;
this.Xm=(new Jc(16,16,16,16)).freeze();this.Ok=this.ud=!1;this.Uk=!0;this.Vh=new kf;this.Vh.diagram=this;this.$e=new kf;this.$e.diagram=this;this.pj=new kf;this.pj.diagram=this;this.qe=this.Af=null;this.Nl=!1;this.Ut=this.Vt=null;this.Mq=qa.PointerEvent&&(gb||ib||jb)&&qa.navigator&&!1!==qa.navigator.msPointerEnabled;Ai(this);this.wi=new H;this.Jr=!0;this.Fs=Bi;this.Xb=!1;this.Hs=Ig;this.Xa=null;Ci.add("Model",Di);this.ea=this.Ma=this.Wb=null;this.Zq="";this.tn="auto";this.Rf=this.Xr=this.Tf=this.Uf=
this.Wf=this.Cf=this.Gf=this.Bf=null;this.ur=!1;this.Df=this.hg=this.Vf=this.Sf=null;this.nu=!1;this.qu={};this.sl=[null,null];this.L=null;this.Tt=this.yu=this.Fm=this.bh=!1;this.Pc=!0;this.lj=this.ac=!1;this.bc=null;var d=this;this.xg=function(a){var b=d.partManager;if(a.model===b.diagram.model&&b.diagram.da){b.diagram.da=!1;try{var c=a.change;""===a.modelChange&&c===of&&b.updateDataBindings(a.object,a.propertyName)}finally{b.diagram.da=!0}}};this.Em=function(a){d.partManager.doModelChanged(a)};
this.Qw=!0;this.ie=-2;this.Bj=new Ub;this.pu=new G;this.Lf=!1;this.Dh=this.Ch=this.Eq=this.Hc=!0;this.Fq=!1;this.Lq=this.Jq=this.Lh=this.Kh=this.Jh=this.Ih=this.Gh=this.Hh=this.Fh=this.Iq=this.Nh=this.Eh=this.Mh=this.Gq=!0;this.ke=this.Oc=!1;this.Kq=this.Hq=this.wr=this.vr=!0;this.ss=this.ps=16;this.vu=this.os=!1;this.ip=this.rs=null;this.wu=this.xu=0;this.hb=(new Jc(5)).freeze();this.vs=(new H).freeze();this.Tr=999999999;this.xr=(new H).freeze();this.$h=this.jj=this.Pg=!0;this.Xh=this.Og=!1;this.kc=
null;this.Ag=!0;this.je=!1;this.Cq=new H;this.Bw=new H;this.Qb=null;this.Ko=1;this.Kw=0;this.Ae={scale:1,position:new J,bounds:new L,vx:!1};this.Pw=(new L(NaN,NaN,NaN,NaN)).freeze();this.Hp=(new Zb(NaN,NaN)).freeze();this.yn=(new L(NaN,NaN,NaN,NaN)).freeze();this.Kr=!1;this.ir=null;Ei(this);this.Pr=this.sr=this.$r=this.tw=this.sw=this.uw=this.Tg=this.Wh=this.Xf=null;Fi(this);this.Ib=null;this.rr=!1;this.Gk=null;this.partManager=new Di;this.toolManager=new $a;this.toolManager.initializeStandardTools();
this.currentTool=this.defaultTool=this.toolManager;this.hr=null;this.Ik=new Lf;this.ds=this.cs=null;this.yp=!1;this.commandHandler=Gi();this.model=Hi();this.bh=!0;this.layout=new Ii;this.bh=!1;this.ww=this.Xt=null;this.cc=1;this.ye=null;this.gu=9999;this.Ve=1;this.hl=0;this.Mr=new J;this.Du=500;this.Oq=new J;this.Se=!1;this.preventDefault=this.rt=this.mm=this.nm=this.lm=this.km=this.hk=this.jk=this.ik=this.fk=this.gk=this.$v=this.Sv=this.Tv=this.Uv=this.oi=this.cp=this.ni=this.bp=null;this.w=!1;this.Yh=
new Ji;this.Cs=!1;void 0!==a&&Ki(this,a);this.qb=!1}P.prototype.clear=function(){this.model.clear();Li=null;Mi="";Ni(this,!1);this.yn=(new L(NaN,NaN,NaN,NaN)).freeze();this.S()};
function Ni(a,b){var c=null;null!==a.Ib&&(c=a.Ib.part);a.animationManager.zd();for(var d=[],e=a.Qa.length,f=0;f<e;f++){var g=a.Qa.j[f];if(b)for(var h=g.parts;h.next();){var k=h.value;k!==c&&null===k.data&&d.push(k)}g.clear()}a.partManager.clear();a.Hd.clear();a.Uh.clear();a.wi.clear();a.vs.ja();a.vs.clear();a.vs.freeze();a.xr.ja();a.xr.clear();a.xr.freeze();a.Gk=null;Ra=[];null!==c&&(a.add(c),a.partManager.parts.remove(c));if(b)for(b=0;b<d.length;b++)a.add(d[b])}function Gi(){return null}
P.prototype.reset=function(){this.qb=!0;this.clear();this.Qa=new G;this.Ev();this.Dv();this.ua=(new J(NaN,NaN)).freeze();this.Da=1;this.zr=(new J(NaN,NaN)).freeze();this.Ar=NaN;this.Ur=1E-4;this.Sr=100;this.Ks=(new J(NaN,NaN)).freeze();this.pr=(new L(NaN,NaN,NaN,NaN)).freeze();this.pi=(new Jc(0,0,0,0)).freeze();this.qs=yi;this.ts=!1;this.ns=this.js=null;this.$i=zi;this.bj=Qd;this.Zh=zi;this.Rn=Qd;this.Br=this.yr=fd;this.Wm=250;this.Xm=(new Jc(16,16,16,16)).freeze();this.Jr=!0;this.Fs=Bi;this.Hs=Ig;
this.tn="auto";this.Rf=this.Xr=this.Tf=this.Uf=this.Wf=this.Cf=this.Gf=this.Bf=null;this.ur=!1;this.Df=this.hg=this.Vf=this.Sf=null;this.Lf=!1;this.Dh=this.Ch=this.Eq=this.Hc=!0;this.Fq=!1;this.Kq=this.Hq=this.wr=this.vr=this.Lq=this.Jq=this.Lh=this.Kh=this.Jh=this.Ih=this.Gh=this.Hh=this.Fh=this.Iq=this.Nh=this.Eh=this.Mh=this.Gq=!0;this.ss=this.ps=16;this.hb=(new Jc(5)).freeze();this.Tr=999999999;this.kc=null;this.Kr=!1;Fi(this);this.Ib=null;this.partManager=new Di;this.toolManager=new $a;this.toolManager.initializeStandardTools();
this.ds=this.cs=this.hr=null;this.yp=!1;this.Ik.reset();this.vl=new Ub;this.vl.clear();this.currentTool=this.defaultTool=this.toolManager;this.commandHandler=Gi();this.bh=!0;Ei(this);this.layout=new Ii;this.bh=!1;this.model=Hi();this.je=!1;this.Uk=!0;this.qb=this.ud=!1;this.S();this.qe=this.Af=null;Ai(this);this.Zq=""};
function Fi(a){a.Xf=new Ub;var b=new V,c=new Jh;c.bind(new Oi("text","",Wa));b.add(c);a.uw=b;a.Xf.add("",b);b=new V;c=new Jh;c.stroke="brown";c.bind(new Oi("text","",Wa));b.add(c);a.Xf.add("Comment",b);b=new V;b.selectable=!1;b.avoidable=!1;c=new Gg;c.figure="Ellipse";c.fill="black";c.stroke=null;c.desiredSize=(new Zb(3,3)).ia();b.add(c);a.Xf.add("LinkLabel",b);a.Wh=new Ub;b=new wg;b.selectionObjectName="GROUPPANEL";b.type=W.Vertical;c=new Jh;c.font="bold 12pt sans-serif";c.bind(new Oi("text","",
Wa));b.add(c);c=new W(W.Auto);c.name="GROUPPANEL";var d=new Gg;d.figure="Rectangle";d.fill="rgba(128,128,128,0.2)";d.stroke="black";c.add(d);d=new kh;d.padding=(new Jc(5,5,5,5)).ia();c.add(d);b.add(c);a.sw=b;a.Wh.add("",b);a.Tg=new Ub;b=new Q;c=new Gg;c.isPanelMain=!0;b.add(c);c=new Gg;c.toArrow="Standard";c.fill="black";c.stroke=null;c.strokeWidth=0;b.add(c);a.tw=b;a.Tg.add("",b);b=new Q;c=new Gg;c.isPanelMain=!0;c.stroke="brown";b.add(c);a.Tg.add("Comment",b);b=new Cf;b.type=W.Auto;c=new Gg;c.fill=
null;c.stroke="dodgerblue";c.strokeWidth=3;b.add(c);c=new kh;c.margin=(new Jc(1.5,1.5,1.5,1.5)).ia();b.add(c);a.$r=b;a.sr=b;b=new Cf;b.type=W.Link;c=new Gg;c.isPanelMain=!0;c.fill=null;c.stroke="dodgerblue";c.strokeWidth=3;b.add(c);a.Pr=b}
P.prototype.setRTL=function(a){a=void 0===a?this.div:a;null===a&&(a=qa.document.body);var b=xa("div");b.dir="rtl";b.style.cssText="font-size: 14px; width: 1px; height: 1px; position: absolute; top: -1000px; overflow: scroll;";b.textContent="A";a.appendChild(b);var c="reverse";0<b.scrollLeft?c="default":(b.scrollLeft=1,0===b.scrollLeft&&(c="negative"));a.removeChild(b);this.tu=c};
P.prototype.setScrollWidth=function(a){a=void 0===a?this.div:a;null===a&&(a=qa.document.body);var b=0;if(Hh){var c=Pi;b=Qi;null===c&&(c=Pi=xa("p"),c.style.width="100%",c.style.height="200px",c.style.boxSizing="content-box",b=Qi=xa("div"),b.style.position="absolute",b.style.visibility="hidden",b.style.width="200px",b.style.height="150px",b.style.boxSizing="content-box",b.appendChild(c));b.style.overflow="hidden";a.appendChild(b);var d=c.offsetWidth;b.style.overflow="scroll";c=c.offsetWidth;d===c&&
(c=b.clientWidth);a.removeChild(b);b=d-c;0!==b||pb||(b=11)}this.Kb=b};P.prototype.ib=function(a){a.classType===P?this.autoScale=a:Fa(this,a)};P.prototype.toString=function(a){void 0===a&&(a=0);var b="";this.div&&this.div.id&&(b=this.div.id);b='Diagram "'+b+'"';if(0>=a)return b;for(var c=this.Qa.iterator;c.next();)b+="\n  "+c.value.toString(a-1);return b};
function Ri(a){var b=a.Ea.Ha;b instanceof HTMLCanvasElement&&(a.Mq?(b.addEventListener("pointerdown",a.km,!1),b.addEventListener("pointermove",a.lm,!1),b.addEventListener("pointerup",a.nm,!1),b.addEventListener("pointerout",a.mm,!1)):(b.addEventListener("touchstart",a.Uv,!1),b.addEventListener("touchmove",a.Tv,!1),b.addEventListener("touchend",a.Sv,!1),b.addEventListener("mousemove",a.gk,!1),b.addEventListener("mousedown",a.fk,!1),b.addEventListener("mouseup",a.ik,!1),b.addEventListener("mouseout",
a.hk,!1)),b.addEventListener("mouseenter",a.Hy,!1),b.addEventListener("mouseleave",a.Iy,!1),b.addEventListener("wheel",a.jk,!1),b.addEventListener("keydown",a.Az,!1),b.addEventListener("keyup",a.Bz,!1),b.addEventListener("blur",a.uy,!1),b.addEventListener("focus",a.vy,!1),b.addEventListener("selectstart",function(a){a.preventDefault();return!1},!1),b.addEventListener("contextmenu",function(a){a.preventDefault();return!1},!1),b.addEventListener("gesturestart",function(b){a.toolManager.gestureBehavior!==
Ff&&(a.toolManager.gestureBehavior===Ef?b.preventDefault():a.Se&&a.lastInput.handled||(b.preventDefault(),a.Ko=a.scale,a.currentTool.doCancel()))},!1),b.addEventListener("gesturechange",function(b){if(a.toolManager.gestureBehavior!==Ff)if(a.toolManager.gestureBehavior===Ef)b.preventDefault();else if(!a.Se||!a.lastInput.handled){b.preventDefault();var c=b.scale;if(null!==a.Ko){var e=a.Ea.getBoundingClientRect();b=new J(b.pageX-window.scrollX-a.Aa/e.width*e.left,b.pageY-window.scrollY-a.ya/e.height*
e.top);c=a.Ko*c;e=a.commandHandler;if(c!==a.scale&&e.canResetZoom(c)){var f=a.zoomPoint;a.zoomPoint=b;e.resetZoom(c);a.zoomPoint=f}}}},!1),qa.addEventListener("resize",a.$v,!1))}function gg(a,b){null!==a.ye&&(a.ye=null,b&&a.rt())}P.prototype.computePixelRatio=function(){return null!==this.ye?this.ye:qa.devicePixelRatio||1};P.prototype.doMouseMove=function(){this.currentTool.doMouseMove()};P.prototype.doMouseDown=function(){this.currentTool.doMouseDown()};P.prototype.doMouseUp=function(){this.currentTool.doMouseUp()};
P.prototype.doMouseWheel=function(){this.currentTool.doMouseWheel()};P.prototype.doKeyDown=function(){this.currentTool.doKeyDown()};P.prototype.doKeyUp=function(){this.currentTool.doKeyUp()};P.prototype.doFocus=function(){this.focus()};P.prototype.focus=function(){if(this.Ea)if(this.scrollsPageOnFocus)this.Ea.focus();else{var a=qa.scrollX||qa.pageXOffset,b=qa.scrollY||qa.pageYOffset;this.Ea.focus();qa.scrollTo(a,b)}};P.prototype.vy=function(){this.G.ba("GainedFocus")};P.prototype.uy=function(){this.G.ba("LostFocus")};
function di(a){if(null!==a.Ea){var b=a.Ja;if(0!==b.clientWidth&&0!==b.clientHeight){a.setScrollWidth();var c=a.Xh?a.Kb:0,d=a.Og?a.Kb:0,e=a.cc;a.cc=a.computePixelRatio();a.cc!==e&&(a.Sn=!0,a.gc());if(b.clientWidth!==a.Aa+c||b.clientHeight!==a.ya+d)a.jj=!0,a.rc=!0,b=a.layout,null!==b&&b.isViewportSized&&a.autoScale===zi&&(a.Ok=!0,b.C()),a.ac||a.gc()}}}
function Ei(a){var b=new pi;b.name="Background";a.Rl(b);b=new pi;b.name="";a.Rl(b);b=new pi;b.name="Foreground";a.Rl(b);b=new pi;b.name="Adornment";b.isTemporary=!0;a.Rl(b);b=new pi;b.name="Tool";b.isTemporary=!0;b.isBoundsIncluded=!0;a.Rl(b);b=new pi;b.name="Grid";b.allowSelect=!1;b.pickable=!1;b.isTemporary=!0;a.Tw(b,a.am("Background"))}
function Si(a){a.Ib=new W(W.Grid);a.Ib.name="GRID";var b=new Gg;b.figure="LineH";b.stroke="lightgray";b.strokeWidth=.5;b.interval=1;a.Ib.add(b);b=new Gg;b.figure="LineH";b.stroke="gray";b.strokeWidth=.5;b.interval=5;a.Ib.add(b);b=new Gg;b.figure="LineH";b.stroke="gray";b.strokeWidth=1;b.interval=10;a.Ib.add(b);b=new Gg;b.figure="LineV";b.stroke="lightgray";b.strokeWidth=.5;b.interval=1;a.Ib.add(b);b=new Gg;b.figure="LineV";b.stroke="gray";b.strokeWidth=.5;b.interval=5;a.Ib.add(b);b=new Gg;b.figure=
"LineV";b.stroke="gray";b.strokeWidth=1;b.interval=10;a.Ib.add(b);b=new R;b.add(a.Ib);b.layerName="Grid";b.zOrder=0;b.isInDocumentBounds=!1;b.isAnimated=!1;b.pickable=!1;b.locationObjectName="GRID";a.add(b);a.partManager.parts.remove(b);a.Ib.visible=!1}function Ti(){this.G.vu?this.G.vu=!1:this.G.isEnabled?this.G.hx(this):Ui(this.G)}function Vi(a){this.G.isEnabled?(this.G.xu=a.target.scrollTop,this.G.wu=a.target.scrollLeft):Ui(this.G)}
P.prototype.hx=function(a){if(null!==this.Ea){this.os=!0;var b=this.documentBounds,c=this.viewportBounds,d=this.pi,e=b.x-d.left,f=b.y-d.top,g=b.width+d.left+d.right,h=b.height+d.top+d.bottom,k=b.right+d.right;d=b.bottom+d.bottom;var l=c.x;b=c.y;var m=c.width,n=c.height,p=c.right,q=c.bottom;c=this.scale;var r=a.scrollLeft;if(this.Wn)switch(this.tu){case "negative":r=r+a.scrollWidth-a.clientWidth;break;case "reverse":r=a.scrollWidth-r-a.clientWidth}var u=r;m<g||n<h?(r=J.allocAt(this.position.x,this.position.y),
this.allowHorizontalScroll&&this.wu!==u&&(r.x=u/c+e,this.wu=u),this.allowVerticalScroll&&this.xu!==a.scrollTop&&(r.y=a.scrollTop/c+f,this.xu=a.scrollTop),this.position=r,J.free(r),this.jj=this.os=!1):(r=J.alloc(),a.$x&&this.allowHorizontalScroll&&(e<l&&(this.position=r.h(u+e,this.position.y)),k>p&&(this.position=r.h(-(this.rs.scrollWidth-this.Aa)+u-this.Aa/c+k,this.position.y))),a.ay&&this.allowVerticalScroll&&(f<b&&(this.position=r.h(this.position.x,a.scrollTop+f)),d>q&&(this.position=r.h(this.position.x,
-(this.rs.scrollHeight-this.ya)+a.scrollTop-this.ya/c+d))),J.free(r),Wi(this),this.jj=this.os=!1,b=this.documentBounds,c=this.viewportBounds,k=b.right,p=c.right,d=b.bottom,q=c.bottom,e=b.x,l=c.x,f=b.y,b=c.y,m>=g&&e>=l&&k<=p&&(this.ip.style.width="1px"),n>=h&&f>=b&&d<=q&&(this.ip.style.height="1px"))}};P.prototype.computeBounds=function(){0<this.Hd.count&&Xi(this);return Yi(this)};
function Yi(a){if(a.fixedBounds.o()){var b=a.fixedBounds.copy();b.Op(a.hb);return b}for(var c=!0,d=a.Qa.j,e=d.length,f=0;f<e;f++){var g=d[f];if(g.visible&&(!g.isTemporary||g.isBoundsIncluded)){g=g.Ga.j;for(var h=g.length,k=0;k<h;k++){var l=g[k];l.isInDocumentBounds&&l.isVisible()&&(l=l.actualBounds,l.o()&&(c?(c=!1,b=l.copy()):b.Zc(l)))}}}c&&(b=new L(0,0,0,0));b.Op(a.hb);return b}
P.prototype.computePartsBounds=function(a,b){void 0===b&&(b=!1);var c=null;if(Ja(a))for(var d=0;d<a.length;d++){var e=a[d];!b&&e instanceof Q||(e.dc(),null===c?c=e.actualBounds.copy():c.Zc(e.actualBounds))}else for(a=a.iterator;a.next();)d=a.value,!b&&d instanceof Q||(d.dc(),null===c?c=d.actualBounds.copy():c.Zc(d.actualBounds));return null===c?new L(NaN,NaN,0,0):c};
function bj(a,b){if((b||a.je)&&!a.qb&&null!==a.Ea&&!a.animationManager.isAnimating&&a.documentBounds.o()){a.qb=!0;var c=a.$i;b&&a.Zh!==zi&&(c=a.Zh);var d=c!==zi?cj(a,c):a.scale;c=a.viewportBounds.copy();var e=a.Aa/d,f=a.ya/d,g=null,h=a.animationManager;h.tb&&(g=a.ua.copy());var k=a.bj,l=a.Rn;b&&!k.Za()&&(l.Za()||l.Db())&&(k=l.Db()?qd:l);dj(a,a.documentBounds,e,f,k,b);null!==g&&ni(h,g,a.ua);b=a.scale;a.scale=d;a.qb=!1;d=a.viewportBounds;d.Ra(c)||a.oq(c,d,b,!1)}}
function cj(a,b){var c=a.er;if(null===a.Ea)return c;a.Pg&&ej(a,a.computeBounds());var d=a.documentBounds;if(!d.o())return c;var e=d.width;d=d.height;var f=a.Aa,g=a.ya,h=f/e,k=g/d;return b===fj?(b=Math.min(k,h),b>c&&(b=c),b<a.minScale&&(b=a.minScale),b>a.maxScale&&(b=a.maxScale),b):b===gj?(b=k>h?(g-a.Kb)/d:(f-a.Kb)/e,b>c&&(b=c),b<a.minScale&&(b=a.minScale),b>a.maxScale&&(b=a.maxScale),b):a.scale}
P.prototype.zoomToFit=function(){this.scale=cj(this,fj);this.scrollMode!==yi&&dj(this,this.documentBounds,this.Aa/this.Da,this.ya/this.Da,this.bj,!0)};t=P.prototype;
t.eA=function(a,b){void 0===b&&(b=fj);var c=a.width,d=a.height;if(!(0===c||0===d||isNaN(c)&&isNaN(d))){var e=1;if(b===fj||b===gj)if(isNaN(c))e=this.viewportBounds.height*this.scale/d;else if(isNaN(d))e=this.viewportBounds.width*this.scale/c;else{e=this.Aa;var f=this.ya;e=b===gj?f/d>e/c?(f-(this.Og?this.Kb:0))/d:(e-(this.Xh?this.Kb:0))/c:Math.min(f/d,e/c)}this.scale=e;this.position=new J(a.x,a.y)}};
t.ny=function(a,b){this.Pg&&ej(this,this.computeBounds());var c=this.documentBounds,d=this.viewportBounds;this.position=new J(c.x+(a.x*c.width+a.offsetX)-(b.x*d.width-b.offsetX),c.y+(a.y*c.height+a.offsetY)-(b.y*d.height-b.offsetY))};
function dj(a,b,c,d,e,f){a.ua.ja();var g=a.ua,h=g.x,k=g.y;if(f||a.scrollMode===yi)e.Za()&&(c>b.width&&(h=b.x+(e.x*b.width+e.offsetX)-(e.x*c-e.offsetX)),d>b.height&&(k=b.y+(e.y*b.height+e.offsetY)-(e.y*d-e.offsetY))),e=a.pi,f=c-b.width,c<b.width+e.left+e.right?(h=Math.min(h+c/2,b.right+Math.max(f,e.right)-c/2),h=Math.max(h,b.left-Math.max(f,e.left)+c/2),h-=c/2):h>b.left?h=b.left:h<b.right-c&&(h=b.right-c),c=d-b.height,d<b.height+e.top+e.bottom?(k=Math.min(k+d/2,b.bottom+Math.max(c,e.bottom)-d/2),k=
Math.max(k,b.top-Math.max(c,e.top)+d/2),k-=d/2):k>b.top?k=b.top:k<b.bottom-d&&(k=b.bottom-d);g.x=isFinite(h)?h:-a.hb.left;g.y=isFinite(k)?k:-a.hb.top;null!==a.positionComputation&&(b=a.positionComputation(a,g),g.x=b.x,g.y=b.y);a.ua.freeze()}t.bm=function(a,b){void 0===b&&(b=!0);if(b){if(a=ug(this,a,function(a){return a.part},function(a){return a.canSelect()}),a instanceof R)return a}else if(a=ug(this,a,function(a){return a.part}),a instanceof R)return a;return null};
t.Tb=function(a,b,c){void 0===b&&(b=null);void 0===c&&(c=null);Xi(this);for(var d=this.Qa.iteratorBackwards;d.next();){var e=d.value;if(e.visible&&(e=e.Tb(a,b,c),null!==e))return e}return null};function ug(a,b,c,d){void 0===c&&(c=null);void 0===d&&(d=null);Xi(a);for(a=a.Qa.iteratorBackwards;a.next();){var e=a.value;if(e.visible&&!e.isTemporary&&(e=e.Tb(b,c,d),null!==e))return e}return null}
t.Uy=function(a,b,c){void 0===b&&(b=!0);return hj(this,a,function(a){return a.part},b?function(a){return a instanceof R&&a.canSelect()}:null,c)};function hj(a,b,c,d,e){void 0===c&&(c=null);void 0===d&&(d=null);e instanceof G||e instanceof H||(e=new H);Xi(a);for(a=a.Qa.iteratorBackwards;a.next();){var f=a.value;f.visible&&!f.isTemporary&&f.Ei(b,c,d,e)}return e}
t.Ei=function(a,b,c,d){void 0===b&&(b=null);void 0===c&&(c=null);d instanceof G||d instanceof H||(d=new H);Xi(this);for(var e=this.Qa.iteratorBackwards;e.next();){var f=e.value;f.visible&&f.Ei(a,b,c,d)}return d};t.nx=function(a,b,c,d){void 0===b&&(b=!1);void 0===c&&(c=!0);return ij(this,a,function(a){return a instanceof R&&(!c||a.canSelect())},b,d)};
t.ng=function(a,b,c,d,e){void 0===b&&(b=null);void 0===c&&(c=null);void 0===d&&(d=!1);e instanceof G||e instanceof H||(e=new H);Xi(this);for(var f=this.Qa.iteratorBackwards;f.next();){var g=f.value;g.visible&&g.ng(a,b,c,d,e)}return e};function ij(a,b,c,d,e){var f=null;void 0===f&&(f=null);void 0===c&&(c=null);void 0===d&&(d=!1);e instanceof G||e instanceof H||(e=new H);Xi(a);for(a=a.Qa.iteratorBackwards;a.next();){var g=a.value;g.visible&&!g.isTemporary&&g.ng(b,f,c,d,e)}return e}
t.Vy=function(a,b,c,d,e){void 0===c&&(c=!0);void 0===d&&(d=!0);return jj(this,a,b,function(a){return a instanceof R&&(!d||a.canSelect())},c,e)};t.og=function(a,b,c,d,e,f){void 0===c&&(c=null);void 0===d&&(d=null);void 0===e&&(e=!0);if(!1!==e&&!0!==e){if(e instanceof G||e instanceof H)f=e;e=!0}f instanceof G||f instanceof H||(f=new H);Xi(this);for(var g=this.Qa.iteratorBackwards;g.next();){var h=g.value;h.visible&&h.og(a,b,c,d,e,f)}return f};
function jj(a,b,c,d,e,f){var g=null;void 0===g&&(g=null);void 0===d&&(d=null);void 0===e&&(e=!0);if(!1!==e&&!0!==e){if(e instanceof G||e instanceof H)f=e;e=!0}f instanceof G||f instanceof H||(f=new H);Xi(a);for(a=a.Qa.iteratorBackwards;a.next();){var h=a.value;h.visible&&!h.isTemporary&&h.og(b,c,g,d,e,f)}return f}P.prototype.acceptEvent=function(a){return kj(this,a,a instanceof MouseEvent)};
function kj(a,b,c){var d=a.$e;a.$e=a.pj;a.pj=d;d.diagram=a;d.event=b;c?lj(a,b,d):(d.viewPoint=a.$e.viewPoint,d.documentPoint=a.$e.documentPoint);a=0;b.ctrlKey&&(a+=1);b.altKey&&(a+=2);b.shiftKey&&(a+=4);b.metaKey&&(a+=8);d.modifiers=a;d.button=b.button;void 0===b.buttons||fb||(d.buttons=b.buttons);kb&&0===b.button&&b.ctrlKey&&(d.button=2);d.down=!1;d.up=!1;d.clickCount=1;d.delta=0;d.handled=!1;d.bubbles=!1;d.timestamp=b.timeStamp;d.isMultiTouch=!1;d.targetDiagram=mj(b);d.targetObject=null;return d}
function mj(a){var b=a.target.G;if(!b){var c=a.path;c||"function"!==typeof a.composedPath||(c=a.composedPath());c&&c[0]&&(b=c[0].G)}return b?b:null}function nj(a,b,c,d){var e=oj(a,b,!0,!1,!0,d);lj(a,c,e);e.targetDiagram=mj(b);e.targetObject=null;d||e.clone(a.Vh);return e}
function pj(a,b,c,d){var e;d=oj(a,b,!1,!1,!1,d);null!==c?((e=qa.document.elementFromPoint(c.clientX,c.clientY))&&e.G?(b=c,c=e.G):(b=void 0!==b.targetTouches?b.targetTouches[0]:b,c=a),d.targetDiagram=c,lj(a,b,d)):null!==a.$e?(d.documentPoint=a.$e.documentPoint,d.viewPoint=a.$e.viewPoint,d.targetDiagram=a.$e.targetDiagram):null!==a.Vh&&(d.documentPoint=a.Vh.documentPoint,d.viewPoint=a.Vh.viewPoint,d.targetDiagram=a.Vh.targetDiagram);d.targetObject=null;return d}
function oj(a,b,c,d,e,f){var g=a.$e;a.$e=a.pj;a.pj=g;g.diagram=a;g.clickCount=1;var h=g.delta=0;b.ctrlKey&&(h+=1);b.altKey&&(h+=2);b.shiftKey&&(h+=4);b.metaKey&&(h+=8);g.modifiers=h;g.button=0;g.buttons=1;g.event=b;g.timestamp=b.timeStamp;a.Mq&&b instanceof qa.PointerEvent&&"touch"!==b.pointerType&&(g.button=b.button,void 0===b.buttons||fb||(g.buttons=b.buttons),kb&&0===b.button&&b.ctrlKey&&(g.button=2));g.down=c;g.up=d;g.handled=!1;g.bubbles=e;g.isMultiTouch=f;return g}
function qj(a,b,c){if(b.bubbles)return E&&E.sx&&Ga("NOT handled "+c.type+" "+b.toString()),!0;E&&E.sx&&Ga("handled "+c.type+" "+a.currentTool.name+" "+b.toString());void 0!==c.stopPropagation&&c.stopPropagation();c.preventDefault();c.cancelBubble=!0;return!1}
P.prototype.Az=function(a){var b=this.G;if(!this.G.isEnabled)return!1;var c=kj(b,a,!1);c.key=String.fromCharCode(a.which);c.down=!0;switch(a.which){case 8:c.key="Backspace";break;case 33:c.key="PageUp";break;case 34:c.key="PageDown";break;case 35:c.key="End";break;case 36:c.key="Home";break;case 37:c.key="Left";break;case 38:c.key="Up";break;case 39:c.key="Right";break;case 40:c.key="Down";break;case 45:c.key="Insert";break;case 46:c.key="Del";break;case 48:c.key="0";break;case 187:case 61:case 107:c.key=
"Add";break;case 189:case 173:case 109:c.key="Subtract";break;case 27:c.key="Esc"}b.doKeyDown();return qj(b,c,a)};
P.prototype.Bz=function(a){var b=this.G;if(!b.isEnabled)return!1;var c=kj(b,a,!1);c.key=String.fromCharCode(a.which);c.up=!0;switch(a.which){case 8:c.key="Backspace";break;case 33:c.key="PageUp";break;case 34:c.key="PageDown";break;case 35:c.key="End";break;case 36:c.key="Home";break;case 37:c.key="Left";break;case 38:c.key="Up";break;case 39:c.key="Right";break;case 40:c.key="Down";break;case 45:c.key="Insert";break;case 46:c.key="Del"}b.doKeyUp();return qj(b,c,a)};
P.prototype.Hy=function(a){var b=this.G;if(!b.isEnabled)return!1;var c=kj(b,a,!0);null!==b.mouseEnter&&b.mouseEnter(c);return qj(b,c,a)};P.prototype.Iy=function(a){var b=this.G;if(!b.isEnabled)return!1;var c=kj(b,a,!0);null!==b.mouseLeave&&b.mouseLeave(c);return qj(b,c,a)};
P.prototype.getMouse=function(a){var b=this.Ea;if(null===b)return new J(0,0);var c=b.getBoundingClientRect();b=a.clientX-this.Aa/c.width*c.left;a=a.clientY-this.ya/c.height*c.top;return null!==this.vb?ac(new J(b,a),this.vb):new J(b,a)};
function lj(a,b,c){var d=a.Ea,e=a.Aa,f=a.ya,g=0,h=0;null!==d&&(d=d.getBoundingClientRect(),g=b.clientX-e/d.width*d.left,h=b.clientY-f/d.height*d.top);c.viewPoint.h(g,h);null!==a.vb?(b=J.allocAt(g,h),a.vb.Xd(b),c.documentPoint.assign(b),J.free(b)):c.documentPoint.h(g,h)}
function lf(a,b,c,d){if(void 0!==b.targetTouches){if(2>b.targetTouches.length)return;b=b.targetTouches[c]}else if(null!==a.sl[0])b=a.sl[c];else return;c=a.Ea;null!==c&&(c=c.getBoundingClientRect(),d.h(b.clientX-a.Aa/c.width*c.left,b.clientY-a.ya/c.height*c.top))}t=P.prototype;t.Ya=function(){this.Pg||(this.Pg=!0,this.gc(!0))};function mi(a){a.ac||Xi(a);a.Pg&&ej(a,a.computeBounds())}t.zh=function(){this.qb||this.ac||(this.S(),rj(this),Wi(this),this.Ya(),this.kd())};t.zz=function(){return this.ud};
t.Cy=function(a){void 0===a&&(a=null);var b=this.animationManager,c=b.isEnabled;b.zd();b.isEnabled=!1;Dg(this);this.je=!1;b.isEnabled=c;null!==a&&wa(a,1)};t.gc=function(a){void 0===a&&(a=!1);if(!0!==this.ud&&!(this.qb||!1===a&&this.ac)){this.ud=!0;var b=this;qa.requestAnimationFrame(function(){b.ud&&b.kd()})}};t.kd=function(){if(!this.Uk||this.ud)this.Uk&&(this.Uk=!1),Dg(this)};function sj(a,b){a.animationManager.isAnimating||a.qb||!a.jj||Ui(a)||(b&&Xi(a),bj(a,!1))}
function Dg(a,b){if(!a.ac&&(a.ud=!1,null!==a.Ja||a.Hp.o())){a.ac=!0;var c=a.animationManager,d=a.pu;if(!c.isTicking&&0!==d.length){for(var e=d.j,f=e.length,g=0;g<f;g++){var h=e[g];tj(h,!1);h.v()}d.clear()}d=a.Bw;0<d.count&&(d.each(function(a){a.Zv()}),d.clear());e=d=!1;c.isAnimating&&(e=!0,d=a.skipsUndoManager,a.skipsUndoManager=!0);c.tb||di(a);sj(a,!1);null!==a.Ib&&(a.Ib.visible&&!a.rr&&(uj(a),a.rr=!0),!a.Ib.visible&&a.rr&&(a.rr=!1));Xi(a);f=!1;if(!a.je||a.Ag)a.je?vj(a,!a.Ok):(a.Ca("Initial Layout"),
!1===c.isEnabled&&c.zd(),vj(a,!1)),f=!0;a.Ok=!1;Xi(a);a.yu||c.isAnimating||mi(a);sj(a,!0);f&&(a.je||wj(a),a.ba("LayoutCompleted"));Xi(a);f&&!a.je&&(a.je=!0,a.bb("Initial Layout"),a.skipsUndoManager||a.undoManager.clear(),wa(function(){a.isModified=!1},1));a.Mu();ci(c);b||a.mc(a.bd);e&&(a.skipsUndoManager=d);a.ac=!1}}
function wj(a){var b=a.Qa.j;a.md(b,b.length,a);a.Zh!==zi?a.scale=cj(a,a.Zh):a.$i!==zi?a.scale=cj(a,a.$i):(b=a.initialScale,isFinite(b)&&0<b&&(a.scale=b));b=a.initialPosition;if(b.o())a.position=b;else{b=J.alloc();b.Si(a.documentBounds,a.initialDocumentSpot);var c=a.viewportBounds;c=L.allocAt(0,0,c.width,c.height);var d=J.alloc();d.Si(c,a.initialViewportSpot);d.h(b.x-d.x,b.y-d.y);a.position=d;L.free(c);J.free(d);J.free(b);rj(a);sj(a,!0);bj(a,!0)}a.ba("InitialLayoutCompleted");uj(a)}
function Xi(a){if((a.ac||!a.animationManager.isAnimating)&&0!==a.Hd.count){for(var b=0;23>b;b++){var c=a.Hd.iterator;if(null===c||0===a.Hd.count)break;a.Hd=new H;a.Zv(c,a.Hd);E&&22===b&&Ga("failure to validate parts")}a.nodes.each(function(a){a instanceof wg&&0!==(a.$&65536)!==!1&&(a.$=a.$^65536)})}}
t.Zv=function(a,b){for(a.reset();a.next();){var c=a.value;!c.fc()||c instanceof wg||(c.Oi()?(c.measure(Infinity,Infinity),c.arrange()):b.add(c))}for(a.reset();a.next();)c=a.value,c instanceof wg&&c.isVisible()&&xj(this,c);for(a.reset();a.next();)c=a.value,c instanceof Q&&c.isVisible()&&(c.Oi()?(c.measure(Infinity,Infinity),c.arrange()):b.add(c));for(a.reset();a.next();)c=a.value,c instanceof Cf&&c.isVisible()&&(c.Oi()?(c.measure(Infinity,Infinity),c.arrange()):b.add(c))};
function xj(a,b){for(var c=Qa(),d=Qa(),e=b.memberParts;e.next();){var f=e.value;f.isVisible()&&(f instanceof wg?(yj(f)||zj(f)||Aj(f))&&xj(a,f):f instanceof Q?f.fromNode===b||f.toNode===b?d.push(f):c.push(f):(f.measure(Infinity,Infinity),f.arrange()))}a=c.length;for(e=0;e<a;e++)f=c[e],f.measure(Infinity,Infinity),f.arrange();Ta(c);b.measure(Infinity,Infinity);b.arrange();a=d.length;for(b=0;b<a;b++)c=d[b],c.measure(Infinity,Infinity),c.arrange();Ta(d)}
t.md=function(a,b,c,d){if(this.$h||this.animationManager.isAnimating)for(var e=0;e<b;e++)a[e].md(c,d)};
t.mc=function(a,b){void 0===b&&(b=null);if(null!==this.Ja){null===this.Ea&&v("No canvas specified");var c=this.animationManager;if(!c.tb){var d=new Date;Bj(this);if("0"!==this.Ja.style.opacity){var e=a!==this.bd,f=this.Qa.j,g=f.length,h=this;this.md(f,g,h);if(e)a.Vc(!0),Wi(this);else if(!this.rc&&null===b&&!c.isAnimating)return;g=this.ua;var k=this.Da,l=Math.round(g.x*k)/k,m=Math.round(g.y*k)/k;c=this.vb;c.reset();1!==k&&c.scale(k);0===g.x&&0===g.y||c.translate(-l,-m);k=this.cc;a.setTransform(1,0,
0,1,0,0);a.scale(k,k);a.clearRect(0,0,this.Aa,this.ya);a.setTransform(1,0,0,1,0,0);a.scale(k,k);a.transform(c.m11,c.m12,c.m21,c.m22,c.dx,c.dy);E&&E.Ai&&E.Uu&&E.Uu(this,a);l=null!==b?function(c){var d=b;if(c.visible&&0!==c.mb){var e=c.Ga.j,f=e.length;if(0!==f){1!==c.mb&&(a.globalAlpha=c.mb);c=c.Mo;c.length=0;for(var g=h.scale,k=0;k<f;k++){var l=e[k];if(Cg(l)&&!d.contains(l)){if(l instanceof Q&&(l.isOrthogonal&&c.push(l),!1===l.Nc))continue;var m=l.actualBounds;1<m.width*g||1<m.height*g?l.mc(a,h):si(a,
l)}}a.globalAlpha=1}}}:function(b){b.mc(a,h)};Cj(this,a);g=f.length;for(m=0;m<g;m++)a.setTransform(1,0,0,1,0,0),a.scale(k,k),a.transform(c.m11,c.m12,c.m21,c.m22,c.dx,c.dy),l(f[m]);this.Yh&&Dj(this.Yh,this)&&this.ir();E&&(E.Vu||E.Ai)&&E.Tp&&E.Tp(a,this,c);e?(this.bd.Vc(!0),Wi(this)):this.rc=this.$h=!1;d=+new Date-+d;null===this.ye&&(this.gu=d)}}}};
function Ej(a,b,c,d,e,f,g,h,k,l){if(null!==a.Ja){null===a.Ea&&v("No canvas specified");void 0===g&&(g=null);void 0===h&&(h=null);void 0===k&&(k=!1);void 0===l&&(l=!1);Bj(a);a.bd.Vc(!0);Wi(a);a.lj=!0;var m=a.Da;a.Da=e;var n=a.Qa.j,p=n.length;try{var q=new L(f.x,f.y,d.width/e,d.height/e),r=q.copy();r.Op(c);uj(a,r);Xi(a);a.md(n,p,a,q);var u=a.cc;b.setTransform(1,0,0,1,0,0);b.scale(u,u);b.clearRect(0,0,d.width,d.height);null!==h&&""!==h&&(b.fillStyle=h,b.fillRect(0,0,d.width,d.height));var y=$b.alloc();
y.reset();y.translate(c.left,c.top);y.scale(e);0===f.x&&0===f.y||y.translate(-f.x,-f.y);b.setTransform(y.m11,y.m12,y.m21,y.m22,y.dx,y.dy);$b.free(y);Cj(a,b);if(null!==g){var x=new H,A=g.iterator;for(A.reset();A.next();){var C=A.value;!1===l&&"Grid"===C.layer.name||null===C||x.add(C)}var F=function(c){var d=k;if(c.visible&&0!==c.mb&&(void 0===d&&(d=!0),d||!c.isTemporary)){d=c.Ga.j;var e=d.length;if(0!==e){1!==c.mb&&(b.globalAlpha=c.mb);c=c.Mo;c.length=0;for(var f=a.scale,g=0;g<e;g++){var h=d[g];if(Cg(h)&&
x.contains(h)){if(h instanceof Q&&(h.isOrthogonal&&c.push(h),!1===h.Nc))continue;var l=h.actualBounds;1<l.width*f||1<l.height*f?h.mc(b,a):si(b,h)}}b.globalAlpha=1}}}}else if(!k&&l){var I=a.grid.part,O=I.layer;F=function(c){c===O?I.mc(b,a):c.mc(b,a,k)}}else F=function(c){c.mc(b,a,k)};for(c=0;c<p;c++)F(n[c]);a.lj=!1;a.Yh&&Dj(a.Yh,a)&&a.ir()}finally{a.Da=m,a.bd.Vc(!0),Wi(a),a.md(n,p,a),uj(a)}}}t.Ge=function(a){return this.Zg[a]};t.Lx=function(a,b){this.Zg[a]=b;this.zh()};
t.Ev=function(){this.Zg=new xb;this.Zg.drawShadows=!0;this.Zg.textGreeking=!0;this.Zg.viewportOptimizations=pb||gb||ib?!1:!0;this.Zg.temporaryPixelRatio=!0;this.Zg.pictureRatioOptimization=!0};function Cj(a,b){a=a.Zg;null!==a&&(void 0!==a.imageSmoothingEnabled&&b.yt(!!a.imageSmoothingEnabled),a=a.defaultFont,void 0!==a&&null!==a&&(b.font=a))}t.dm=function(a){return this.al[a]};t.Vz=function(a,b){this.al[a]=b};
t.Dv=function(){this.al=new xb;this.al.extraTouchArea=10;this.al.extraTouchThreshold=10;this.al.hasGestureZoom=!0};t.Nv=function(a){Fj(this,a)};
function Fj(a,b){var c=a instanceof W,d=a instanceof P,e;for(e in b){""===e&&v("Setting properties requires non-empty property names");var f=a,g=e;if(c||d){var h=e.indexOf(".");if(0<h){var k=e.substring(0,h);if(c)f=a.cb(k);else if(f=a[k],void 0===f||null===f)f=a.toolManager[k];Ia(f)?g=e.substr(h+1):v("Unable to find object named: "+k+" in "+a.toString()+" when trying to set property: "+e)}}if("_"!==g[0]&&!Ya(f,g))if(d&&"ModelChanged"===g){a.Vw(b[g]);continue}else if(d&&"Changed"===g){a.mh(b[g]);continue}else if(d&&
Ya(a.toolManager,g))f=a.toolManager;else if(d&&Gj(a,g)){a.Lj(g,b[g]);continue}else if(a instanceof X&&"Changed"===g){a.mh(b[g]);continue}else v('Trying to set undefined property "'+g+'" on object: '+f.toString());f[g]=b[e];"_"===g[0]&&f instanceof N&&f.Sw(g)}}t.Mu=function(){if(0===this.undoManager.transactionLevel&&0!==this.Uh.count){for(;0<this.Uh.count;){var a=this.Uh;this.Uh=new Ub;for(a=a.iterator;a.next();){var b=a.key;b.fq(a.value);b.ec()}}this.S()}};
t.S=function(a){void 0===a&&(a=null);if(null===a)this.rc=!0,this.gc();else{var b=this.viewportBounds;null!==a&&a.o()&&b.Mc(a)&&(this.rc=!0,this.gc())}this.ba("InvalidateDraw")};
t.tx=function(a,b){if(!0!==this.rc){this.rc=!0;var c=!0===this.Ge("temporaryPixelRatio");if(!0===this.Ge("viewportOptimizations")&&this.scrollMode!==Hj&&this.pi.Ci(0,0,0,0)&&b.width===a.width&&b.height===a.height){var d=this.scale,e=Math.max(a.x,b.x),f=Math.max(a.y,b.y);d=L.allocAt(e,f,Math.max(0,Math.min(a.x+a.width,b.x+b.width)-e)*d,Math.max(0,Math.min(a.y+a.height,b.y+b.height)-f)*d);if(!this.Cs&&0<d.width&&0<d.height){if(!(this.ac||(this.ud=!1,null===this.Ja||(this.ac=!0,this.Mu(),this.documentBounds.o()||
ej(this,this.computeBounds()),e=this.Ea,null===e||e instanceof Ij)))){var g=this.cc;f=this.Aa*g;var h=this.ya*g,k=this.scale*g,l=Math.round(Math.round(b.x*k)-Math.round(a.x*k));b=Math.round(Math.round(b.y*k)-Math.round(a.y*k));k=this.Xt;a=this.ww;k.width!==f&&(k.width=f);k.height!==h&&(k.height=h);a.clearRect(0,0,f,h);k=190*g;var m=70*g,n=Math.max(l,0),p=Math.max(b,0),q=Math.floor(f-n),r=Math.floor(h-p);a.yt(!1);a.drawImage(e.Ha,n,p,q,r,0,0,q,r);Dj(this.Yh,this)&&a.clearRect(0,0,k,m);e=Qa();a=Qa();
r=Math.abs(l);q=Math.abs(b);var u=0===n?0:f-r;n=J.allocAt(u,0);r=J.allocAt(r+u,h);a.push(new L(Math.min(n.x,r.x),Math.min(n.y,r.y),Math.abs(n.x-r.x),Math.abs(n.y-r.y)));var y=this.vb;y.reset();y.scale(g,g);1!==this.Da&&y.scale(this.Da);g=this.ua;(0!==g.x||0!==g.y)&&isFinite(g.x)&&isFinite(g.y)&&y.translate(-g.x,-g.y);ac(n,y);ac(r,y);e.push(new L(Math.min(n.x,r.x),Math.min(n.y,r.y),Math.abs(n.x-r.x),Math.abs(n.y-r.y)));u=0===p?0:h-q;n.h(0,u);r.h(f,q+u);a.push(new L(Math.min(n.x,r.x),Math.min(n.y,r.y),
Math.abs(n.x-r.x),Math.abs(n.y-r.y)));ac(n,y);ac(r,y);e.push(new L(Math.min(n.x,r.x),Math.min(n.y,r.y),Math.abs(n.x-r.x),Math.abs(n.y-r.y)));Dj(this.Yh,this)&&(f=0<l?0:-l,h=0<b?0:-b,n.h(f,h),r.h(k+f,m+h),a.push(new L(Math.min(n.x,r.x),Math.min(n.y,r.y),Math.abs(n.x-r.x),Math.abs(n.y-r.y))),ac(n,y),ac(r,y),e.push(new L(Math.min(n.x,r.x),Math.min(n.y,r.y),Math.abs(n.x-r.x),Math.abs(n.y-r.y))));J.free(n);J.free(r);sj(this,!1);null===this.Ja&&v("No div specified");null===this.Ea&&v("No canvas specified");
if(!this.animationManager.tb&&(f=this.bd,this.rc)){Bj(this);h=this.cc;f.setTransform(1,0,0,1,0,0);f.clearRect(0,0,this.Aa*h,this.ya*h);f.yt(!1);f.drawImage(this.Xt.Ha,0<l?0:Math.round(-l),0<b?0:Math.round(-b));b=this.ua;g=this.Da;k=Math.round(b.x*g)/g;m=Math.round(b.y*g)/g;l=this.vb;l.reset();1!==g&&l.scale(g);0===b.x&&0===b.y||l.translate(-k,-m);f.save();f.beginPath();b=a.length;for(g=0;g<b;g++)k=a[g],0!==k.width&&0!==k.height&&f.rect(Math.floor(k.x),Math.floor(k.y),Math.ceil(k.width),Math.ceil(k.height));
f.clip();f.setTransform(1,0,0,1,0,0);f.scale(h,h);f.transform(l.m11,l.m12,l.m21,l.m22,l.dx,l.dy);E&&E.Ai&&E.Uu&&E.Uu(this,f);h=this.Qa.j;b=h.length;this.md(h,b,this);Cj(this,f);for(g=0;g<b;g++)if(n=h[g],k=e,n.visible&&0!==n.mb){1!==n.mb&&(f.globalAlpha=n.mb);m=n.Mo;m.length=0;p=this.scale;n=n.Ga.j;q=n.length;r=k.length;for(y=0;y<q;y++)if(u=n[y],Cg(u)){if(u instanceof Q&&(u.isOrthogonal&&m.push(u),!1===u.Nc))continue;var x=Jj(u,u.actualBounds);a:{var A=x;for(var C=k,F=r,I=2/p,O=4/p,S=0;S<F;S++){var T=
C[S];if(0!==T.width&&0!==T.height&&A.jv(T.x-I,T.y-I,T.width+O,T.height+O)){A=!0;break a}}A=!1}A&&(1<x.width*p||1<x.height*p?u.mc(f,this):si(f,u))}f.globalAlpha=1}f.restore();f.Vc(!0);E&&(E.Vu||E.Ai)&&E.Tp&&E.Tp(f,this,l);this.Yh&&Dj(this.Yh,this)&&this.ir();this.rc=this.$h=!1;this.rt()}Ta(e);Ta(a);this.ac=!1}}else this.kd();L.free(d);c&&(this.ye=1,this.kd(),gg(this,!0))}else c?(this.ye=1,this.kd(),gg(this,!0)):this.kd()}};function rj(a){!1===a.jj&&(a.jj=!0)}function Wi(a){!1===a.$h&&(a.$h=!0)}
function Bj(a){!1!==a.Sn&&(a.Sn=!1,Kj(a,a.Aa,a.ya))}function Kj(a,b,c){var d=a.cc;a.Ea.resize(b*d,c*d,b,c)&&(a.rc=!0,a.bd.Vc(!0))}
function Ui(a){var b=a.Ea;if(null===b)return!0;var c=a.Ja,d=a.Aa,e=a.ya,f=a.Pw.copy();if(!f.o())return!0;var g=!1,h=a.Xh?a.Kb:0,k=a.Og?a.Kb:0,l=c.clientWidth||d+h;c=c.clientHeight||e+k;if(l!==d+h||c!==e+k)a.Xh=!1,a.Og=!1,k=h=0,a.Aa=l,a.ya=c,g=a.Sn=!0;a.jj=!1;var m=a.documentBounds,n=0,p=0,q=0,r=0;l=f.width;c=f.height;var u=a.pi;a.contentAlignment.Za()?(m.width>l&&(n=u.left,p=u.right),m.height>c&&(q=u.top,r=u.bottom)):(n=u.left,p=u.right,q=u.top,r=u.bottom);u=m.width+n+p;var y=m.height+q+r;n=m.x-n;
var x=f.x;p=m.right+p;var A=f.right+h;q=m.y-q;var C=f.y;r=m.bottom+r;var F=f.bottom+k,I="1px",O="1px";m=a.scale;var S=!(u<l+h),T=!(y<c+k);a.scrollMode===yi&&(S||T)&&(S&&a.hasHorizontalScrollbar&&a.allowHorizontalScroll&&(I=1,n+1<x&&(I=Math.max((x-n)*m+a.Aa,I)),p>A+1&&(I=Math.max((p-A)*m+a.Aa,I)),l+h+1<u&&(I=Math.max((u-l+h)*m+a.Aa,I)),I=I.toString()+"px"),T&&a.hasVerticalScrollbar&&a.allowVerticalScroll&&(O=1,q+1<C&&(O=Math.max((C-q)*m+a.ya,O)),r>F+1&&(O=Math.max((r-F)*m+a.ya,O)),c+k+1<y&&(O=Math.max((y-
c+k)*m+a.ya,O)),O=O.toString()+"px"));T="1px"!==I;S="1px"!==O;T&&S||!T&&!S||(S&&(A-=a.Kb),T&&(F-=a.Kb),u<l+h||!a.hasHorizontalScrollbar||!a.allowHorizontalScroll||(h=1,n+1<x&&(h=Math.max((x-n)*m+a.Aa,h)),p>A+1&&(h=Math.max((p-A)*m+a.Aa,h)),l+1<u&&(h=Math.max((u-l)*m+a.Aa,h)),I=h.toString()+"px"),T="1px"!==I,h=a.ya,T!==a.Og&&(h=T?a.ya-a.Kb:a.ya+a.Kb),y<c+k||!a.hasVerticalScrollbar||!a.allowVerticalScroll||(k=1,q+1<C&&(k=Math.max((C-q)*m+h,k)),r>F+1&&(k=Math.max((r-F)*m+h,k)),c+1<y&&(k=Math.max((y-
c)*m+h,k)),O=k.toString()+"px"),S="1px"!==O);if(a.os&&T===a.Og&&S===a.Xh)return d===a.Aa&&e===a.ya||a.kd(),!1;T!==a.Og&&("1px"===I?a.ya=a.ya+a.Kb:a.ya=Math.max(a.ya-a.Kb,1),g=!0);a.Og=T;a.ip.style.width=I;S!==a.Xh&&("1px"===O?a.Aa=a.Aa+a.Kb:a.Aa=Math.max(a.Aa-a.Kb,1),g=!0,a.Wn&&(k=J.alloc(),S?(b.style.left=a.Kb+"px",a.position=k.h(a.ua.x+a.Kb/a.scale,a.ua.y)):(b.style.left="0px",a.position=k.h(a.ua.x-a.Kb/a.scale,a.ua.y)),J.free(k)));a.Xh=S;a.ip.style.height=O;a.vu=!0;g&&(a.Sn=!0);b=a.rs;k=b.scrollLeft;
a.hasHorizontalScrollbar&&a.allowHorizontalScroll&&(l+1<u?k=(a.position.x-n)*m:n+1<x?k=b.scrollWidth-b.clientWidth:p>A+1&&(k=a.position.x*m));if(a.Wn)switch(a.tu){case "negative":k=-(b.scrollWidth-k-b.clientWidth);break;case "reverse":k=b.scrollWidth-k-b.clientWidth}b.scrollLeft=k;a.hasVerticalScrollbar&&a.allowVerticalScroll&&(c+1<y?b.scrollTop=(a.position.y-q)*m:q+1<C?b.scrollTop=b.scrollHeight-b.clientHeight:r>F+1&&(b.scrollTop=a.position.y*m));l=a.Aa;c=a.ya;b.style.width=l+(a.Xh?a.Kb:0)+"px";
b.style.height=c+(a.Og?a.Kb:0)+"px";return d!==l||e!==c||a.animationManager.tb?(a.oq(f,a.viewportBounds,m,g),!1):!0}
t.add=function(a){w(a,R,P,"add:part");var b=a.diagram;if(b!==this&&(null!==b&&v("Cannot add part "+a.toString()+" to "+this.toString()+". It is already a part of "+b.toString()),b=this.am(a.layerName),null===b&&(b=this.am("")),null===b&&v('Cannot add a Part when unable find a Layer named "'+a.layerName+'" and there is no default Layer'),a.layer!==b)){var c=b.Li(99999999,a,a.diagram===this);0<=c&&this.eb(qf,"parts",b,null,a,null,c);b.isTemporary||this.Ya();a.C(1);c=a.layerChanged;null!==c&&c(a,null,
b)}};t.Li=function(a){this.partManager.Li(a);var b=this;Lj(a,function(a){Mj(b,a)});(a instanceof Cf||a instanceof wg&&null!==a.placeholder)&&a.v();null!==a.data&&Lj(a,function(a){Nj(b.partManager,a)});!0!==zj(a)&&!0!==Aj(a)||this.Hd.add(a);Oj(a,!0,this);Pj(a)?(a.actualBounds.o()&&this.S(Jj(a,a.actualBounds)),this.Ya()):a.isVisible()&&a.actualBounds.o()&&this.S(Jj(a,a.actualBounds));this.gc()};
t.Bc=function(a){a.Qj();this.partManager.Bc(a);var b=this;Lj(a,function(a){Qj(b,a)});null!==a.data&&Lj(a,function(a){Rj(b.partManager,a)});this.Hd.remove(a);Pj(a)?(a.actualBounds.o()&&this.S(Jj(a,a.actualBounds)),this.Ya()):a.isVisible()&&a.actualBounds.o()&&this.S(Jj(a,a.actualBounds));this.gc()};t.remove=function(a){w(a,R,P,"remove:part");Sj(this,a,!0)};
function Sj(a,b,c){var d=b.layer;null!==d&&d.diagram===a&&(b.isSelected=!1,b.isHighlighted=!1,b.C(2),c&&b.Wj(),c=d.Bc(-1,b,!1),0<=c&&a.eb(rf,"parts",d,b,null,c,null),a=b.layerChanged,null!==a&&a(b,d,null))}t.ut=function(a,b){if(Ja(a))for(var c=a.length,d=0;d<c;d++){var e=a[d];b&&!e.canDelete()||this.remove(e)}else for(c=new H,c.addAll(a),a=c.iterator;a.next();)c=a.value,b&&!c.canDelete()||this.remove(c)};t.Vj=function(a,b,c){return this.partManager.Vj(a,b,c)};
P.prototype.moveParts=function(a,b,c,d){void 0===d&&(d=Tj(this));w(b,J,P,"moveParts:offset");if(null!==this.toolManager){var e=new Ub;if(null!==a)if(Ja(a))for(var f=0;f<a.length;f++)Uj(this,e,a[f],c,d);else for(a=a.iterator;a.next();)Uj(this,e,a.value,c,d);else{for(a=this.parts;a.next();)Uj(this,e,a.value,c,d);for(a=this.nodes;a.next();)Uj(this,e,a.value,c,d);for(a=this.links;a.next();)Uj(this,e,a.value,c,d)}og(this,e,b,d,c)}};
function Uj(a,b,c,d,e){void 0===e&&(e=Tj(a));if(!b.contains(c)&&(!d||c.canMove()||c.canCopy()))if(c instanceof V){b.add(c,a.td(e,c,c.location));if(c instanceof wg)for(var f=c.memberParts;f.next();)Uj(a,b,f.value,d,e);for(f=c.linksConnected;f.next();){var g=f.value;if(!b.contains(g)){var h=g.fromNode,k=g.toNode;null!==h&&b.contains(h)&&null!==k&&b.contains(k)&&Uj(a,b,g,d,e)}}if(e.dragsTree)for(c=c.bv();c.next();)Uj(a,b,c.value,d,e)}else if(c instanceof Q)for(b.add(c,a.td(e,c)),c=c.labelNodes;c.next();)Uj(a,
b,c.value,d,e);else c instanceof Cf||b.add(c,a.td(e,c,c.location))}
function og(a,b,c,d,e){if(null!==b&&(w(b,Ub,P,"moveParts:parts"),0!==b.count)){var f=J.alloc(),g=J.alloc();g.assign(c);isNaN(g.x)&&(g.x=0);isNaN(g.y)&&(g.y=0);(c=a.yp)||Yf(a,b);for(var h=Qa(),k=Qa(),l=b.iterator,m=J.alloc();l.next();){var n=l.key,p=l.value;if(n.fc()){var q=Vj(a,n,b);if(null!==q)h.push(new Wj(n,p,q));else if(!e||n.canMove())q=p.point,f.assign(q),a.computeMove(n,f.add(g),d,m),n.location=m,void 0===p.shifted&&(p.shifted=new J),p.shifted.assign(m.$d(q))}else l.key instanceof Q&&k.push(l.pa)}J.free(m);
e=h.length;for(l=0;l<e;l++)n=h[l],f.assign(n.info.point),void 0===n.gv.shifted&&(n.gv.shifted=new J),n.node.location=f.add(n.gv.shifted);e=J.alloc();l=J.alloc();n=k.length;for(p=0;p<n;p++){var r=k[p];q=r.key;if(q instanceof Q)if(q.suspendsRouting){m=q.fromNode;var u=q.toNode;if(null!==a.draggedLink&&d.dragsLink)if(u=r.value.point,null===q.dragComputation)b.add(q,a.td(d,q,g)),mg(q,g.x-u.x,g.y-u.y);else{r=J.allocAt(0,0);(m=q.i(0))&&m.o()&&r.assign(m);var y=m=J.alloc().assign(r).add(g);d.isGridSnapEnabled&&
(d.isGridSnapRealtime||a.lastInput.up)&&(y=J.alloc(),th(a,q,m,y,d));m.assign(q.dragComputation(q,m,y)).$d(r);b.add(q,a.td(d,q,m));mg(q,m.x-u.x,m.y-u.y);J.free(r);J.free(m);y!==m&&J.free(y)}else null!==m&&(e.assign(m.location),y=b.K(m),null!==y&&e.$d(y.point)),null!==u&&(l.assign(u.location),y=b.K(u),null!==y&&l.$d(y.point)),null!==m&&null!==u?e.Ra(l)?(m=r.value.point,u=f,u.assign(e),u.$d(m),b.add(q,a.td(d,q,e)),mg(q,u.x,u.y)):(q.suspendsRouting=!1,q.Sa()):(r=r.value.point,m=null!==m?e:null!==u?l:
g,b.add(q,a.td(d,q,m)),mg(q,m.x-r.x,m.y-r.y))}else if(null===q.fromNode||null===q.toNode)m=r.value.point,b.add(q,a.td(d,q,g)),mg(q,g.x-m.x,g.y-m.y)}J.free(f);J.free(g);J.free(e);J.free(l);Ta(h);Ta(k);c||(Xi(a),cg(a,b))}}
P.prototype.computeMove=function(a,b,c,d){void 0===d&&(d=new J);d.assign(b);if(null===a)return d;var e=b,f=c.isGridSnapEnabled;f&&(c.isGridSnapRealtime||this.lastInput.up)&&(e=J.alloc(),th(this,a,b,e,c));c=null!==a.dragComputation?a.dragComputation(a,b,e):e;var g=a.minLocation,h=g.x;isNaN(h)&&(h=f?Math.round(a.location.x):a.location.x);g=g.y;isNaN(g)&&(g=f?Math.round(a.location.y):a.location.y);var k=a.maxLocation,l=k.x;isNaN(l)&&(l=f?Math.round(a.location.x):a.location.x);k=k.y;isNaN(k)&&(k=f?Math.round(a.location.y):
a.location.y);d.h(Math.max(h,Math.min(c.x,l)),Math.max(g,Math.min(c.y,k)));e!==b&&J.free(e);return d};function Tj(a){var b=a.toolManager.findTool("Dragging");return null!==b?b.dragOptions:a.Ik}
function th(a,b,c,d,e){void 0===e&&(e=Tj(a));d.assign(c);if(null!==b){var f=a.grid;b=e.gridSnapCellSize;a=b.width;b=b.height;var g=e.gridSnapOrigin,h=g.x;g=g.y;e=e.gridSnapCellSpot;if(null!==f){var k=f.gridCellSize;isNaN(a)&&(a=k.width);isNaN(b)&&(b=k.height);f=f.gridOrigin;isNaN(h)&&(h=f.x);isNaN(g)&&(g=f.y)}f=J.allocAt(0,0);f.nk(0,0,a,b,e);K.Yp(c.x,c.y,h+f.x,g+f.y,a,b,d);J.free(f)}}function Yf(a,b){if(null!==b)for(a.yp=!0,a=b.iterator;a.next();)b=a.key,b instanceof Q&&(b.suspendsRouting=!0)}
function cg(a,b){if(null!==b){for(b=b.iterator;b.next();){var c=b.key;c instanceof Q&&(c.suspendsRouting=!1,Xj(c)&&c.Sa())}a.yp=!1}}function Vj(a,b,c){b=b.containingGroup;if(null!==b){a=Vj(a,b,c);if(null!==a)return a;a=c.K(b);if(null!==a)return a}return null}t=P.prototype;t.td=function(a,b,c){if(void 0===c)return new ag(gc);var d=a.isGridSnapEnabled;a.pz||null===b.containingGroup||(d=!1);return d?new ag(new J(Math.round(c.x),Math.round(c.y))):new ag(c.copy())};
function Yj(a,b,c){w(b,pi,P,"addLayer:layer");null!==b.diagram&&b.diagram!==a&&v("Cannot share a Layer with another Diagram: "+b+" of "+b.diagram);null===c?null!==b.diagram&&v("Cannot add an existing Layer to this Diagram again: "+b):(w(c,pi,P,"addLayer:existingLayer"),c.diagram!==a&&v("Existing Layer must be in this Diagram: "+c+" not in "+c.diagram),b===c&&v("Cannot move a Layer before or after itself: "+b));if(b.diagram!==a){b=b.name;a=a.Qa;c=a.count;for(var d=0;d<c;d++)a.O(d).name===b&&v("Cannot add Layer with the name '"+
b+"'; a Layer with the same name is already present in this Diagram.")}}t.Rl=function(a){Yj(this,a,null);a.ob(this);var b=this.Qa,c=b.count-1;if(!a.isTemporary)for(;0<=c&&b.O(c).isTemporary;)c--;b.Mb(c+1,a);null!==this.bc&&this.eb(qf,"layers",this,null,a,null,c+1);this.S();this.Ya()};
t.Tw=function(a,b){Yj(this,a,b);a.ob(this);var c=this.Qa,d=c.indexOf(a);0<=d&&(c.remove(a),null!==this.bc&&this.eb(rf,"layers",this,a,null,d,null));var e=c.count,f;for(f=0;f<e;f++)if(c.O(f)===b){c.Mb(f,a);break}null!==this.bc&&this.eb(qf,"layers",this,null,a,null,f);this.S();0>d&&this.Ya()};
t.jy=function(a,b){Yj(this,a,b);a.ob(this);var c=this.Qa,d=c.indexOf(a);0<=d&&(c.remove(a),null!==this.bc&&this.eb(rf,"layers",this,a,null,d,null));var e=c.count,f;for(f=0;f<e;f++)if(c.O(f)===b){c.Mb(f+1,a);break}null!==this.bc&&this.eb(qf,"layers",this,null,a,null,f+1);this.S();0>d&&this.Ya()};
t.Pz=function(a){w(a,pi,P,"removeLayer:layer");a.diagram!==this&&v("Cannot remove a Layer from another Diagram: "+a+" of "+a.diagram);if(""!==a.name){var b=this.Qa,c=b.indexOf(a);if(b.remove(a)){for(b=a.Ga.copy().iterator;b.next();){var d=b.value,e=d.layerName;e!==a.name?d.layerName=e:d.layerName=""}null!==this.bc&&this.eb(rf,"layers",this,a,null,c,null);this.S();this.Ya()}}};t.am=function(a){for(var b=this.layers;b.next();){var c=b.value;if(c.name===a)return c}return null};
t.Vw=function(a){z(a,"function",P,"addModelChangedListener:listener");null===this.qe&&(this.qe=new G);this.qe.add(a);this.model.mh(a)};t.Rz=function(a){z(a,"function",P,"removeModelChangedListener:listener");null!==this.qe&&(this.qe.remove(a),0===this.qe.count&&(this.qe=null));this.model.mk(a)};t.mh=function(a){z(a,"function",P,"addChangedListener:listener");null===this.Af&&(this.Af=new G);this.Af.add(a)};
t.mk=function(a){z(a,"function",P,"removeChangedListener:listener");null!==this.Af&&(this.Af.remove(a),0===this.Af.count&&(this.Af=null))};t.Ms=function(a){this.skipsUndoManager||this.undoManager.hv(a);a.change!==pf&&(this.isModified=!0);if(null!==this.Af)for(var b=this.Af,c=b.length,d=0;d<c;d++)b.O(d)(a)};t.eb=function(a,b,c,d,e,f,g){void 0===f&&(f=null);void 0===g&&(g=null);var h=new nf;h.diagram=this;h.change=a;h.propertyName=b;h.object=c;h.oldValue=d;h.oldParam=f;h.newValue=e;h.newParam=g;this.Ms(h)};
t.g=function(a,b,c,d,e){this.eb(of,a,this,b,c,d,e)};
t.Pj=function(a,b){if(null!==a&&a.diagram===this){var c=this.skipsModelSourceBindings;try{this.skipsModelSourceBindings=!0;var d=a.change;if(d===of){var e=a.object;Zj(e,a.propertyName,a.K(b));if(e instanceof N){var f=e.part;null!==f&&f.Nb()}this.isModified=!0}else if(d===qf){var g=a.object,h=a.newParam,k=a.newValue;if(g instanceof W)if("number"===typeof h&&k instanceof N){b?g.Bc(h):g.Mb(h,k);var l=g.part;null!==l&&l.Nb()}else{if("number"===typeof h&&k instanceof ak)if(b)k.isRow?g.Bv(h):g.zv(h);else{var m=
k.isRow?g.getRowDefinition(k.index):g.getColumnDefinition(k.index);m.Xl(k)}}else if(g instanceof pi){var n=!0===a.oldParam;"number"===typeof h&&k instanceof R&&(b?(k.isSelected=!1,k.isHighlighted=!1,k.Nb(),g.Bc(n?h:-1,k,n)):g.Li(h,k,n))}else g instanceof P?"number"===typeof h&&k instanceof pi&&(b?this.Qa.nb(h):(k.ob(this),this.Qa.Mb(h,k))):v("unknown ChangedEvent.Insert object: "+a.toString());this.isModified=!0}else if(d===rf){var p=a.object,q=a.oldParam,r=a.oldValue;if(p instanceof W)"number"===
typeof q&&r instanceof N?b?p.Mb(q,r):p.Bc(q):"number"===typeof q&&r instanceof ak&&(b?(m=r.isRow?p.getRowDefinition(r.index):p.getColumnDefinition(r.index),m.Xl(r)):r.isRow?p.Bv(q):p.zv(q));else if(p instanceof pi){var u=!0===a.newParam;"number"===typeof q&&r instanceof R&&(b?0>p.Ga.indexOf(r)&&p.Li(q,r,u):(r.isSelected=!1,r.isHighlighted=!1,r.Nb(),p.Bc(u?q:-1,r,u)))}else p instanceof P?"number"===typeof q&&r instanceof pi&&(b?(r.ob(this),this.Qa.Mb(q,r)):this.Qa.nb(q)):v("unknown ChangedEvent.Remove object: "+
a.toString());this.isModified=!0}else d!==pf&&v("unknown ChangedEvent: "+a.toString())}finally{this.skipsModelSourceBindings=c}}};t.Ca=function(a){return this.undoManager.Ca(a)};t.bb=function(a){return this.undoManager.bb(a)};t.vf=function(){return this.undoManager.vf()};
P.prototype.commit=function(a,b){void 0===b&&(b="");var c=this.skipsUndoManager;null===b&&(this.skipsUndoManager=!0,b="");this.undoManager.Ca(b);var d=!1;try{a(this),d=!0}finally{d?this.undoManager.bb(b):this.undoManager.vf(),this.skipsUndoManager=c}};P.prototype.updateAllTargetBindings=function(a){this.partManager.updateAllTargetBindings(a)};t=P.prototype;t.zq=function(){this.partManager.zq()};
function bk(a,b,c){var d=a.animationManager;if(a.qb||a.ac)a.Da=c,d.tb&&oi(d,b,a.Da);else if(a.qb=!0,null===a.Ea)a.Da=c;else{var e=a.viewportBounds.copy(),f=a.Aa,g=a.ya;e.width=a.Aa/b;e.height=a.ya/b;var h=a.zoomPoint.x,k=a.zoomPoint.y,l=a.contentAlignment;isNaN(h)&&(l.sf()?l.rf(wd)?h=0:l.rf(Ad)&&(h=f-1):h=l.Za()?l.x*(f-1):f/2);isNaN(k)&&(l.sf()?l.rf(vd)?k=0:l.rf(Bd)&&(k=g-1):k=l.Za()?l.y*(g-1):g/2);null!==a.scaleComputation&&(c=a.scaleComputation(a,c));c<a.minScale&&(c=a.minScale);c>a.maxScale&&(c=
a.maxScale);f=J.allocAt(a.ua.x+h/b-h/c,a.ua.y+k/b-k/c);a.position=f;J.free(f);a.Da=c;a.oq(e,a.viewportBounds,b,!1);a.qb=!1;bj(a,!1);d.tb&&oi(d,b,a.Da);a.S();rj(a)}}
t.oq=function(a,b,c,d){if(!a.A(b)){void 0===d&&(d=!1);d||rj(this);Wi(this);var e=this.layout;null===e||!e.isViewportSized||this.autoScale!==zi||d||a.width===b.width&&a.height===b.height||e.C();e=this.currentTool;!0===this.ke&&e instanceof $a&&(this.lastInput.documentPoint=this.Ct(this.lastInput.viewPoint),Gf(e,this));this.qb||this.tx(a,b);uj(this);this.Ae.scale=c;this.Ae.position.x=a.x;this.Ae.position.y=a.y;this.Ae.bounds.assign(a);this.Ae.vx=d;this.ba("ViewportBoundsChanged",this.Ae,a);this.isVirtualized&&
this.links.each(function(a){a.isAvoiding&&a.actualBounds.Mc(b)&&a.Sa()})}};
function uj(a,b){void 0===b&&(b=null);var c=a.Ib;if(null!==c&&c.visible){for(var d=Zb.alloc(),e=1,f=1,g=c.Y.j,h=g.length,k=0;k<h;k++){var l=g[k],m=l.interval;2>m||(ck(l.figure)?f=f*m/K.ox(f,m):e=e*m/K.ox(e,m))}g=c.gridCellSize;d.h(f*g.width,e*g.height);if(null!==b)e=b.width,f=b.height,a=b.x,g=b.y;else{b=L.alloc();a=a.viewportBounds;b.h(a.x,a.y,a.width,a.height);if(!b.o()){L.free(b);return}e=b.width;f=b.height;a=b.x;g=b.y;L.free(b)}c.width=e+2*d.width;c.height=f+2*d.height;b=J.alloc();K.Yp(a,g,0,0,
d.width,d.height,b);b.offset(-d.width,-d.height);Zb.free(d);c.part.location=b;J.free(b)}}t.Ns=function(){var a=0<this.selection.count;a&&this.ba("ChangingSelection",this.selection);Mf(this);a&&this.ba("ChangedSelection",this.selection)};function Mf(a){a=a.selection;if(0<a.count){for(var b=a.Na(),c=b.length,d=0;d<c;d++)b[d].isSelected=!1;a.ja();a.clear();a.freeze()}}
t.select=function(a){null!==a&&(w(a,R,P,"select:part"),a.layer.diagram===this&&(!a.isSelected||1<this.selection.count)&&(this.ba("ChangingSelection",this.selection),Mf(this),a.isSelected=!0,this.ba("ChangedSelection",this.selection)))};
t.Hv=function(a){this.ba("ChangingSelection",this.selection);Mf(this);if(Ja(a))for(var b=a.length,c=0;c<b;c++){var d=a[c];d instanceof R||v("Diagram.selectCollection given something that is not a Part: "+d);d.isSelected=!0}else for(a=a.iterator;a.next();)b=a.value,b instanceof R||v("Diagram.selectCollection given something that is not a Part: "+b),b.isSelected=!0;this.ba("ChangedSelection",this.selection)};
t.Yw=function(){var a=this.highlighteds;if(0<a.count){for(var b=a.Na(),c=b.length,d=0;d<c;d++)b[d].isHighlighted=!1;a.ja();a.clear();a.freeze()}};t.rz=function(a){null!==a&&a.layer.diagram===this&&(w(a,R,P,"highlight:part"),!a.isHighlighted||1<this.highlighteds.count)&&(this.Yw(),a.isHighlighted=!0)};
t.sz=function(a){a=(new H).addAll(a);for(var b=this.highlighteds.copy().rq(a).iterator;b.next();)b.value.isHighlighted=!1;for(a=a.iterator;a.next();)b=a.value,b instanceof R||v("Diagram.highlightCollection given something that is not a Part: "+b),b.isHighlighted=!0};
t.scroll=function(a,b,c){void 0===c&&(c=1);var d="up"===b||"down"===b,e=0;if("pixel"===a)e=c;else if("line"===a)e=c*(d?this.scrollVerticalLineChange:this.scrollHorizontalLineChange);else if("page"===a)a=d?this.viewportBounds.height:this.viewportBounds.width,a*=this.scale,0!==a&&(e=c*Math.max(a-(d?this.scrollVerticalLineChange:this.scrollHorizontalLineChange),0));else{if("document"===a){e=this.documentBounds;c=this.viewportBounds;d=J.alloc();"up"===b?this.position=d.h(c.x,e.y):"left"===b?this.position=
d.h(e.x,c.y):"down"===b?this.position=d.h(c.x,e.bottom-c.height):"right"===b&&(this.position=d.h(e.right-c.width,c.y));J.free(d);return}v("scrolling unit must be 'pixel', 'line', 'page', or 'document', not: "+a)}e/=this.scale;c=this.position.copy();"up"===b?c.y=this.position.y-e:"down"===b?c.y=this.position.y+e:"left"===b?c.x=this.position.x-e:"right"===b?c.x=this.position.x+e:v("scrolling direction must be 'up', 'down', 'left', or 'right', not: "+b);this.position=c};
t.Gv=function(a){var b=this.viewportBounds;b.pf(a)||(a=a.center,a.x-=b.width/2,a.y-=b.height/2,this.position=a)};t.Lu=function(a){var b=this.viewportBounds;a=a.center;a.x-=b.width/2;a.y-=b.height/2;this.position=a};t.Bt=function(a){var b=this.vb;b.reset();1!==this.Da&&b.scale(this.Da);var c=this.ua;(0!==c.x||0!==c.y)&&isFinite(c.x)&&isFinite(c.y)&&b.translate(-c.x,-c.y);return a.copy().transform(this.vb)};
t.bA=function(a){var b=this.vb,c=a.x,d=a.y,e=c+a.width,f=d+a.height,g=b.m11,h=b.m12,k=b.m21,l=b.m22,m=b.dx,n=b.dy,p=c*g+d*k+m;b=c*h+d*l+n;var q=e*g+d*k+m;a=e*h+d*l+n;d=c*g+f*k+m;c=c*h+f*l+n;g=e*g+f*k+m;e=e*h+f*l+n;f=Math.min(p,q);p=Math.max(p,q);q=Math.min(b,a);b=Math.max(b,a);f=Math.min(f,d);p=Math.max(p,d);q=Math.min(q,c);b=Math.max(b,c);f=Math.min(f,g);p=Math.max(p,g);q=Math.min(q,e);b=Math.max(b,e);return new L(f,q,p-f,b-q)};
t.Ct=function(a){var b=this.vb;b.reset();1!==this.Da&&b.scale(this.Da);var c=this.ua;(0!==c.x||0!==c.y)&&isFinite(c.x)&&isFinite(c.y)&&b.translate(-c.x,-c.y);return ac(a.copy(),this.vb)};function dk(a){var b=a.isModified;a.Qw!==b&&(a.Qw=b,a.ba("Modified"))}function ek(a){a=Ci.get(a);return null!==a?new a:new Di}
P.prototype.doModelChanged=function(a){if(a.model===this.model){var b=a.change,c=a.propertyName;if(b===pf&&"S"===c[0])if("StartingFirstTransaction"===c){var d=this;a=this.toolManager;a.mouseDownTools.each(function(a){a.ob(d)});a.mouseMoveTools.each(function(a){a.ob(d)});a.mouseUpTools.each(function(a){a.ob(d)});this.ac||this.je||(this.Ok=!0,this.Uk&&(this.ud=!0))}else"StartingUndo"===c||"StartingRedo"===c?(a=this.animationManager,a.isAnimating&&!this.skipsUndoManager&&a.zd(),this.ba("ChangingSelection",
this.selection)):"StartedTransaction"===c&&(a=this.animationManager,a.isAnimating&&!this.skipsUndoManager&&a.zd());else if(this.da){this.da=!1;try{if(""===a.modelChange&&b===pf){if("FinishedUndo"===c||"FinishedRedo"===c)this.ba("ChangedSelection",this.selection),Xi(this);var e=this.animationManager;"RolledBackTransaction"===c&&e.zd();this.Ok=!0;this.kd();0===this.undoManager.transactionLevel&&ci(e);"CommittedTransaction"===c&&this.undoManager.fu&&(this.ie=Math.min(this.ie,this.undoManager.historyIndex-
1));var f=a.isTransactionFinished;f&&(dk(this),this.jt.clear());if(!this.nu&&f){this.nu=!0;var g=this;wa(function(){g.currentTool.standardMouseOver();g.nu=!1},10)}}}finally{this.da=!0}}}};function Mj(a,b){b=b.Y.j;for(var c=b.length,d=0;d<c;d++)fk(a,b[d])}
function fk(a,b){if(b instanceof gk){var c=b.element;if(null!==c&&c instanceof HTMLImageElement){var d=b.Jg;null!==d&&(d.Wk instanceof Event&&null!==b.Gc&&b.Gc(b,d.Wk),!0===d.Un&&(null!==b.gf&&b.gf(b,d.uu),null!==b.diagram&&b.diagram.pu.add(b)));c=c.src;d=a.Bj.K(c);if(null===d)d=[],d.push(b),a.Bj.add(c,d);else{for(a=0;a<d.length;a++)if(d[a]===b)return;d.push(b)}}}}function Qj(a,b){b=b.Y.j;for(var c=b.length,d=0;d<c;d++)hk(a,b[d])}
function hk(a,b){if(b instanceof gk){var c=b.element;if(null!==c&&c instanceof HTMLImageElement){c=c.src;var d=a.Bj.K(c);if(null!==d)for(var e=0;e<d.length;e++)if(d[e]===b){d.splice(e,1);0===d.length&&(a.Bj.remove(c),ik(c));break}}}}P.prototype.yd=function(){this.partManager.yd()};P.prototype.Mp=function(a,b){this.Nq.Mp(a,b)};P.prototype.Np=function(a,b){this.Nq.Np(a,b)};P.prototype.findPartForKey=function(a){return this.partManager.findPartForKey(a)};t=P.prototype;t.Lb=function(a){return this.partManager.Lb(a)};
t.zc=function(a){return this.partManager.zc(a)};t.Di=function(a){return this.partManager.Di(a)};t.yc=function(a){return this.partManager.yc(a)};t.Vs=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c]=arguments[c];return this.partManager.Vs.apply(this.partManager,b instanceof Array?b:ea(da(b)))};t.Us=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c]=arguments[c];return this.partManager.Us.apply(this.partManager,b instanceof Array?b:ea(da(b)))};
function ej(a,b){a.Pg=!1;var c=a.yn;c.A(b)||(b=b.J(),a.yn=b,bj(a,!1),a.ba("DocumentBoundsChanged",null,c.copy()),rj(a))}t.Zy=function(){for(var a=new H,b=this.nodes;b.next();){var c=b.value;c.isTopLevel&&a.add(c)}for(b=this.links;b.next();)c=b.value,c.isTopLevel&&a.add(c);return a.iterator};t.Yy=function(){return this.wi.iterator};t.Dz=function(a){Xi(this);a&&jk(this,!0);this.Ok=!0;Dg(this)};
function jk(a,b){for(var c=a.wi.iterator;c.next();)kk(a,c.value,b);null!==a.layout&&(b?a.layout.isValidLayout=!1:a.layout.C())}function kk(a,b,c){if(null!==b){for(var d=b.ol.iterator;d.next();)kk(a,d.value,c);null!==b.layout&&(c?b.layout.isValidLayout=!1:b.layout.C())}}
function vj(a,b){if(a.Ag&&!a.Tt){var c=a.da;a.da=!0;var d=a.undoManager.transactionLevel,e=a.layout;try{0===d&&a.Ca("Layout");var f=a.animationManager;1>=d&&!f.isAnimating&&!f.tb&&(b||f.Qi("Layout"));a.Ag=!1;for(var g=a.wi.iterator;g.next();)ok(a,g.value,b,d);e.isValidLayout||(!b||e.isRealtime||null===e.isRealtime||0===d?(e.doLayout(a),Xi(a),e.isValidLayout=!0):a.Ag=!0)}finally{0===d&&a.bb("Layout"),a.Ag=!e.isValidLayout,a.da=c}}}
function ok(a,b,c,d){if(null!==b){for(var e=b.ol.iterator;e.next();)ok(a,e.value,c,d);e=b.layout;null===e||e.isValidLayout||(!c||e.isRealtime||0===d?(b.kk=!b.location.o(),e.doLayout(b),b.C(32),xj(a,b),e.isValidLayout=!0):a.Ag=!0)}}t.ez=function(){for(var a=new G,b=this.nodes;b.next();){var c=b.value;c.isTopLevel&&null===c.Fi()&&a.add(c)}return a.iterator};
function Ai(a){function b(a){var b=a.toLowerCase(),e=new G;c.add(a,e);c.add(b,e);d.add(a,a);d.add(b,a)}var c=new Ub,d=new Ub;b("AnimationStarting");b("AnimationFinished");b("BackgroundSingleClicked");b("BackgroundDoubleClicked");b("BackgroundContextClicked");b("ClipboardChanged");b("ClipboardPasted");b("DocumentBoundsChanged");b("ExternalObjectsDropped");b("GainedFocus");b("InitialLayoutCompleted");b("LayoutCompleted");b("LinkDrawn");b("LinkRelinked");b("LinkReshaped");b("LostFocus");b("Modified");
b("ObjectSingleClicked");b("ObjectDoubleClicked");b("ObjectContextClicked");b("PartCreated");b("PartResized");b("PartRotated");b("SelectionMoved");b("SelectionCopied");b("SelectionDeleting");b("SelectionDeleted");b("SelectionGrouped");b("SelectionUngrouped");b("ChangingSelection");b("ChangedSelection");b("SubGraphCollapsed");b("SubGraphExpanded");b("TextEdited");b("TreeCollapsed");b("TreeExpanded");b("ViewportBoundsChanged");b("InvalidateDraw");a.Vt=c;a.Ut=d}
function Gj(a,b){var c=a.Ut.K(b);return null!==c?c:a.Ut.K(b.toLowerCase())}function sk(a,b){var c=a.Vt.K(b);if(null!==c)return c;c=a.Vt.K(b.toLowerCase());if(null!==c)return c;v("Unknown DiagramEvent name: "+b);return null}t.Lj=function(a,b){z(a,"string",P,"addDiagramListener:name");z(b,"function",P,"addDiagramListener:listener");a=sk(this,a);null!==a&&a.add(b)};t.pm=function(a,b){z(a,"string",P,"removeDiagramListener:name");z(b,"function",P,"addDiagramListener:listener");a=sk(this,a);null!==a&&a.remove(b)};
t.ba=function(a,b,c){E&&z(a,"string",P,"raiseDiagramEvent:name");var d=sk(this,a),e=new mf;e.diagram=this;a=Gj(this,a);null!==a&&(e.name=a);void 0!==b&&(e.subject=b);void 0!==c&&(e.parameter=c);b=d.length;if(1===b)d.O(0)(e);else if(0!==b)for(d=d.Na(),c=0;c<b;c++)(0,d[c])(e)};function tk(a){if(a.animationManager.isAnimating)return!1;var b=a.currentTool;return b===a.toolManager.findTool("Dragging")?!a.yp||b.isComplexRoutingRealtime:!0}
t.ck=function(a,b){void 0===b&&(b=null);return uk(this,!1,null,b).ck(a.x,a.y,a.width,a.height)};P.prototype.computeOccupiedArea=function(){return this.isVirtualized?this.viewportBounds.copy():this.Pg?Yi(this):this.documentBounds.copy()};
function uk(a,b,c,d){null===a.Qb&&(a.Qb=new vk);if(a.Qb.dt||a.Qb.group!==c||a.Qb.Ox!==d){if(null===c){b=a.computeOccupiedArea();b.Yc(100,100);a.Qb.initialize(b);b=L.alloc();for(var e=a.nodes;e.next();){var f=e.value,g=f.layer;null!==g&&g.visible&&!g.isTemporary&&wk(a,f,d,b)}L.free(b)}else{0<c.memberParts.count&&(b=a.computePartsBounds(c.memberParts,!1),b.Yc(20,20),a.Qb.initialize(b));b=L.alloc();for(e=c.memberParts;e.next();)f=e.value,f instanceof V&&wk(a,f,d,b);L.free(b)}a.Qb.group=c;a.Qb.Ox=d;a.Qb.dt=
!1}else b&&xk(a.Qb);return a.Qb}function wk(a,b,c,d){if(b!==c)if(b.isVisible()&&b.avoidable&&!b.isLinkLabel){var e=b.getAvoidableRect(d),f=a.Qb.Wl;c=a.Qb.Vl;d=e.x+e.width;b=e.y+e.height;for(var g=e.x;g<d;g+=f){for(var h=e.y;h<b;h+=c)yk(a.Qb,g,h);yk(a.Qb,g,b)}for(e=e.y;e<b;e+=c)yk(a.Qb,d,e);yk(a.Qb,d,b)}else if(b instanceof wg)for(b=b.memberParts;b.next();)e=b.value,e instanceof V&&wk(a,e,c,d)}
function zk(a,b){null!==a.Qb&&!a.Qb.dt&&(void 0===b&&(b=null),null===b||b.avoidable&&!b.isLinkLabel)&&(a.Qb.dt=!0)}t=P.prototype;t.Rs=function(a){this.Oq.assign(a);Ak(this,this.Oq).Ra(this.position)?this.wf():Bk(this)};
function Bk(a){-1===a.yk&&(a.yk=wa(function(){if(-1!==a.yk&&(a.wf(),null!==a.lastInput.event)){var b=Ak(a,a.Oq);b.Ra(a.position)||(a.position=b,a.lastInput.documentPoint=a.Ct(a.Oq),a.doMouseMove(),a.Pg=!0,ej(a,a.documentBounds.copy().Zc(a.computeBounds())),a.rc=!0,a.kd(),Bk(a))}},a.Wm))}t.wf=function(){-1!==this.yk&&(qa.clearTimeout(this.yk),this.yk=-1)};
function Ak(a,b){var c=a.position,d=a.Xm;if(0>=d.top&&0>=d.left&&0>=d.right&&0>=d.bottom)return c;var e=a.viewportBounds,f=a.scale;e=L.allocAt(0,0,e.width*f,e.height*f);var g=J.allocAt(0,0);if(b.x>=e.x&&b.x<e.x+d.left){var h=Math.max(a.scrollHorizontalLineChange,1);h|=0;g.x-=h;b.x<e.x+d.left/2&&(g.x-=h);b.x<e.x+d.left/4&&(g.x-=4*h)}else b.x<=e.x+e.width&&b.x>e.x+e.width-d.right&&(h=Math.max(a.scrollHorizontalLineChange,1),h|=0,g.x+=h,b.x>e.x+e.width-d.right/2&&(g.x+=h),b.x>e.x+e.width-d.right/4&&
(g.x+=4*h));b.y>=e.y&&b.y<e.y+d.top?(a=Math.max(a.scrollVerticalLineChange,1),a|=0,g.y-=a,b.y<e.y+d.top/2&&(g.y-=a),b.y<e.y+d.top/4&&(g.y-=4*a)):b.y<=e.y+e.height&&b.y>e.y+e.height-d.bottom&&(a=Math.max(a.scrollVerticalLineChange,1),a|=0,g.y+=a,b.y>e.y+e.height-d.bottom/2&&(g.y+=a),b.y>e.y+e.height-d.bottom/4&&(g.y+=4*a));g.Ra(gc)||(c=new J(c.x+g.x/f,c.y+g.y/f));L.free(e);J.free(g);return c}t.lt=function(){return null};t.nv=function(){return null};t.Ww=function(a,b){this.vl.add(a,b)};
t.Fz=function(a){if(!Hh)return null;void 0===a&&(a=new xb);a.returnType="Image";return this.wx(a)};t.wx=function(a){function b(){var k=+new Date;d=!0;for(e.reset();e.next();)if(!e.value[0].kl){d=!1;break}d||k-g>f?Ck(h,a,c):qa.requestAnimationFrame(b)}void 0===a&&(a=new xb);for(var c=a.callback,d=!0,e=this.Bj.iterator;e.next();)if(!e.value[0].kl){d=!1;break}if("function"!==typeof c||d)return Ck(this,a,c);var f=a.callbackTimeout||300,g=+new Date,h=this;qa.requestAnimationFrame(function(){b()});return null};
function Ck(a,b,c){var d=Dk(a,b,"canvas");if(null===d)return null;a=d.W.canvas;var e=null;if(null!==a)switch(e=b.returnType,void 0===e?e="string":e=e.toLowerCase(),e){case "imagedata":e=d.getImageData(0,0,a.width,a.height);break;case "image":d=(b.document||document).createElement("img");d.src=a.toDataURL(b.type,b.details);e=d;break;case "blob":"function"!==typeof c&&v('Error: Diagram.makeImageData called with "returnType: toBlob", but no required "callback" function property defined.');if("function"===
typeof a.toBlob)return a.toBlob(c,b.type,b.details),"toBlob";if("function"===typeof a.msToBlob)return c(a.msToBlob()),"msToBlob";c(null);return null;default:e=a.toDataURL(b.type,b.details)}return"function"===typeof c?(c(e),null):e}
function Dk(a,b,c){a.animationManager.zd();a.kd();if(null===a.Ea)return null;"object"!==typeof b&&v("properties argument must be an Object.");var d=!1,e=b.size||null,f=b.scale||null;void 0!==b.scale&&isNaN(b.scale)&&(f="NaN");var g=b.maxSize;void 0===b.maxSize&&(d=!0,g="SVG"===c?new Zb(Infinity,Infinity):new Zb(2E3,2E3));var h=b.position||null,k=b.parts||null,l=void 0===b.padding?1:b.padding,m=b.background||null,n=b.omitTemporary;void 0===n&&(n=!0);var p=b.document||document,q=b.elementFinished||
null,r=b.showTemporary;void 0===r&&(r=!n);b=b.showGrid;void 0===b&&(b=r);null!==e&&isNaN(e.width)&&isNaN(e.height)&&(e=null);"number"===typeof l?l=new Jc(l):l instanceof Jc||v("MakeImage padding must be a Margin or a number.");l.left=Math.max(l.left,0);l.right=Math.max(l.right,0);l.top=Math.max(l.top,0);l.bottom=Math.max(l.bottom,0);a.bd.Vc(!0);n=new Ek(null,p);var u=n.context;if(!(e||f||k||h)){n.width=a.Aa+Math.ceil(l.left+l.right);n.height=a.ya+Math.ceil(l.top+l.bottom);if("SVG"===c){f=a.vl.K("SVG");
if(null===f)return null;f.resize(n.width,n.height,n.width,n.height);f.ownerDocument=p;f.Up=q;Ej(a,f.context,l,new Zb(n.width,n.height),a.Da,a.ua,k,m,r,b);return f.context}a.An=!1;Ej(a,u,l,new Zb(n.width,n.height),a.Da,a.ua,k,m,r,b);a.An=!0;return n.context}var y=a.er,x=a.documentBounds.copy();x.Pv(a.hb);if(r)for(var A=a.Qa.j,C=A.length,F=0;F<C;F++){var I=A[F];if(I.visible&&I.isTemporary){I=I.Ga.j;for(var O=I.length,S=0;S<O;S++){var T=I[S];T.isInDocumentBounds&&T.isVisible()&&(T=T.actualBounds,T.o()&&
x.Zc(T))}}}A=new J(x.x,x.y);if(null!==k){C=!0;F=k.iterator;for(F.reset();F.next();)if(I=F.value,I instanceof R&&(O=I.layer,(null===O||O.visible)&&(null===O||r||!O.isTemporary)&&I.isVisible()&&(I=I.actualBounds,I.o())))if(C){C=!1;var ca=I.copy()}else ca.Zc(I);C&&(ca=new L(0,0,0,0));x.width=ca.width;x.height=ca.height;A.x=ca.x;A.y=ca.y}null!==h&&h.o()&&(A=h,f||(f=y));ca=h=0;null!==l&&(h=l.left+l.right,ca=l.top+l.bottom);C=F=0;null!==e&&(F=e.width,C=e.height,isFinite(F)&&(F=Math.max(0,F-h)),isFinite(C)&&
(C=Math.max(0,C-ca)));null!==e&&null!==f?("NaN"===f&&(f=y),e.o()?(e=F,x=C):isNaN(C)?(e=F,x=x.height*f):(e=x.width*f,x=C)):null!==e?e.o()?(f=Math.min(F/x.width,C/x.height),e=F,x=C):isNaN(C)?(f=F/x.width,e=F,x=x.height*f):(f=C/x.height,e=x.width*f,x=C):null!==f?"NaN"===f&&g.o()?(f=Math.min((g.width-h)/x.width,(g.height-ca)/x.height),f>y?(f=y,e=x.width,x=x.height):(e=g.width,x=g.height)):(e=x.width*f,x=x.height*f):(f=y,e=x.width,x=x.height);null!==l?(e+=h,x+=ca):l=new Jc(0);null!==g&&(y=g.width,g=g.height,
"SVG"!==c&&d&&!Fk&&E&&(e>y||x>g)&&(Ga("Diagram.makeImage(data): Diagram width or height is larger than the default max size. ("+Math.ceil(e)+"x"+Math.ceil(x)+" vs 2000x2000) Consider increasing the max size."),Fk=!0),isNaN(y)&&(y=2E3),isNaN(g)&&(g=2E3),isFinite(y)&&(e=Math.min(e,y)),isFinite(g)&&(x=Math.min(x,g)));n.width=Math.ceil(e);n.height=Math.ceil(x);if("SVG"===c){c=a.vl.K("SVG");if(null===c)return null;c.resize(n.width,n.height,n.width,n.height);c.ownerDocument=p;c.Up=q;Ej(a,c.context,l,new Zb(Math.ceil(e),
Math.ceil(x)),f,A,k,m,r,b);return c.context}a.An=!1;Ej(a,u,l,new Zb(Math.ceil(e),Math.ceil(x)),f,A,k,m,r,b);a.An=!0;return n.context}
na.Object.defineProperties(P.prototype,{div:{configurable:!0,get:function(){return this.Ja},set:function(a){null!==a&&w(a,HTMLDivElement,P,"div");if(this.Ja!==a){bb=[];var b=this.Ja;null!==b?(b.G=void 0,b.innerHTML="",null!==this.Ea&&(b=this.Ea.Ha,b.removeEventListener("touchstart",this.Uv,!1),b.removeEventListener("touchmove",this.Tv,!1),b.removeEventListener("touchend",this.Sv,!1),this.Ea.ix()),b=this.toolManager,null!==b&&(b.mouseDownTools.each(function(a){a.cancelWaitAfter()}),b.mouseMoveTools.each(function(a){a.cancelWaitAfter()}),
b.mouseUpTools.each(function(a){a.cancelWaitAfter()})),b.cancelWaitAfter(),this.currentTool.doCancel(),this.bd=this.Ea=null,qa.removeEventListener("resize",this.$v,!1),qa.removeEventListener("mousemove",this.gk,!0),qa.removeEventListener("mousedown",this.fk,!0),qa.removeEventListener("mouseup",this.ik,!0),qa.removeEventListener("wheel",this.jk,!0),qa.removeEventListener("mouseout",this.hk,!0),yf===this&&(yf=null)):this.je=!1;this.Ja=null;if(null!==a){if(b=a.G)b.div=null;Ki(this,a);this.zh()}}}},lv:{configurable:!0,
enumerable:!0,get:function(){return this.qb},set:function(a){this.qb=a}},Ni:{configurable:!0,get:function(){return this.je}},draggedLink:{configurable:!0,get:function(){return this.hr},set:function(a){this.hr!==a&&(this.hr=a,null!==a&&(this.cs=a.fromPort,this.ds=a.toPort))}},zx:{configurable:!0,get:function(){return this.cs},set:function(a){this.cs=a}},Ax:{configurable:!0,get:function(){return this.ds},set:function(a){this.ds=a}},animationManager:{configurable:!0,
enumerable:!0,get:function(){return this.Nq}},undoManager:{configurable:!0,get:function(){return this.bc.undoManager}},skipsUndoManager:{configurable:!0,get:function(){return this.bh},set:function(a){z(a,"boolean",P,"skipsUndoManager");this.bh=a;this.bc.skipsUndoManager=a}},delaysLayout:{configurable:!0,get:function(){return this.Tt},set:function(a){this.Tt=a}},validCycle:{configurable:!0,get:function(){return this.Hs},set:function(a){var b=
this.Hs;b!==a&&(tb(a,P,P,"validCycle"),this.Hs=a,this.g("validCycle",b,a))}},layers:{configurable:!0,get:function(){return this.Qa.iterator}},isModelReadOnly:{configurable:!0,get:function(){var a=this.bc;return null===a?!1:a.isReadOnly},set:function(a){var b=this.bc;null!==b&&(b.isReadOnly=a)}},isReadOnly:{configurable:!0,get:function(){return this.Lf},set:function(a){var b=this.Lf;b!==a&&(z(a,"boolean",P,"isReadOnly"),this.Lf=a,this.g("isReadOnly",b,a))}},
isEnabled:{configurable:!0,get:function(){return this.Hc},set:function(a){var b=this.Hc;b!==a&&(z(a,"boolean",P,"isEnabled"),this.Hc=a,this.g("isEnabled",b,a))}},allowClipboard:{configurable:!0,get:function(){return this.Eq},set:function(a){var b=this.Eq;b!==a&&(z(a,"boolean",P,"allowClipboard"),this.Eq=a,this.g("allowClipboard",b,a))}},allowCopy:{configurable:!0,get:function(){return this.Ch},set:function(a){var b=this.Ch;b!==a&&(z(a,"boolean",P,"allowCopy"),
this.Ch=a,this.g("allowCopy",b,a))}},allowDelete:{configurable:!0,get:function(){return this.Dh},set:function(a){var b=this.Dh;b!==a&&(z(a,"boolean",P,"allowDelete"),this.Dh=a,this.g("allowDelete",b,a))}},allowDragOut:{configurable:!0,get:function(){return this.Fq},set:function(a){var b=this.Fq;b!==a&&(z(a,"boolean",P,"allowDragOut"),this.Fq=a,this.g("allowDragOut",b,a))}},allowDrop:{configurable:!0,get:function(){return this.Gq},set:function(a){var b=this.Gq;
b!==a&&(z(a,"boolean",P,"allowDrop"),this.Gq=a,this.g("allowDrop",b,a))}},allowTextEdit:{configurable:!0,get:function(){return this.Mh},set:function(a){var b=this.Mh;b!==a&&(z(a,"boolean",P,"allowTextEdit"),this.Mh=a,this.g("allowTextEdit",b,a))}},allowGroup:{configurable:!0,get:function(){return this.Eh},set:function(a){var b=this.Eh;b!==a&&(z(a,"boolean",P,"allowGroup"),this.Eh=a,this.g("allowGroup",b,a))}},allowUngroup:{configurable:!0,get:function(){return this.Nh},
set:function(a){var b=this.Nh;b!==a&&(z(a,"boolean",P,"allowUngroup"),this.Nh=a,this.g("allowUngroup",b,a))}},allowInsert:{configurable:!0,get:function(){return this.Iq},set:function(a){var b=this.Iq;b!==a&&(z(a,"boolean",P,"allowInsert"),this.Iq=a,this.g("allowInsert",b,a))}},allowLink:{configurable:!0,get:function(){return this.Fh},set:function(a){var b=this.Fh;b!==a&&(z(a,"boolean",P,"allowLink"),this.Fh=a,this.g("allowLink",b,a))}},allowRelink:{configurable:!0,
get:function(){return this.Hh},set:function(a){var b=this.Hh;b!==a&&(z(a,"boolean",P,"allowRelink"),this.Hh=a,this.g("allowRelink",b,a))}},allowMove:{configurable:!0,get:function(){return this.Gh},set:function(a){var b=this.Gh;b!==a&&(z(a,"boolean",P,"allowMove"),this.Gh=a,this.g("allowMove",b,a))}},allowReshape:{configurable:!0,get:function(){return this.Ih},set:function(a){var b=this.Ih;b!==a&&(z(a,"boolean",P,"allowReshape"),this.Ih=a,this.g("allowReshape",b,a))}},allowResize:{configurable:!0,
enumerable:!0,get:function(){return this.Jh},set:function(a){var b=this.Jh;b!==a&&(z(a,"boolean",P,"allowResize"),this.Jh=a,this.g("allowResize",b,a))}},allowRotate:{configurable:!0,get:function(){return this.Kh},set:function(a){var b=this.Kh;b!==a&&(z(a,"boolean",P,"allowRotate"),this.Kh=a,this.g("allowRotate",b,a))}},allowSelect:{configurable:!0,get:function(){return this.Lh},set:function(a){var b=this.Lh;b!==a&&(z(a,"boolean",P,"allowSelect"),this.Lh=a,this.g("allowSelect",
b,a))}},allowUndo:{configurable:!0,get:function(){return this.Jq},set:function(a){var b=this.Jq;b!==a&&(z(a,"boolean",P,"allowUndo"),this.Jq=a,this.g("allowUndo",b,a))}},allowZoom:{configurable:!0,get:function(){return this.Lq},set:function(a){var b=this.Lq;b!==a&&(z(a,"boolean",P,"allowZoom"),this.Lq=a,this.g("allowZoom",b,a))}},hasVerticalScrollbar:{configurable:!0,get:function(){return this.wr},set:function(a){var b=this.wr;b!==a&&(z(a,"boolean",P,"hasVerticalScrollbar"),
this.wr=a,rj(this),this.S(),this.g("hasVerticalScrollbar",b,a),bj(this,!1))}},hasHorizontalScrollbar:{configurable:!0,get:function(){return this.vr},set:function(a){var b=this.vr;b!==a&&(z(a,"boolean",P,"hasHorizontalScrollbar"),this.vr=a,rj(this),this.S(),this.g("hasHorizontalScrollbar",b,a),bj(this,!1))}},allowHorizontalScroll:{configurable:!0,get:function(){return this.Hq},set:function(a){var b=this.Hq;b!==a&&(z(a,"boolean",P,"allowHorizontalScroll"),this.Hq=a,this.g("allowHorizontalScroll",
b,a),bj(this,!1))}},allowVerticalScroll:{configurable:!0,get:function(){return this.Kq},set:function(a){var b=this.Kq;b!==a&&(z(a,"boolean",P,"allowVerticalScroll"),this.Kq=a,this.g("allowVerticalScroll",b,a),bj(this,!1))}},scrollHorizontalLineChange:{configurable:!0,get:function(){return this.ps},set:function(a){var b=this.ps;b!==a&&(z(a,"number",P,"scrollHorizontalLineChange"),0>a&&Ca(a,">= 0",P,"scrollHorizontalLineChange"),this.ps=a,this.g("scrollHorizontalLineChange",
b,a))}},scrollVerticalLineChange:{configurable:!0,get:function(){return this.ss},set:function(a){var b=this.ss;b!==a&&(z(a,"number",P,"scrollVerticalLineChange"),0>a&&Ca(a,">= 0",P,"scrollVerticalLineChange"),this.ss=a,this.g("scrollVerticalLineChange",b,a))}},lastInput:{configurable:!0,get:function(){return this.pj},set:function(a){E&&w(a,kf,P,"lastInput");this.pj=a}},firstInput:{configurable:!0,get:function(){return this.Vh},set:function(a){E&&w(a,kf,P,
"firstInput");this.Vh=a}},currentCursor:{configurable:!0,get:function(){return this.Zq},set:function(a){""===a&&(a=this.tn);if(this.Zq!==a){z(a,"string",P,"currentCursor");var b=this.Ea,c=this.Ja;if(null!==b){this.Zq=a;var d=b.style.cursor;b.style.cursor=a;c.style.cursor=a;b.style.cursor===d&&(b.style.cursor="-webkit-"+a,c.style.cursor="-webkit-"+a,b.style.cursor===d&&(b.style.cursor="-moz-"+a,c.style.cursor="-moz-"+a,b.style.cursor===d&&(b.style.cursor=a,c.style.cursor=a)))}}}},defaultCursor:{configurable:!0,
enumerable:!0,get:function(){return this.tn},set:function(a){""===a&&(a="auto");var b=this.tn;b!==a&&(z(a,"string",P,"defaultCursor"),this.tn=a,this.g("defaultCursor",b,a))}},click:{configurable:!0,get:function(){return this.Bf},set:function(a){var b=this.Bf;b!==a&&(null!==a&&z(a,"function",P,"click"),this.Bf=a,this.g("click",b,a))}},doubleClick:{configurable:!0,get:function(){return this.Gf},set:function(a){var b=this.Gf;b!==a&&(null!==a&&z(a,"function",P,"doubleClick"),
this.Gf=a,this.g("doubleClick",b,a))}},contextClick:{configurable:!0,get:function(){return this.Cf},set:function(a){var b=this.Cf;b!==a&&(null!==a&&z(a,"function",P,"contextClick"),this.Cf=a,this.g("contextClick",b,a))}},mouseOver:{configurable:!0,get:function(){return this.Wf},set:function(a){var b=this.Wf;b!==a&&(null!==a&&z(a,"function",P,"mouseOver"),this.Wf=a,this.g("mouseOver",b,a))}},mouseHover:{configurable:!0,get:function(){return this.Uf},set:function(a){var b=
this.Uf;b!==a&&(null!==a&&z(a,"function",P,"mouseHover"),this.Uf=a,this.g("mouseHover",b,a))}},mouseHold:{configurable:!0,get:function(){return this.Tf},set:function(a){var b=this.Tf;b!==a&&(null!==a&&z(a,"function",P,"mouseHold"),this.Tf=a,this.g("mouseHold",b,a))}},mouseDragOver:{configurable:!0,get:function(){return this.Xr},set:function(a){var b=this.Xr;b!==a&&(null!==a&&z(a,"function",P,"mouseDragOver"),this.Xr=a,this.g("mouseDragOver",b,a))}},mouseDrop:{configurable:!0,
enumerable:!0,get:function(){return this.Rf},set:function(a){var b=this.Rf;b!==a&&(E&&null!==a&&z(a,"function",P,"mouseDrop"),this.Rf=a,this.g("mouseDrop",b,a))}},handlesDragDropForTopLevelParts:{configurable:!0,get:function(){return this.ur},set:function(a){var b=this.ur;b!==a&&(z(a,"boolean",P,"handlesDragDropForTopLevelParts"),this.ur=a,this.g("handlesDragDropForTopLevelParts",b,a))}},mouseEnter:{configurable:!0,get:function(){return this.Sf},set:function(a){var b=this.Sf;
b!==a&&(null!==a&&z(a,"function",P,"mouseEnter"),this.Sf=a,this.g("mouseEnter",b,a))}},mouseLeave:{configurable:!0,get:function(){return this.Vf},set:function(a){var b=this.Vf;b!==a&&(null!==a&&z(a,"function",P,"mouseLeave"),this.Vf=a,this.g("mouseLeave",b,a))}},toolTip:{configurable:!0,get:function(){return this.hg},set:function(a){var b=this.hg;b!==a&&(!E||null===a||a instanceof Cf||a instanceof Hf||v("Diagram.toolTip must be an Adornment or HTMLInfo."),this.hg=a,this.g("toolTip",
b,a))}},contextMenu:{configurable:!0,get:function(){return this.Df},set:function(a){var b=this.Df;b!==a&&(!E||a instanceof Cf||a instanceof Hf||v("Diagram.contextMenu must be an Adornment or HTMLInfo."),this.Df=a,this.g("contextMenu",b,a))}},commandHandler:{configurable:!0,get:function(){return this.L},set:function(a){this.L!==a&&(this.L=a,a.ob(this))}},toolManager:{configurable:!0,get:function(){return this.Wb},set:function(a){this.Wb!==a&&(w(a,$a,P,"toolManager"),
this.Wb=a,a.ob(this))}},defaultTool:{configurable:!0,get:function(){return this.Ma},set:function(a){var b=this.Ma;b!==a&&(w(a,vf,P,"defaultTool"),this.Ma=a,a.ob(this),this.currentTool===b&&(this.currentTool=a))}},currentTool:{configurable:!0,get:function(){return this.ea},set:function(a){var b=this.ea;null!==b&&(b.isActive&&b.doDeactivate(),b.cancelWaitAfter(),b.doStop());null===a&&(a=this.defaultTool);null!==a&&(w(a,vf,P,"currentTool"),this.ea=a,a.ob(this),a.doStart())}},
selection:{configurable:!0,get:function(){return this.vs}},maxSelectionCount:{configurable:!0,get:function(){return this.Tr},set:function(a){var b=this.Tr;if(b!==a)if(z(a,"number",P,"maxSelectionCount"),0<=a&&!isNaN(a)){if(this.Tr=a,this.g("maxSelectionCount",b,a),!this.undoManager.isUndoingRedoing&&(a=this.selection.count-a,0<a)){this.ba("ChangingSelection",this.selection);b=this.selection.Na();for(var c=0;c<a;c++)b[c].isSelected=!1;this.ba("ChangedSelection",this.selection)}}else Ca(a,
">= 0",P,"maxSelectionCount")}},nodeSelectionAdornmentTemplate:{configurable:!0,get:function(){return this.$r},set:function(a){var b=this.$r;b!==a&&(w(a,Cf,P,"nodeSelectionAdornmentTemplate"),this.$r=a,this.g("nodeSelectionAdornmentTemplate",b,a))}},groupSelectionAdornmentTemplate:{configurable:!0,get:function(){return this.sr},set:function(a){var b=this.sr;b!==a&&(w(a,Cf,P,"groupSelectionAdornmentTemplate"),this.sr=a,this.g("groupSelectionAdornmentTemplate",b,a))}},linkSelectionAdornmentTemplate:{configurable:!0,
enumerable:!0,get:function(){return this.Pr},set:function(a){var b=this.Pr;b!==a&&(w(a,Cf,P,"linkSelectionAdornmentTemplate"),this.Pr=a,this.g("linkSelectionAdornmentTemplate",b,a))}},highlighteds:{configurable:!0,get:function(){return this.xr}},isModified:{configurable:!0,get:function(){var a=this.undoManager;return a.isEnabled?null!==a.currentTransaction?!0:this.w&&this.ie!==a.historyIndex:this.w},set:function(a){if(this.w!==a){z(a,"boolean",P,"isModified");this.w=a;
var b=this.undoManager;!a&&b.isEnabled&&(this.ie=b.historyIndex);a||dk(this)}}},model:{configurable:!0,get:function(){return this.bc},set:function(a){var b=this.bc;if(b!==a){w(a,X,P,"model");this.currentTool.doCancel();null!==b&&b.undoManager!==a.undoManager&&b.undoManager.isInTransaction&&v("Do not replace a Diagram.model while a transaction is in progress.");Ni(this,!0);this.je=!1;this.Uk=!0;this.ie=-2;this.ud=!1;var c=this.ac;this.ac=!0;this.animationManager.Qi("Model");null!==b&&
(null!==this.qe&&this.qe.each(function(a){b.mk(a)}),b.mk(this.Em));this.bc=a;this.partManager=ek(this.bc.constructor.type);a.mh(this.xg);this.partManager.addAllModeledParts();a.mk(this.xg);a.mh(this.Em);null!==this.qe&&this.qe.each(function(b){a.mh(b)});this.ac=c;this.qb||this.S();null!==b&&(a.undoManager.isEnabled=b.undoManager.isEnabled)}}},da:{configurable:!0,get:function(){return this.Pc},set:function(a){this.Pc=a}},jt:{configurable:!0,get:function(){return this.Cq}},
skipsModelSourceBindings:{configurable:!0,get:function(){return this.Fm},set:function(a){this.Fm=a}},Ti:{configurable:!0,get:function(){return this.yu},set:function(a){this.yu=a}},nodeTemplate:{configurable:!0,get:function(){return this.Xf.K("")},set:function(a){var b=this.Xf.K("");b!==a&&(w(a,R,P,"nodeTemplate"),this.Xf.add("",a),this.g("nodeTemplate",b,a),this.undoManager.isUndoingRedoing||this.yd())}},nodeTemplateMap:{configurable:!0,get:function(){return this.Xf},
set:function(a){var b=this.Xf;b!==a&&(w(a,Ub,P,"nodeTemplateMap"),this.Xf=a,this.g("nodeTemplateMap",b,a),this.undoManager.isUndoingRedoing||this.yd())}},groupTemplate:{configurable:!0,get:function(){return this.Wh.K("")},set:function(a){var b=this.Wh.K("");b!==a&&(w(a,wg,P,"groupTemplate"),this.Wh.add("",a),this.g("groupTemplate",b,a),this.undoManager.isUndoingRedoing||this.yd())}},groupTemplateMap:{configurable:!0,get:function(){return this.Wh},set:function(a){var b=
this.Wh;b!==a&&(w(a,Ub,P,"groupTemplateMap"),this.Wh=a,this.g("groupTemplateMap",b,a),this.undoManager.isUndoingRedoing||this.yd())}},linkTemplate:{configurable:!0,get:function(){return this.Tg.K("")},set:function(a){var b=this.Tg.K("");b!==a&&(w(a,Q,P,"linkTemplate"),this.Tg.add("",a),this.g("linkTemplate",b,a),this.undoManager.isUndoingRedoing||this.yd())}},linkTemplateMap:{configurable:!0,get:function(){return this.Tg},set:function(a){var b=this.Tg;b!==a&&(w(a,Ub,P,
"linkTemplateMap"),this.Tg=a,this.g("linkTemplateMap",b,a),this.undoManager.isUndoingRedoing||this.yd())}},isMouseOverDiagram:{configurable:!0,get:function(){return this.ke},set:function(a){this.ke=a}},isMouseCaptured:{configurable:!0,get:function(){return this.Oc},set:function(a){var b=this.Ea;null!==b&&(b=b.Ha,b instanceof SVGElement||(a?(this.lastInput.bubbles=!1,this.Mq?(b.removeEventListener("pointermove",this.lm,!1),b.removeEventListener("pointerdown",this.km,!1),
b.removeEventListener("pointerup",this.nm,!1),b.removeEventListener("pointerout",this.mm,!1),qa.addEventListener("pointermove",this.lm,!0),qa.addEventListener("pointerdown",this.km,!0),qa.addEventListener("pointerup",this.nm,!0),qa.addEventListener("pointerout",this.mm,!0)):(b.removeEventListener("mousemove",this.gk,!1),b.removeEventListener("mousedown",this.fk,!1),b.removeEventListener("mouseup",this.ik,!1),b.removeEventListener("mouseout",this.hk,!1),qa.addEventListener("mousemove",this.gk,!0),
qa.addEventListener("mousedown",this.fk,!0),qa.addEventListener("mouseup",this.ik,!0),qa.addEventListener("mouseout",this.hk,!0)),b.removeEventListener("wheel",this.jk,!1),qa.addEventListener("wheel",this.jk,!0),qa.addEventListener("selectstart",this.preventDefault,!1)):(this.Mq?(qa.removeEventListener("pointermove",this.lm,!0),qa.removeEventListener("pointerdown",this.km,!0),qa.removeEventListener("pointerup",this.nm,!0),qa.removeEventListener("pointerout",this.mm,!0),b.addEventListener("pointermove",
this.lm,!1),b.addEventListener("pointerdown",this.km,!1),b.addEventListener("pointerup",this.nm,!1),b.addEventListener("pointerout",this.mm,!1)):(qa.removeEventListener("mousemove",this.gk,!0),qa.removeEventListener("mousedown",this.fk,!0),qa.removeEventListener("mouseup",this.ik,!0),qa.removeEventListener("mouseout",this.hk,!0),b.addEventListener("mousemove",this.gk,!1),b.addEventListener("mousedown",this.fk,!1),b.addEventListener("mouseup",this.ik,!1),b.addEventListener("mouseout",this.hk,!1)),
qa.removeEventListener("wheel",this.jk,!0),qa.removeEventListener("selectstart",this.preventDefault,!1),b.addEventListener("wheel",this.jk,!1)),this.Oc=a))}},position:{configurable:!0,get:function(){return this.ua},set:function(a){var b=J.alloc().assign(this.ua);if(!b.A(a)){w(a,J,P,"position");var c=this.viewportBounds.copy();this.ua.assign(a);this.qb||null===this.Ea&&!this.Hp.o()||(this.qb=!0,a=this.scale,dj(this,this.yn,this.Aa/a,this.ya/a,this.bj,!1),this.qb=!1);ni(this.animationManager,
b,this.ua);this.qb||this.oq(c,this.viewportBounds,this.Da,!1)}J.free(b)}},initialPosition:{configurable:!0,get:function(){return this.zr},set:function(a){this.zr.A(a)||(w(a,J,P,"initialPosition"),this.zr=a.J())}},initialScale:{configurable:!0,get:function(){return this.Ar},set:function(a){this.Ar!==a&&(z(a,"number",P,"initialScale"),this.Ar=a)}},grid:{configurable:!0,get:function(){null===this.Ib&&Si(this);return this.Ib},set:function(a){var b=this.Ib;if(b!==
a){null===b&&(Si(this),b=this.Ib);w(a,W,P,"grid");a.type!==W.Grid&&v("Diagram.grid must be a Panel of type Panel.Grid");var c=b.panel;null!==c&&c.remove(b);this.Ib=a;a.name="GRID";null!==c&&c.add(a);uj(this);this.S();this.g("grid",b,a)}}},viewportBounds:{configurable:!0,get:function(){var a=this.Pw,b=this.ua,c=this.Da;if(null===this.Ea)return this.Hp.o()&&a.h(b.x,b.y,this.Aa/c,this.ya/c),a;a.h(b.x,b.y,Math.max(this.Aa,0)/c,Math.max(this.ya,0)/c);return a}},viewSize:{configurable:!0,
enumerable:!0,get:function(){return this.Hp},set:function(a){var b=this.viewSize;b.A(a)||(w(a,Zb,P,"viewSize"),this.Hp=a=a.J(),this.Aa=a.width,this.ya=a.height,this.Ya(),this.g("viewSize",b,a))}},fixedBounds:{configurable:!0,get:function(){return this.pr},set:function(a){var b=this.pr;b.A(a)||(w(a,L,P,"fixedBounds"),(E&&Infinity===a.width||-Infinity===a.width||Infinity===a.height||-Infinity===a.height)&&v("fixedBounds width/height must not be Infinity"),this.pr=a=a.J(),this.Ya(),this.g("fixedBounds",
b,a))}},scrollMargin:{configurable:!0,get:function(){return this.pi},set:function(a){"number"===typeof a?a=new Jc(a):w(a,Jc,P,"scrollMargin");var b=this.pi;b.A(a)||(this.pi=a=a.J(),this.g("scrollMargin",b,a),this.zh())}},scrollMode:{configurable:!0,get:function(){return this.qs},set:function(a){var b=this.qs;b!==a&&(tb(a,P,P,"scrollMode"),this.qs=a,a===yi&&bj(this,!1),this.g("scrollMode",b,a),this.zh())}},scrollsPageOnFocus:{configurable:!0,get:function(){return this.ts},
set:function(a){var b=this.ts;b!==a&&(z(a,"boolean",P,"scrollsPageOnFocus"),this.ts=a,this.g("scrollsPageOnFocus",b,a))}},positionComputation:{configurable:!0,get:function(){return this.js},set:function(a){var b=this.js;b!==a&&(null!==a&&z(a,"function",P,"positionComputation"),this.js=a,bj(this,!1),this.g("positionComputation",b,a))}},scaleComputation:{configurable:!0,get:function(){return this.ns},set:function(a){var b=this.ns;b!==a&&(null!==a&&z(a,"function",P,"scaleComputation"),
this.ns=a,bk(this,this.scale,this.scale),this.g("scaleComputation",b,a))}},documentBounds:{configurable:!0,get:function(){return this.yn}},isVirtualized:{configurable:!0,get:function(){return this.Kr},set:function(a){var b=this.Kr;b!==a&&(z(a,"boolean",P,"isVirtualized"),this.Kr=a,this.g("isVirtualized",b,a))}},scale:{configurable:!0,get:function(){return this.Da},set:function(a){var b=this.Da;B(a,P,"scale");b!==a&&bk(this,b,a)}},defaultScale:{configurable:!0,
enumerable:!0,get:function(){return this.er},set:function(a){E&&B(a,P,"defaultScale");!E||0<a||v("defaultScale must be larger than zero, not: "+a);this.er=a}},autoScale:{configurable:!0,get:function(){return this.$i},set:function(a){var b=this.$i;b!==a&&(tb(a,P,P,"autoScale"),this.$i=a,this.g("autoScale",b,a),a!==zi&&bj(this,!1))}},initialAutoScale:{configurable:!0,get:function(){return this.Zh},set:function(a){var b=this.Zh;b!==a&&(tb(a,P,P,"initialAutoScale"),this.Zh=
a,this.g("initialAutoScale",b,a))}},initialViewportSpot:{configurable:!0,get:function(){return this.Br},set:function(a){var b=this.Br;b!==a&&(w(a,M,P,"initialViewportSpot"),a.Za()||v("initialViewportSpot must be a specific Spot: "+a),this.Br=a,this.g("initialViewportSpot",b,a))}},initialDocumentSpot:{configurable:!0,get:function(){return this.yr},set:function(a){var b=this.yr;b!==a&&(w(a,M,P,"initialDocumentSpot"),a.Za()||v("initialViewportSpot must be a specific Spot: "+
a),this.yr=a,this.g("initialDocumentSpot",b,a))}},minScale:{configurable:!0,get:function(){return this.Ur},set:function(a){B(a,P,"minScale");var b=this.Ur;b!==a&&(0<a?(this.Ur=a,this.g("minScale",b,a),a>this.scale&&(this.scale=a)):Ca(a,"> 0",P,"minScale"))}},maxScale:{configurable:!0,get:function(){return this.Sr},set:function(a){B(a,P,"maxScale");var b=this.Sr;b!==a&&(0<a?(this.Sr=a,this.g("maxScale",b,a),a<this.scale&&(this.scale=a)):Ca(a,"> 0",P,"maxScale"))}},zoomPoint:{configurable:!0,
enumerable:!0,get:function(){return this.Ks},set:function(a){this.Ks.A(a)||(w(a,J,P,"zoomPoint"),this.Ks=a=a.J())}},contentAlignment:{configurable:!0,get:function(){return this.bj},set:function(a){var b=this.bj;b.A(a)||(w(a,M,P,"contentAlignment"),this.bj=a=a.J(),this.g("contentAlignment",b,a),bj(this,!1))}},initialContentAlignment:{configurable:!0,get:function(){return this.Rn},set:function(a){var b=this.Rn;b.A(a)||(w(a,M,P,"initialContentAlignment"),this.Rn=a=a.J(),this.g("initialContentAlignment",
b,a))}},padding:{configurable:!0,get:function(){return this.hb},set:function(a){"number"===typeof a?a=new Jc(a):w(a,Jc,P,"padding");var b=this.hb;b.A(a)||(this.hb=a=a.J(),this.Ya(),this.g("padding",b,a))}},partManager:{configurable:!0,get:function(){return this.Xa},set:function(a){var b=this.Xa;b!==a&&(w(a,Di,P,"partManager"),null!==a.diagram&&v("Cannot share PartManagers between Diagrams: "+a.toString()),null!==b&&b.ob(null),this.Xa=a,a.ob(this))}},nodes:{configurable:!0,
enumerable:!0,get:function(){return this.partManager.nodes.iterator}},links:{configurable:!0,get:function(){return this.partManager.links.iterator}},parts:{configurable:!0,get:function(){return this.partManager.parts.iterator}},layout:{configurable:!0,get:function(){return this.kc},set:function(a){var b=this.kc;b!==a&&(w(a,Ii,P,"layout"),this.kc=a,a.diagram=this,a.group=null,this.Ag=!0,this.g("layout",b,a),this.gc())}},isTreePathToChildren:{configurable:!0,
enumerable:!0,get:function(){return this.Jr},set:function(a){var b=this.Jr;if(b!==a&&(z(a,"boolean",P,"isTreePathToChildren"),this.Jr=a,this.g("isTreePathToChildren",b,a),!this.undoManager.isUndoingRedoing))for(a=this.nodes;a.next();)Gk(a.value)}},treeCollapsePolicy:{configurable:!0,get:function(){return this.Fs},set:function(a){var b=this.Fs;b!==a&&(a!==Bi&&a!==Hk&&a!==Ik&&v("Unknown Diagram.treeCollapsePolicy: "+a),this.Fs=a,this.g("treeCollapsePolicy",b,a))}},He:{configurable:!0,
enumerable:!0,get:function(){return this.Xb},set:function(a){this.Xb=a}},autoScrollInterval:{configurable:!0,get:function(){return this.Wm},set:function(a){var b=this.Wm;B(a,P,"scale");b!==a&&(this.Wm=a,this.g("autoScrollInterval",b,a))}},autoScrollRegion:{configurable:!0,get:function(){return this.Xm},set:function(a){"number"===typeof a?a=new Jc(a):w(a,Jc,P,"autoScrollRegion");var b=this.Xm;b.A(a)||(this.Xm=a=a.J(),this.Ya(),this.g("autoScrollRegion",b,a))}}});
na.Object.defineProperties(P,{licenseKey:{configurable:!0,get:function(){return Jk.Ub()},set:function(a){Jk.add(a)}},version:{configurable:!0,get:function(){return Kk}}});P.prototype.makeImageData=P.prototype.wx;P.prototype.makeImage=P.prototype.Fz;P.prototype.addRenderer=P.prototype.Ww;P.prototype.makeSVG=P.prototype.nv;P.prototype.makeSvg=P.prototype.lt;P.prototype.stopAutoScroll=P.prototype.wf;P.prototype.doAutoScroll=P.prototype.Rs;P.prototype.isUnoccupied=P.prototype.ck;
P.prototype.raiseDiagramEvent=P.prototype.ba;P.prototype.removeDiagramListener=P.prototype.pm;P.prototype.addDiagramListener=P.prototype.Lj;P.prototype.findTreeRoots=P.prototype.ez;P.prototype.layoutDiagram=P.prototype.Dz;P.prototype.findTopLevelGroups=P.prototype.Yy;P.prototype.findTopLevelNodesAndLinks=P.prototype.Zy;P.prototype.findLinksByExample=P.prototype.Us;P.prototype.findNodesByExample=P.prototype.Vs;P.prototype.findLinkForData=P.prototype.yc;P.prototype.findNodeForData=P.prototype.Di;
P.prototype.findPartForData=P.prototype.zc;P.prototype.findNodeForKey=P.prototype.Lb;P.prototype.findPartForKey=P.prototype.findPartForKey;P.prototype.rebuildParts=P.prototype.yd;P.prototype.transformViewToDoc=P.prototype.Ct;P.prototype.transformRectDocToView=P.prototype.bA;P.prototype.transformDocToView=P.prototype.Bt;P.prototype.centerRect=P.prototype.Lu;P.prototype.scrollToRect=P.prototype.Gv;P.prototype.scroll=P.prototype.scroll;P.prototype.highlightCollection=P.prototype.sz;
P.prototype.highlight=P.prototype.rz;P.prototype.clearHighlighteds=P.prototype.Yw;P.prototype.selectCollection=P.prototype.Hv;P.prototype.select=P.prototype.select;P.prototype.clearSelection=P.prototype.Ns;P.prototype.updateAllRelationshipsFromData=P.prototype.zq;P.prototype.updateAllTargetBindings=P.prototype.updateAllTargetBindings;P.prototype.commit=P.prototype.commit;P.prototype.rollbackTransaction=P.prototype.vf;P.prototype.commitTransaction=P.prototype.bb;P.prototype.startTransaction=P.prototype.Ca;
P.prototype.raiseChanged=P.prototype.g;P.prototype.raiseChangedEvent=P.prototype.eb;P.prototype.removeChangedListener=P.prototype.mk;P.prototype.addChangedListener=P.prototype.mh;P.prototype.removeModelChangedListener=P.prototype.Rz;P.prototype.addModelChangedListener=P.prototype.Vw;P.prototype.findLayer=P.prototype.am;P.prototype.removeLayer=P.prototype.Pz;P.prototype.addLayerAfter=P.prototype.jy;P.prototype.addLayerBefore=P.prototype.Tw;P.prototype.addLayer=P.prototype.Rl;
P.prototype.moveParts=P.prototype.moveParts;P.prototype.copyParts=P.prototype.Vj;P.prototype.removeParts=P.prototype.ut;P.prototype.remove=P.prototype.remove;P.prototype.add=P.prototype.add;P.prototype.clearDelayedGeometries=P.prototype.Mu;P.prototype.setProperties=P.prototype.Nv;P.prototype.resetInputOptions=P.prototype.Dv;P.prototype.setInputOption=P.prototype.Vz;P.prototype.getInputOption=P.prototype.dm;P.prototype.resetRenderingHints=P.prototype.Ev;P.prototype.setRenderingHint=P.prototype.Lx;
P.prototype.getRenderingHint=P.prototype.Ge;P.prototype.maybeUpdate=P.prototype.kd;P.prototype.requestUpdate=P.prototype.gc;P.prototype.delayInitialization=P.prototype.Cy;P.prototype.isUpdateRequested=P.prototype.zz;P.prototype.redraw=P.prototype.zh;P.prototype.invalidateDocumentBounds=P.prototype.Ya;P.prototype.findObjectsNear=P.prototype.og;P.prototype.findPartsNear=P.prototype.Vy;P.prototype.findObjectsIn=P.prototype.ng;P.prototype.findPartsIn=P.prototype.nx;P.prototype.findObjectsAt=P.prototype.Ei;
P.prototype.findPartsAt=P.prototype.Uy;P.prototype.findObjectAt=P.prototype.Tb;P.prototype.findPartAt=P.prototype.bm;P.prototype.alignDocument=P.prototype.ny;P.prototype.zoomToRect=P.prototype.eA;P.prototype.zoomToFit=P.prototype.zoomToFit;P.prototype.diagramScroll=P.prototype.hx;P.prototype.focus=P.prototype.focus;P.prototype.reset=P.prototype.reset;P.useDOM=function(a){Hh=a?void 0!==qa.document:!1};P.isUsingDOM=function(){return Hh};
var yf=null,Ci=new Ub,Qi=null,Pi=null,Hh=void 0!==qa.document,Li=null,Mi="",zi=new D(P,"None",0),fj=new D(P,"Uniform",1),gj=new D(P,"UniformToFill",2),Ig=new D(P,"CycleAll",10),Mg=new D(P,"CycleNotDirected",11),Og=new D(P,"CycleNotDirectedFast",12),Pg=new D(P,"CycleNotUndirected",13),Jg=new D(P,"CycleDestinationTree",14),Lg=new D(P,"CycleSourceTree",15),yi=new D(P,"DocumentScroll",1),Hj=new D(P,"InfiniteScroll",2),Bi=new D(P,"TreeParentCollapsed",21),Hk=new D(P,"AllParentsCollapsed",22),Ik=new D(P,
"AnyParentsCollapsed",23),Jk=new G,Kk="2.0.2",Fk=!1,Lk=null,wi=!1;
function xi(){if(Hh){var a=qa.document.createElement("canvas"),b=a.getContext("2d"),c=eb("7ca11abfd022028846");b[c]=eb("398c3597c01238");for(var d=["5da73c80a36455d4038e4972187c3cae51fd22",ra.Dx+"4ae6247590da4bb21c324ba3a84e385776",$b.xF+"fb236cdfda5de14c134ba1a95a2d4c7cc6f93c1387",K.za],e=1;5>e;e++)b[eb("7ca11abfd7330390")](eb(d[e-1]),10,15*e);b[c]=eb("39f046ebb36e4b");for(c=1;5>c;c++)b[eb("7ca11abfd7330390")](eb(d[c-1]),10,15*c);Lk=a}}P.className="Diagram";
P.fromDiv=function(a){var b=a;"string"===typeof a&&(b=qa.document.getElementById(a));return b instanceof HTMLDivElement&&b.G instanceof P?b.G:null};P.inherit=function(a,b){function c(){}if(Object.getPrototypeOf(a).prototype)throw Error("Used go.Diagram.inherit defining already defined class \n"+a);z(a,"function",P,"inherit");z(b,"function",P,"inherit");c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a};P.None=zi;P.Uniform=fj;P.UniformToFill=gj;P.CycleAll=Ig;P.CycleNotDirected=Mg;
P.CycleNotDirectedFast=Og;P.CycleNotUndirected=Pg;P.CycleDestinationTree=Jg;P.CycleSourceTree=Lg;P.DocumentScroll=yi;P.InfiniteScroll=Hj;P.TreeParentCollapsed=Bi;P.AllParentsCollapsed=Hk;P.AnyParentsCollapsed=Ik;function Ji(){this.by=null;this.l="zz@orderNum";"63ad05bbe23a1786468a4c741b6d2"===this._tk?this.Pe=this.l=!0:this.Pe=null}
function Dj(a,b){b.bd.setTransform(b.cc,0,0,b.cc,0,0);if(null===a.Pe){b="f";var c=qa[eb("76a715b2f73f148a")][eb("72ba13b5")];a.Pe=!0;if(Hh){var d=P[eb("76a115b6ed251eaf4692")];if(d)for(var e=Jk.iterator;e.next();){d=e.value;d=eb(d).split(eb("39e9"));if(6>d.length)break;var f=eb(d[1]).split(".");if("7da71ca0"!==d[4])break;var g=eb(ra[eb("6cae19")]).split(".");if(f[0]>g[0]||f[0]===g[0]&&f[1]>=g[1]){f=c[eb("76ad18b4f73e")];for(g=c[eb("73a612b6fb191d")](eb("35e7"))+2;g<f;g++)b+=c[g];f=b[eb("73a612b6fb191d")](eb(d[2]));
0>f&&eb(d[2])!==eb("7da71ca0ad381e90")&&(f=b[eb("73a612b6fb191d")](eb("76a715b2ef3e149757")));0>f&&(f=b[eb("73a612b6fb191d")](eb("76a715b2ef3e149757")));a.Pe=!(0<=f&&f<b[eb("73a612b6fb191d")](eb("35")));if(!a.Pe)break;f=eb(d[2]);if("#"!==f[0])break;g=qa.document.createElement("div");for(var h=d[0].replace(/[A-Za-z]/g,"");4>h.length;)h+="9";h=h.substr(h.length-4);d="";d+=["gsh","gsf"][parseInt(h.substr(0,1),10)%2];d+=["Header","Background","Display","Feedback"][parseInt(h.substr(0,1),10)%4];g[eb("79a417a0f0181a8946")]=
d;if(qa.document[eb("78a712aa")]){qa.document[eb("78a712aa")][eb("7bb806b6ed32388c4a875b")](g);h=qa.getComputedStyle(g).getPropertyValue(eb("78a704b7e62456904c9b12701b6532a8"));qa.document[eb("78a712aa")][eb("68ad1bbcf533388c4a875b")](g);if(!h)break;if(-1!==h.indexOf(parseInt(f[1]+f[2],16))&&-1!==h.indexOf(parseInt(f[3]+f[4],16))){a.Pe=!1;break}else if(fb||gb||ib||jb)for(d="."+d,f=0;f<document.styleSheets.length;f++){g=document.styleSheets[f].rules||document.styleSheets[f].cssRules;for(var k in g)if(d===
g[k].selectorText){a.Pe=!1;break}}}else a.Pe=null,a.Pe=!1}}else{k=c[eb("76ad18b4f73e")];for(e=c[eb("73a612b6fb191d")](eb("35e7"))+2;e<k;e++)b+=c[e];c=b[eb("73a612b6fb191d")](eb("7da71ca0ad381e90"));a.Pe=!(0<=c&&c<b[eb("73a612b6fb191d")](eb("35")))}}}return 0<a.Pe&&a!==a.by?!0:!1}
function Ki(a,b){if(Hh){void 0!==b&&null!==b||v("Diagram setup requires an argument DIV.");null!==a.Ja&&v("Diagram has already completed setup.");"string"===typeof b?a.Ja=qa.document.getElementById(b):b instanceof HTMLDivElement?a.Ja=b:v("No DIV or DIV id supplied: "+b);null===a.Ja&&v("Invalid DIV id; could not get element with id: "+b);void 0!==a.Ja.G&&v("Invalid div id; div already has a Diagram associated with it.");"static"===qa.getComputedStyle(a.Ja,null).position&&(a.Ja.style.position="relative");
a.Ja.style["-webkit-tap-highlight-color"]="rgba(255, 255, 255, 0)";a.Ja.style["-ms-touch-action"]="none";a.Ja.innerHTML="";a.Ja.G=a;var c=a.Cs?new Ij(a):new Ek(a);void 0!==c.style&&(c.style.position="absolute",c.style.top="0px",c.style.left="0px","rtl"===qa.getComputedStyle(a.Ja,null).getPropertyValue("direction")&&(a.Wn=!0),c.style.zIndex="2",c.style.userSelect="none",c.style.webkitUserSelect="none",c.style.MozUserSelect="none");a.Ea=c;a.bd=c.context;b=a.bd;a.cc=a.computePixelRatio();a.Aa=a.Ja.clientWidth||
1;a.ya=a.Ja.clientHeight||1;Kj(a,a.Aa,a.ya);a.ir=b.W[eb("7eba17a4ca3b1a8346")][eb("78a118b7")](b.W,Lk,4,4);a.Ja.insertBefore(c.Ha,a.Ja.firstChild);c=new Ek(null);c.width=1;c.height=1;a.Xt=c;a.ww=c.context;if(Hh){c=xa("div");var d=xa("div");c.style.position="absolute";c.style.overflow="auto";c.style.width=a.Aa+"px";c.style.height=a.ya+"px";c.style.zIndex="1";d.style.position="absolute";d.style.width="1px";d.style.height="1px";a.Ja.appendChild(c);c.appendChild(d);c.onscroll=Ti;c.onmousedown=Vi;c.ontouchstart=
Vi;c.G=a;c.$x=!0;c.ay=!0;a.rs=c;a.ip=d}a.rt=sa(function(){a.ye=n